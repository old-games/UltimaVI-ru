source("CONVERSE.B")
index(47)

id(146)
name("Glen")

description:
    print("a quiet, pale, almost motionless gentleman.\n*")

interaction:
    integer(value 0) = partyHasObject(word 339, byte 0)

    if notEquals(integer(value 0), word 32769):
        jump 2841

    endif

    if and(hasBit(byte 178, byte 5), equals(hasBit(byte 235, byte 6), byte 0)):
        print("\"Ohhh! Silly me, spending so much time with my clients.\" He gestures ")
        print("at the corpses.\n*\n\"I forget little details like paying Mole...\"\n*\n")
        print("\"I'll have to take care of it right away.\"\n")
        wait()

        ('SETF', ('byte', 235), ('byte', 6))
        print("\n\"You deserve a reward for helping me straighten this out.\"\n*\n\"That ")
        print("mage over on the table was found just outside of town.\"\n*\n\"He was ")
        print("carrying a couple of enchanted items and some money when the gargoyles")
        print(" got him.\"\n*\"Nobody has been able to find any relatives of his, so you")
        print(" might as well take it all.\"")
        jump 1337

    endif

    if and(hasBit(byte 178, byte 4), equals(hasBit(byte 235, byte 5), byte 0)):
        print("\"That addle-brained, lower class, miserable excuse for a common ")
        print("laborer...\"\n*\n\"I agreed to give him an equipment allowance with his ")
        print("pay.\"\n*\n\"No doubt it's all been squandered at some tavern, along with ")
        print("the rest of his pay.\"\n*\n\"See what he has to say about that!\"\n")
        ('SETF', ('byte', 235), ('byte', 5))
        bye()

    endif

    if and(hasBit(byte 178, byte 3), equals(hasBit(byte 235, byte 4), byte 0)):
        print("\"So, his shovel broke? That's no excuse.\"\n*\n\"Tell him he should have ")
        print("bought another one and kept working.\"\n")
        ('SETF', ('byte', 235), ('byte', 4))
        bye()

    endif

    if and(hasBit(byte 178, byte 2), equals(hasBit(byte 235, byte 3), byte 0)):
        print("You pass along Mole's message. \"Needs a shovel, does he? Tell him to ")
        print("use the one I gave him when I hired him!\"\n*\n\"No doubt he's forgotten ")
        print("he has it by now, or lost it somewhere...\"\n")
        ('SETF', ('byte', 235), ('byte', 3))
        bye()

    endif

    print("\"Good evening.\" he says, in a voice that sends shivers down your ")
    print("spine.\n*\n\"It is evening, I hope. That's my favorite time.\"\n")

    ask()

    case "name":
        print("\"I am Glen D'Arc, of the @Trinsic D'Arcs.\"")
        ('SETF', ('byte', 235), ('value', 0))
        jump 1337

    case "d'ar":
    case "darc":
    case "trin":
        print("\"I had to move away... Too @sunny.\"")
        jump 1337

    case "sun":
        print("\"I much prefer moonlight. It's more natural and healthy.\"")
        jump 1337

    case "bod":
    case "depa":
    case "prep":
        print("\"For most clients, I prefer to use Frigid @Solvol.\"\n*\n\"It's the finest")
        print(" enbalming fluid on the market.\"")
        jump 1337

    case "enba":
    case "frig":
    case "solv":
        print("\"It gives the departed a nice, healthy glow...\"")
        jump 1337

    case "eter":
    case "rest":
        print("\"Yes, those who cannot afford resurrection know the cool comfort of ")
        print("good, honest soil.\"\n*\nHe sighs longingly. \"How I envy them, for only ")
        print("the @dead know true peace.\"")
        jump 1337

    case "dead":
    case "ress":
        print("\"He smiles. \"I see you're not much of a believer in death.\"\n*\n\"But ")
        print("next time you're dead you should try staying that way. You might like ")
        print("it...\"")
        jump 1337

    case "job":
        jump 2480

    case "grav":
    case "inco":
    case "mole":
        if hasBit(byte 235, byte 2):
            print("\"You can't get good help these days...\"")
            jump 1337

        endif

        print("\"Mole was supposed to have two more graves finished yesterday.\"\n*\n\"I ")
        print("can't stand to talk to him any more - if you see him, tell him I need ")
        print("those graves dug immediately!\"")
        ('SETF', ('byte', 235), ('byte', 2))
        jump 1337

    case "bye":
        print("\"Goodbye for now - I'm sure I'll see you again. Every body ends up ")
        print("here sooner or later...\"\n")
        bye()

    case "*":
        print("\"Don't concern yourself with that. Life is too hectic as it is.\"")

    esac

    jump 1337

2480:
    print("\"I prepare the @bodies of the departed for their eternal @rest.\" He ")
    print("pauses to pop a grape into his mouth.\n*\nHe chews it delicately, but ")
    print("you can still hear a soft, squishy sound. \"Would you like a few ")
    print("grapes?\" ")

    askc("yn")

    case "y":
        print("\"Help yourself.\"\n*\n")

    case "n":
        integer(value 1) = integer(value 1)

    esac

    print("\"It's very relaxing work. At least it would be, if I didn't have to ")
    print("put up with that incompetent @gravedigger.\"")
    jump 1337

2841:
    print("His eyes gleam fiendishly when he notices the body you're carrying.\n*\n")
    print("\"Ah, you've brought me a client. Tell the truth, doesn't your friend ")
    print("look more peaceful this way?\"\n*\n\"For such a heroic client, I have ")
    print("something special to offer.\"\n*\n\"It's a new process I've invented ")
    print("called 'cremation.'\"\n*\n\"For a mere fifteen gold, the remains of the ")
    print("dearly departed are purified with flame.\"\n*\n\"Would you like me to do ")
    print("this for you?\" ")

    askc("yn")

    case "n":
        print("\"Too bad.\"\n")
        bye()

    esac

    if less(objectsCount(byte 1, byte 88), byte 15):
        print("\n\"You're a bit short on gold.\" he says, disappointedly.\n")
        bye()

    endif

    print("\n\"Excellent!\" He takes the body, and recites a brief incantation.\n*\nAn")
    print(" eerie green flame engulfs the corpse, consuming it in seconds.\n*\n")
    print("Nothing but ashes remain. The mortician sweeps them up, puts them in ")
    print("an urn, and hands it to ")
    ('SETNAME', ('integer', [('value', 0)]))

    if notEquals(integer(value 0), byte 1):
        print("$Y")

    else:
        print("you")

    endif

    print(".\n*\n")
    ('DELETE', ('byte', 1), ('byte', 88), ('byte', 0), ('byte', 15))
    ('DELETE', ('integer', [('value', 0)]), ('word', 339), ('byte', 0), ('byte', 1))
    ('NEW', ('integer', [('value', 0)]), ('byte', 170), ('byte', 0), ('byte', 1))
    print("\"Please come again if any more of your friends need my services.\"\n")
    bye()

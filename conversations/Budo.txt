source('CONVERSE.B')
index(16)

id(115)
name({
    'english': 'Budo',
    'russian': 'Будо'
})

description:
    print({
        'english': 'a chubby, jovial merchant.\n',
        'russian': 'полноватого, жизнерадостного торговца.\n'
    })

interaction:
    print({
        'english': '"Good $T! ',
        'russian': '"Доброго $T! '
    })

    if hasBit(byte 235, value 0):
        jump label_339
    fi

    setBit(byte 235, value 0)
    print({
        'english': 'I bet you\'ve come back to pick up that @orrery you ordered."',
        'russian': 'Бьюсь об заклад, что вы пришли за своей @моделью звёздной системы".'
    })
    wait()

    if partyHas(byte 2):
        portrait(byte 2)
        print({
            'english': '\n\n"Don\'t be ridiculous! This is the first time we\'ve ever been in your',
            'russian': '\n\n"Что за вздор! Мы впервые в вашей'
        })
        print({
            'english': ' shop!" says Dupre.',
            'russian': ' лавке!" - воскликнул Дюпре.'
        })
        wait()

        portrait(byte 235)
        print({
            'english': '\n\n"Oh, I\'m sorry. I must have thought you were somebody you aren\'t.',
            'russian': '\n\n"Ох, извините. Должно быть я вас с кем-то перепутал'
        })

    else:
        print({
            'english': '\n\n"I\'m afraid it still hasn\'t arrived.',
            'russian': '\n\n"Боюсь, её ещё не прислали'
        })
    fi

    print({
        'english': '"',
        'russian': '".'
    })
    wait()

    print({
        'english': '\n\n"',
        'russian': '\n\n"'
    })

label_339:
    print({
        'english': 'Do you need to buy some supplies?" ',
        'russian': 'Желаете прикупить припасов?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        print({
            'english': '"Which, @torches, @oil, @lockpicks, @gems, @backpacks, @bags, ',
            'russian': '"А что именно? @Факелы, @масло, @отмычки, @самоцветы, @рюкзаки, @мешки, '
        })
        print({
            'english': '@shovels, or @powder kegs?"',
            'russian': '@лопаты или @бочки с порохом?"'
        })
        jump label_601

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Then it must be Thursday--or possibly Tuesday."',
            'russian': '"Тогда это, должно быть, четверг или, может быть, вторник".'
        })
        wait()

        print({
            'english': '\n\n"I never seem to sell anything on Tuesdays."',
            'russian': '\n\n"Кажется, я ничего не продаю по вторникам".'
        })
        jump label_601

label_577:
        print({
            'english': '"What can I do you for?"',
            'russian': '"Что я могу сделать для вас?"'
        })

label_601:
        print({
            'english': '\n',
            'russian': '\n'
        })

        ask()

    case 'name':
    case {'russian': 'имя'}:
        print({
            'english': '"Why, it\'s Budo, I believe. That\'s what it was last week."',
            'russian': '"Будо, как я понимаю, а что? По крайней мере, меня так звали на прошлой неделе".'
        })
        wait()

        print({
            'english': '\n\n"Some call me \'the @Den\', but I don\'t think that\'s my name."',
            'russian': '\n\n"А вот некоторые зовут меня \'Тот самый @Дэн\', но не думаю, что это моё имя".'
        })
        jump label_6

    case 'den':
    case {'russian': 'дэн'}:
        print({
            'english': '"I think someone told me that was @Nick\'s name."',
            'russian': '"Кажется, это что-то связанное с каким-то @Ником".'
        })
        jump label_601

    case 'nick':
    case {'russian': 'ник'}:
        print({
            'english': '"I\'ve never met him, myself."',
            'russian': '"Никогда не встречал его".'
        })
        jump label_601

    case 'orre':
    case {'russian': 'моде'}:
        print({
            'english': '"I don\'t know what it is, but I\'ve got one on order."',
            'russian': '"Я не знаю, что это, но такой заказ есть".'
        })
        jump label_601

    case 'job':
    case {'russian': 'раб'}:
        print({
            'english': '"Oh, I sell this and that."',
            'russian': '"Ну, я продаю то да сё".'
        })
        wait()

        print({
            'english': '\n\n"I\'m not sure what \'this\' and \'that\' are, but I @sell a lot of ',
            'russian': '\n\n"Правда, я не знаю, что именно \'то\', а что \'сё\', но я @продаю много '
        })
        print({
            'english': 'them!"',
            'russian': 'всего!"'
        })
        wait()

        print({
            'english': '\n\n"People give me @money for them, that is."',
            'russian': '\n\n"Люди платят @монетки за товар, вот и всё".'
        })
        jump label_601

    case 'mone':
    case {'russian': 'моне'}:
        print({
            'english': '"It\'s not as sweet as @honey, but you can trade one for the other."',
            'russian': '"Ну, они, конечно, не такие сладкие, как @конфетки, но что-то на них можно выменять".'
        })
        jump label_601

    case 'swee':
    case {'russian': 'слад'}:
    case 'hone':
    case {'russian': 'конф'}:
        print({
            'english': '"I like honey."',
            'russian': '"Я люблю конфетки".'
        })
        jump label_601

    case 'thie':
    case {'russian': 'вор'}:
    case 'guil':
    case {'russian': 'гил'}:
    case 'belt':
    case {'russian': 'пояс'}:
        if hasBit(byte 235, byte 7):
            print({
                'english': '"To keep the guild safe, each member only knows the names of two ',
                'russian': '"Каждый член гильдии знает имена только двух '
            })
            print({
                'english': 'others."',
                'russian': 'других её участников".'
            })
            wait()

            print({
                'english': '\n\n"You\'re safer not knowing more about the guild than you have to, ',
                'russian': '\n\n"Спокойней всего спится, когда знаешь о гильдии не больше, чем должен, '
            })
            print({
                'english': 'believe me..."',
                'russian': 'уже поверьте..."'
            })
            jump label_601
        fi

        if notEquals(partyHasObject(byte 25, byte 0), word 32769):
            print({
                'english': 'He glances about quickly, to make sure nobody else is listening.',
                'russian': 'Он торопливо посмотрел по сторонам, пока не убедился, что никто не подслушивает.'
            })
            wait()

            print({
                'english': '\n\nIn a low voice he says, "Congratulations, and welcome to the guild."',
                'russian': '\n\nЗатем он тихо произнёс: "Поздравляю, и добро пожаловать в гильдию".'
            })
            wait()

            print({
                'english': '\n\n"I can offer you the standard member\'s discount on all supplies ',
                'russian': '\n\n"Теперь я могу предложить вам обычную скидку как для члена гильдии на все '
            })
            print({
                'english': 'now."',
                'russian': 'припасы".'
            })
            wait()

            print({
                'english': '\n\n"Just remember, whatever you do, don\'t tell anyone about our ',
                'russian': '\n\n"Просто помните, ни в коем случае не рассказывайте никому '
            })
            print({
                'english': '@guild!"',
                'russian': 'о @гильдии!"'
            })
            setBit(byte 235, byte 7)
            jump label_601
        fi

        print({
            'english': 'A startling change comes over his features.',
            'russian': 'Испуг исказил его лицо.'
        })
        wait()

        print({
            'english': '\n\nSuddenly the good-natured bumbler that stood before you has been ',
            'russian': '\n\nНеожиданным образом добродушный простак, что стоял перед вами, преобразился '
        })
        print({
            'english': 'transformed into a shrewd, sharp, dangerous looking man.',
            'russian': 'в проницательного, резкого и опасно выглядящего мужчину.'
        })
        wait()

        print({
            'english': '\n\nHe leans forward staring straight into your eyes as he asks "Who ',
            'russian': '\n\nНаклонившись и пристально посмотрев вам в глаза, он спросил: "Кто '
        })
        print({
            'english': 'sent you?"\n',
            'russian': 'прислал вас?"\n'
        })

        ask()
        print({
            'english': '\n"Uh-huh. Well... Were you hoping to join?" ',
            'russian': '\n"Угу. Ладно... Хотите присоединиться?" '
        })
        jump label_2414

    case 'buy':
    case {'russian': 'куп'}:
    case 'sell':
    case {'russian': 'прод'}:
    case 'this':
    case {'russian': 'то'}:
    case 'that':
    case {'russian': 'сё'}:
        print({
            'english': '"Which, @torches, @oil, @lockpicks, @gems, @backpacks, @bags, ',
            'russian': '"А что именно? @Факелы, @масло, @отмычки, @самоцветы, @рюкзаки, @мешки, '
        })
        print({
            'english': '@shovels, or @powder @kegs?"',
            'russian': '@лопаты или @бочки с порохом?"'
        })
        jump label_601

    case 'torc':
    case {'russian': 'фак'}:
        integer(value 4) = byte 0
        jump label_3392

    case 'oil':
    case {'russian': 'мас'}:
        integer(value 4) = byte 1
        jump label_3392

    case 'lock':
    case {'russian': 'отм'}:
        integer(value 4) = byte 2
        jump label_3392

    case 'gem':
    case {'russian': 'само'}:
        integer(value 4) = byte 3
        jump label_3392

    case 'back':
    case {'russian': 'рюкз'}:
        integer(value 4) = byte 4
        jump label_3392

    case 'bags':
    case {'russian': 'меш'}:
        integer(value 4) = byte 5
        jump label_3392

    case 'shov':
    case {'russian': 'лоп'}:
        integer(value 4) = byte 6
        jump label_3392

    case 'powd':
    case {'russian': 'пор'}:
    case 'keg':
    case {'russian': 'боч'}:
        integer(value 4) = byte 7
        jump label_3392

    case 'bye':
    case {'russian': 'пока'}:
        if hasBit(byte 235, byte 7):
            print({
                'english': 'He winks at you. "The guild is behind you, as long as you keep our ',
                'russian': 'Он подмигивает вам. "Пока о нашем секрете никто не знает, гильдия всегда будет '
            })
            print({
                'english': 'secret."\n',
                'russian': 'рядом".\n'
            })

        else:
            print({
                'english': '"Ta ta for now."\n',
                'russian': '"Ну тогда чао-какао".\n'
            })
        fi

        bye()

    case '*':
        print({
            'english': '"$Z? It seems to me I knew something about that, but I\'m having ',
            'russian': '"$Z? Кажется, что я что-то знал об этом, но у меня проблемы '
        })
        print({
            'english': 'trouble with my remembering."',
            'russian': 'с памятью".'
        })
    esac

    jump label_601

label_2414:
    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': 'He leans even closer, transfixing you with his gaze.',
            'russian': 'Он наклоняется ещё ближе, буквально пронзая вас взглядом.'
        })
        wait()

        print({
            'english': '\n\n"Then just remember this. I don\'t take kindly to anyone spreading ',
            'russian': '\n\n"Тогда запомните вот что. Я очень не люблю, когда кто-то разбрасывается '
        })
        print({
            'english': 'secrets around."',
            'russian': 'чужими секретами".'
        })
        wait()

        print({
            'english': '\n\n"If you were to tell anyone I\'m involved with the guild, well..."',
            'russian': '\n\n"Если ты хоть кому-то расскажешь о моей связи с гильдией, тогда..."'
        })
        wait()

        print({
            'english': '\n\n"Let\'s just say accidents can happen to anyone--even the Avatar."',
            'russian': '\n\n"Скажу, что несчастный случай может произойти с кем угодно - даже с Аватаром".'
        })
        wait()

        print({
            'english': '\n\n"Now get out of my shop."\n',
            'russian': '\n\n"А теперь - вон из моей лавки".\n'
        })
        bye()

    case 'y':
    case {'russian': 'д'}:
        print({
            'english': '"All right, maybe you\'ve got what it takes. We\'ll see."',
            'russian': '"Хорошо, может у вас есть то, что нужно. Посмотрим".'
        })
        wait()

        print({
            'english': '\n\n"To be a member of the thieves\' guild, you have to get your own ',
            'russian': '\n\n"Чтобы стать членом гильдии воров, нужно обзавестись собственным '
        })
        print({
            'english': 'belt."',
            'russian': 'поясом".'
        })
        wait()

        print({
            'english': '\n\n"Now we have a limited membership, so there\'s only so many belts in ',
            'russian': '\n\n"Мы всех подряд не берём, поэтому в мире не так уж много '
        })
        print({
            'english': 'the world."',
            'russian': 'поясов".'
        })
        wait()

        print({
            'english': '\n\n"If you want one of them, you have to \'retire\' a member of the ',
            'russian': '\n\n"Если хочется заполучить один из них, придётся \'уйти\' кого-нибудь из членов '
        })
        print({
            'english': 'guild."',
            'russian': 'гильдии".'
        })
        wait()

        print({
            'english': '\n\n"Lucky for you, it just happens there\'s a member we\'d like to see ',
            'russian': '\n\n"К вашему счастью, так случилось, что как раз есть участник гильдии, '
        })
        print({
            'english': '\'retired\' soon."',
            'russian': 'кого мы хотим \'уйти\' - и очень скоро".'
        })
        wait()

        print({
            'english': '\n\n"Her hideout is deep below Britain, in the sewers. You\'d best watch ',
            'russian': '\n\n"Её укрытие находится глубоко под Бритайном, в канализациях. Будьте начеку - '
        })
        print({
            'english': 'out for the rats down there!"',
            'russian': 'там кругом снуют крысы!"'
        })
        wait()

        print({
            'english': '\n\n"One last thing... It\nwould be an embarassment for the guild to have',
            'russian': '\n\n"И последнее... Репутация\nгильдии крайне пострадает, если где-то'
        })
        print({
            'english': ' bodies turning up inconveniently."',
            'russian': ' найдут тела".'
        })
        wait()

        print({
            'english': '\n\n"So don\'t get too violent unless you have to."',
            'russian': '\n\n"Поэтому насилие стоит применять только в случае необходимости".'
        })
        wait()

        print({
            'english': '\n\n"I\'ll talk to you when you get back."\n',
            'russian': '\n\n"Поговорим, когда вернётесь".\n'
        })
        bye()
    esac

label_3392:
    if hasBit(byte 235, byte 7):
        data(integers_4379, byte 0) = data(integers_4395, byte 0)
        data(integers_4379, byte 1) = data(integers_4395, byte 1)
        data(integers_4379, byte 2) = data(integers_4395, byte 2)
        data(integers_4379, byte 3) = data(integers_4395, byte 3)
        data(integers_4379, byte 4) = data(integers_4395, byte 4)
        data(integers_4379, byte 5) = data(integers_4395, byte 5)
        data(integers_4379, byte 6) = data(integers_4395, byte 6)
        data(integers_4379, byte 7) = data(integers_4395, byte 7)
    fi

    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 0
        jump label_3688
    fi

label_3572:
    integer(value 0) = byte 0
    integer(value 1) = byte 1

label_3586:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#1. $Y\n',
        'russian': '#1. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 1) = plus(integer(value 1), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_3586
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_577
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_3572
    fi

label_3688:
    if or(less(canCarry(character(integer(value 3), byte 0)), weight(data(integers_4411, integer(value 4)), byte 1)), less(objectsCount(character(integer(value 3), byte 0), byte 88), data(integers_4379, integer(value 4)))):
        integer(value 5) = byte 1
        jump label_3973
    fi

label_3739:
    integer(value 0) = data(integers_4379, integer(value 4))
    string(value 0) = data(strings_4427, integer(value 4))
    look(character(integer(value 3), byte 0))
    print({
        'english': '$N looks at $Y, "It\'ll cost you #0 gold for each $0, how many do you ',
        'russian': '$N смотрит на персонажа $Y и говорит: "Это стоит #0 золота за $0, сколько именно вам '
    })
    print({
        'english': 'want?" ',
        'russian': 'нужно?" '
    })
    inputInteger(integer(value 5))

    if greater(integer(value 5), byte 100):
        print({
            'english': '"Come now, that\'s a little much don\'t you think?"',
            'russian': '"Ох, ну хватит, это уже перебор, вам не кажется?"'
        })
        wait()

        print({
            'english': '\n\n',
            'russian': '\n\n'
        })
        jump label_3739
    fi

    if equals(integer(value 5), byte 0):
        print({
            'english': '$N frowns at $Y, "That was a good price."',
            'russian': '$N хмуро смотрит на персонажа $Y и произносит: "Это была хорошая цена".'
        })
        wait()

        print({
            'english': '\n\n',
            'russian': '\n\n'
        })
        jump label_577
    fi

label_3973:
    integer(value 2) = integer(value 5)
    integer(value 0) = byte 0
    integer(value 1) = byte 0

label_3994:
    if less(canCarry(character(integer(value 3), byte 0)), weight(data(integers_4411, integer(value 4)), integer(value 2))):
        integer(value 1) = byte 1
        integer(value 0) = byte 1
        integer(value 2) = minus(integer(value 2), byte 1)
        jump label_4094
    fi

    if less(objectsCount(character(integer(value 3), byte 0), byte 88), multiply(integer(value 2), data(integers_4379, integer(value 4)))):
        integer(value 1) = byte 2
        integer(value 2) = minus(integer(value 2), byte 1)
        jump label_4094
    fi

    jump label_4274

label_4094:
    if integer(value 2):
        jump label_3994
    fi

    if equals(integer(value 1), byte 1):
        string(value 0) = data(strings_4427, integer(value 4))
        look(character(integer(value 3), byte 0))
        print({
            'english': '$N looks at $Y. "You haven\'t any room in your pack."',
            'russian': '$N смотрит на персонажа $Y и произносит: "У вас нет свободного места".'
        })
        wait()

        print({
            'english': '\n\n',
            'russian': '\n\n'
        })
        jump label_577
    fi

    if equals(integer(value 1), byte 2):
        string(value 0) = data(strings_4427, integer(value 4))
        look(character(integer(value 3), byte 0))
        print({
            'english': '"I think you have less gold than you thought."',
            'russian': '"Похоже, у вас меньше золота, чем вам кажется".'
        })
        wait()

        print({
            'english': '\n\n',
            'russian': '\n\n'
        })
        jump label_577
    fi

label_4274:
    destroyItem(character(integer(value 3), byte 0), byte 88, byte 0, multiply(integer(value 2), data(integers_4379, integer(value 4))))
    createItem(character(integer(value 3), byte 0), data(integers_4411, integer(value 4)), byte 0, integer(value 2))
    look(character(integer(value 3), byte 0))
    string(value 0) = data(strings_4427, integer(value 4))
    print({
        'english': 'He hands $Y #2 $0\\s. ',
        'russian': 'Он протягивает персонажу $Y #2 х$0. '
    })
    printString(strings_4481, integer(value 1))
    wait()

    print({
        'english': '\n\n',
        'russian': '\n\n'
    })
    jump label_577

integers_4379 = [
    5,  // 0
    5,  // 1
    7,  // 2
    15, // 3
    10, // 4
    5,  // 5
    20, // 6
    40, // 7
]

integers_4395 = [
    3,  // 0
    3,  // 1
    5,  // 2
    9,  // 3
    6,  // 4
    3,  // 5
    12, // 6
    24, // 7
]

integers_4411 = [
    90,  // 0
    83,  // 1
    63,  // 2
    77,  // 3
    99,  // 4
    188, // 5
    104, // 6
    223, // 7
]

strings_4427 = [
    {
        'english': 'Torch',
        'russian': 'Факел'
    }, // 0
    {
        'english': 'Oil',
        'russian': 'Масло'
    }, // 1
    {
        'english': 'Lockpick',
        'russian': 'Отмычка'
    }, // 2
    {
        'english': 'Gem',
        'russian': 'Самоцвет'
    }, // 3
    {
        'english': 'Backpack',
        'russian': 'Рюкзак'
    }, // 4
    {
        'english': 'Bag',
        'russian': 'Мешок'
    }, // 5
    {
        'english': 'Shovel',
        'russian': 'Лопата'
    }, // 6
    {
        'english': 'Powder Keg',
        'russian': 'Бочка с порохом'
    }, // 7
]

strings_4481 = [
    {
        'english': '"There you go."',
        'russian': '"Держите".'
    }, // 0
    {
        'english': '"That\'s all you can carry."',
        'russian': '"Это всё, что вы можете унести".'
    }, // 1
    {
        'english': '"That\'s all you can afford."',
        'russian': '"Больше вам не по карману".'
    }, // 2
]

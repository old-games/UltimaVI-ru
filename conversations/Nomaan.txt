source('CONVERSE.A')
index(44)

id(44)
name({
    'english': 'Nomaan',
    'russian': 'Номаан'
})

description:
    print({
        'english': 'a blond man with broad shoulders and a stern, unsmiling face.',
        'russian': 'широкоплечего блондина с мрачным лицом.'
    })

    f3()

interaction:
    wait()

    print({
        'english': '\n',
        'russian': '\n'
    })

    if equals(integer(value 32), byte 153):
        print({
            'english': '"Can\'t you see there\'s a lovely brawl going on? Talk to me tomorrow."\n',
            'russian': '"Не видишь, что ли, что здесь дерутся? Поговорим завтра".\n'
        })
        bye()
    fi

    integer(value 8) = byte 7

    if hasBit(byte 235, value 0):
        print({
            'english': '"Hello again, $G."',
            'russian': '"Снова ты, $G".'
        })
        jump label_307

    else:
        print({
            'english': '"I am Nomaan. What is thy name, $G?"\n',
            'russian': '"Меня зовут Номаан. А тебя как звать, $G?"\n'
        })

        ask()
        print({
            'english': '\nHe bows stiffly. "Well met, $G."',
            'russian': '\nОн кланяется через силу. "Приятно познакомиться, $G".'
        })
        setBit(byte 235, value 0)
        jump label_307
    fi

label_273:
    print({
        'english': '\n"What else can I help thee with?"',
        'russian': '\n"Как я ещё могу помочь?"'
    })

label_307:
    print({
        'english': '\n',
        'russian': '\n'
    })

    ask()

    case 'buy':
    case {'russian': 'куп'}:
        print({
            'english': '"Certainly, $G."',
            'russian': '"Разумеется, $G".'
        })
        wait()

        print({
            'english': '\n\n"Wouldst thou like @armaments or @ammunition?"',
            'russian': '\n\n"Желаешь @оружие или @припасы?"'
        })
        jump label_307

    case 'arm':
    case {'russian': 'ору'}:
        if notEquals(integer(value 32), byte 144):
            print({
                'english': '"Come by my shop when I\'m open!"',
                'russian': '"Приходи, когда лавка открыта!"'
            })
            jump label_307

        else:
            integer(value 9) = byte 0
            jump label_2675
        fi

    case 'amm':
    case {'russian': 'при'}:
        if notEquals(integer(value 32), byte 144):
            print({
                'english': '"Come by my shop when I\'m open!"',
                'russian': '"Приходи, когда лавка открыта!"'
            })
            jump label_307

        else:
            integer(value 9) = integer(value 8)
            jump label_3292
        fi

    case 'sell':
    case {'russian': 'прод'}:
        if notEquals(integer(value 32), byte 144):
            print({
                'english': '"Come by my shop when I\'m open!"',
                'russian': '"Приходи, когда лавка открыта!"'
            })
            jump label_307

        else:
            jump label_1758
        fi

    case 'name':
    case {'russian': 'имя'}:
        print({
            'english': '"@Naughty Nomaan, they call me."',
            'russian': '"Они зовут меня @Негодник Номаан".'
        })
        jump label_307

    case 'job':
    case {'russian': 'раб'}:
        print({
            'english': '"I run the armoury, @buying and @selling weapons."',
            'russian': '"Я управляю оружейной, где можно @купить и @продать оружие".'
        })
        jump label_307

    case 'naug':
    case {'russian': 'него'}:
        print({
            'english': '"\'Tis just a nickname, of course."',
            'russian': '"Конечно, это просто прозвище".'
        })
        wait()

        print({
            'english': '\n\nYou see a hint of a smile on his face.',
            'russian': '\n\nНа его лице промелькнула улыбка.'
        })
        jump label_307

    case 'rune':
    case {'russian': 'рун'}:
        print({
            'english': '"I won a rune in a tournament once."',
            'russian': '"Как-то я выиграл руну на турнире".'
        })
        wait()

        print({
            'english': '\n\n"\'Tis gone now, though - and there\'s a fine @tale about it!"',
            'russian': '\n\n"Ну, её уже нет. Зато всегда есть что @рассказать!"'
        })
        jump label_307

    case 'gone':
    case {'russian': 'нет'}:
    case 'tale':
    case {'russian': 'расс'}:
        print({
            'english': '"I remember it as if it were yesterday..."',
            'russian': '"Помню, как будто это было вчера..."'
        })
        wait()

        print({
            'english': '\n\n"Zellivan held a tourney and I was awarded the Rune of Valour."',
            'russian': '\n\n"Зелливан проводил турнир, и меня наградили Руной Доблести".'
        })
        wait()

        print({
            'english': '\n\n"Afterwards, we were at the pub, celebrating."',
            'russian': '\n\n"А потом мы отправились в паб праздновать".'
        })
        wait()

        print({
            'english': '\n\n"I had drunk a full quart of ale, so my grip was a bit unsteady."',
            'russian': '\n\n"Я выпил целый литр эля, поэтому руки немного плясали".'
        })
        wait()

        print({
            'english': '\n\n"I was showing the rune around when it fell from my grasp onto the ',
            'russian': '\n\n"Я хвастался руной, когда она вывалилась из рук '
        })
        print({
            'english': 'floor."',
            'russian': 'на пол".'
        })
        wait()

        print({
            'english': '\n\n"That\'s when the @rat ran out."',
            'russian': '\n\n"И тогда выбежала @крыса".'
        })
        jump label_307

    case 'rat':
    case {'russian': 'крыс'}:
        print({
            'english': '"It scampered over, seized the trinket and ran back \'cross the floor."',
            'russian': '"Она пронеслась мимо меня, схватила трофей и убежала обратно".'
        })
        wait()

        print({
            'english': '\n\n"We all leapt at it, but the little beast was too quick."',
            'russian': '\n\n"Все бросились за ней, но за мелкой тварью было не угнаться".'
        })
        wait()

        print({
            'english': '\n\n"It was in the @hole before anybody could stop it."',
            'russian': '\n\n"Она была уже в своей @норе, прежде чем кто-либо мог бы успеть ей помешать".'
        })
        jump label_307

    case 'hole':
    case {'russian': 'нора'}:
        print({
            'english': '"It ran into a hole in the west wall of the pub, carrying the rune."',
            'russian': '"У неё была нора в западной стене паба, держа руну в зубах".'
        })
        wait()

        print({
            'english': '\n\n"We tried everything - banging on the wall, digging, poking with a ',
            'russian': '\n\n"Мы всё перепробовали - стучали по стене, копали, протыкали стену '
        })
        print({
            'english': 'sword."',
            'russian': 'мечом".'
        })
        wait()

        print({
            'english': '\n\n"To no avail, though. We haven\'t seen the rune since."',
            'russian': '\n\n"Всё было впустую, впрочем. С тех пор мы руну не видели".'
        })
        jump label_307

    case 'mant':
    case {'russian': 'мант'}:
        print({
            'english': '"Go ask around in the tavern."',
            'russian': '"Можешь поспрашивать в таверне".'
        })
        jump label_307

    case 'bye':
    case {'russian': 'пока'}:
        print({
            'english': '"A fine $T to you, $G."\n',
            'russian': '"Отличного $T, $G".\n'
        })
        bye()

    case '*':
        print({
            'english': '"Hmm..."',
            'russian': '"Хмм..."'
        })
        wait()

        print({
            'english': '\n\n"Nope, I fear I know nothing of that, $G."',
            'russian': '\n\n"Не-а, ничего не знаю об этом, $G".'
        })
        jump label_307
    esac

label_1758:
    integer(value 0) = byte 0
    integer(value 2) = byte 0
    integer(value 3) = byte 0

label_1779:
    integer(value 1) = byte 0

label_1786:
    if hasObject(character(integer(value 0), byte 0), data(integers_4111, integer(value 1)), byte 0):
        data(integers_4227, integer(value 2)) = integer(value 0)
        integer(value 2) = plus(integer(value 2), byte 1)
        integer(value 3) = byte 1
        jump label_1863
    fi

    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), integer(value 8)):
        jump label_1786
    fi

label_1863:
    integer(value 0) = plus(integer(value 0), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1779
    fi

    if equals(integer(value 3), byte 0):
        print({
            'english': '"Sorry, none of you has anything I need."',
            'russian': '"Увы, ни у кого у вас нет того, что мне нужно".'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_273
    fi

    if equals(integer(value 2), byte 1):
        integer(value 3) = character(data(integers_4227, byte 0), byte 0)
        look(integer(value 3))
        print({
            'english': '"Aye, $Y has something of interest..."',
            'russian': '"Верно, $Y держит у себя что-то интересное..."'
        })
        wait()

        print({
            'english': '\n\n',
            'russian': '\n\n'
        })
        jump label_2140
    fi

label_2016:
    integer(value 1) = byte 1

label_2023:
    look(character(data(integers_4227, minus(integer(value 1), byte 1)), byte 0))
    print({
        'english': '#1) $Y\n',
        'russian': '#1) $Y\n'
    })
    integer(value 1) = plus(integer(value 1), byte 1)

    if lessOrEquals(integer(value 1), integer(value 2)):
        jump label_2023
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_2644
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greaterOrEquals(integer(value 3), integer(value 2)):
        jump label_2016
    fi

    integer(value 3) = character(data(integers_4227, integer(value 3)), byte 0)

label_2140:
    integer(value 0) = byte 0
    integer(value 5) = byte 0

label_2154:
    if equals(hasObject(integer(value 3), data(integers_4111, integer(value 0)), byte 0), byte 0):
        jump label_2201
    fi

    data(integers_4197, integer(value 5)) = integer(value 0)
    integer(value 5) = plus(integer(value 5), byte 1)

label_2201:
    integer(value 0) = plus(integer(value 0), byte 1)

    if less(integer(value 0), integer(value 8)):
        jump label_2154
    fi

    if equals(integer(value 5), byte 1):
        integer(value 6) = data(integers_4197, byte 0)
        jump label_2362
    fi

    integer(value 0) = byte 1

label_2257:
    print({
        'english': '#0) ',
        'russian': '#0) '
    })
    printString(strings_4131, data(integers_4197, minus(integer(value 0), byte 1)))
    print({
        'english': '\n',
        'russian': '\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)

    if lessOrEquals(integer(value 0), integer(value 5)):
        jump label_2257
    fi

    print({
        'english': '"Which item?" ',
        'russian': '"Какой предмет?" '
    })
    inputDigit(integer(value 6))

    if greater(integer(value 6), integer(value 5)):
        jump label_2140
    fi

    if equals(integer(value 6), byte 0):
        jump label_2644
    fi

    integer(value 6) = data(integers_4197, minus(integer(value 6), byte 1))

label_2362:
    string(value 0) = data(strings_4131, integer(value 6))
    integer(value 7) = divide(data(integers_4093, integer(value 6)), byte 2)
    look(integer(value 3))
    print({
        'english': '"Will you take #7 gold for that $0, $Y?" ',
        'russian': '"Отдадите $0 за #7 золота, $Y?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'n':
    case {'russian': 'н'}:
        if equals(integer(value 5), byte 1):
            print({
                'english': '"Perhaps some other time, then."',
                'russian': '"Может быть, в другой раз".'
            })
            wait()

            print({
                'english': '\n',
                'russian': '\n'
            })
            jump label_273

        else:
            print({
                'english': '"Perhaps something else then?"',
                'russian': '"Что-нибудь ещё?"'
            })
            wait()

            print({
                'english': '\n\n',
                'russian': '\n\n'
            })
            jump label_2140
        fi

    case 'y':
    case {'russian': 'д'}:
        look(integer(value 3))
        print({
            'english': '"Done!" $N hands $Y #7 gold pieces and takes the $0.',
            'russian': '"По рукам!" $N передаёт персонажу $Y #7 золотых и забирает $0.'
        })
        destroyItem(integer(value 3), data(integers_4111, integer(value 6)), byte 0, byte 1)
        createItem(integer(value 3), byte 88, byte 0, integer(value 7))

        if equals(integer(value 5), byte 1):
            print({
                'english': '*\n',
                'russian': '*\n'
            })
            jump label_273

        else:
            wait()

            print({
                'english': '\n\n',
                'russian': '\n\n'
            })
            jump label_2140
        fi
    esac

label_2644:
    print({
        'english': '"Changed your mind, eh?"',
        'russian': '"Так что, планы поменялись?"'
    })
    wait()

    print({
        'english': '\n',
        'russian': '\n'
    })
    jump label_273

label_2675:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 0
        jump label_2821
    fi

label_2695:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_2709:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2) $Y\n',
        'russian': '#2) $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_2709
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_2644
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_2695
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_2821:
    integer(value 0) = byte 1
    look(integer(value 3))

label_2832:
    string(value 0) = data(strings_4131, plus(integer(value 9), minus(integer(value 0), byte 1)))
    print({
        'english': '#0) $0\n',
        'russian': '#0) $0\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)

    if and(integer(value 9), notEquals(data(integers_4111, plus(integer(value 9), minus(integer(value 0), byte 1))), byte 0)):
        jump label_2832
    fi

    if and(equals(integer(value 9), byte 0), lessOrEquals(integer(value 0), integer(value 8))):
        jump label_2832
    fi

    integer(value 7) = integer(value 0)
    print({
        'english': '"Which item?" ',
        'russian': '"Какой предмет?" '
    })
    inputDigit(integer(value 0))

    if equals(integer(value 0), byte 0):
        jump label_2644
    fi

    if greaterOrEquals(integer(value 0), integer(value 7)):
        jump label_2821
    fi

    integer(value 0) = minus(plus(integer(value 9), integer(value 0)), byte 1)
    integer(value 1) = data(integers_4093, integer(value 0))
    string(value 1) = data(strings_4131, integer(value 0))
    print({
        'english': '"That $1 costs #1 gold."',
        'russian': '"$1 стоит #1 золота".'
    })
    wait()

    print({
        'english': '\n\n"Interested, $Y?" ',
        'russian': '\n\n"Интересно, $Y?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        jump label_3069

    case 'n':
    case {'russian': 'н'}:
        jump label_2821
    esac

label_3069:
    if less(canCarry(integer(value 3)), weight(data(integers_4111, integer(value 0)), byte 1)):
        print({
            'english': '"But \'twould make thee o\'erburdened, $Y!"',
            'russian': '"Но тебе столько не унести, $Y!"'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_273
    fi

    if greaterOrEquals(objectsCount(integer(value 3), byte 88), integer(value 1)):
        destroyItem(integer(value 3), byte 88, byte 0, integer(value 1))
        createItem(integer(value 3), data(integers_4111, integer(value 0)), byte 0, byte 1)
        print({
            'english': '"Excellent!"\n\nAfter accepting $Y\'s gold, $N hands over the $1.',
            'russian': '"Замечательно!"\n\nВзяв золото у персонажа $Y, $N передаёт предмет $1.'
        })
        wait()

        print({
            'english': '\n\n',
            'russian': '\n\n'
        })
        jump label_2821

    else:
        print({
            'english': '"But thou hast not enough gold, $Y!"',
            'russian': '"Но у тебя не хватает золота, $Y!"'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_273
    fi

label_3292:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 1
        jump label_3438
    fi

label_3312:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_3326:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2) $Y\n',
        'russian': '#2) $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_3326
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_2644
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_3312
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_3438:
    look(integer(value 3))
    print({
        'english': '1) Arrows\n2) Bolts\n',
        'russian': '1) Стрелы\n2) Болты\n'
    })
    integer(value 7) = byte 2
    print({
        'english': '"Which kind?" ',
        'russian': '"Какого типа?" '
    })
    inputDigit(integer(value 0))

    if equals(integer(value 0), byte 0):
        jump label_2644
    fi

    if greater(integer(value 0), integer(value 7)):
        jump label_3438
    fi

    integer(value 0) = minus(plus(integer(value 9), integer(value 0)), byte 1)
    integer(value 1) = data(integers_4093, integer(value 0))
    string(value 1) = data(strings_4131, integer(value 0))
    print({
        'english': '"I only sell $1s by the dozen."',
        'russian': '"Я продаю $1 только дюжинами".'
    })
    wait()

    print({
        'english': '\n\n',
        'russian': '\n\n'
    })

label_3584:
    print({
        'english': '"How many dozens do you want, $Y?" ',
        'russian': '"Сколько дюжин вам нужно, $Y?" '
    })
    inputInteger(integer(value 5))

    if equals(integer(value 5), byte 0):
        jump label_2644
    fi

    if greater(integer(value 5), byte 100):
        jump label_3584
    fi

    integer(value 6) = byte 0

label_3655:
    if less(canCarry(integer(value 3)), weight(data(integers_4111, integer(value 0)), byte 12)):
        jump label_3829
    fi

    if less(objectsCount(integer(value 3), byte 88), integer(value 1)):
        jump label_3960
    fi

    destroyItem(integer(value 3), byte 88, byte 0, integer(value 1))
    createItem(integer(value 3), data(integers_4111, integer(value 0)), byte 0, byte 12)
    integer(value 6) = plus(integer(value 6), byte 1)

    if equals(integer(value 6), integer(value 5)):
        print({
            'english': '"Excellent!"\n\nAfter accepting $Y\'s gold, $N hands over ',
            'russian': '"Замечательно!"\n\nВзяв золото у персонажа $Y, $N передаёт '
        })
        integer(value 6) = multiply(byte 12, integer(value 6))
        print({
            'english': '#6 $1s.',
            'russian': 'предмет $1, #6 шт.'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_273

    else:
        jump label_3655
    fi

label_3829:
    if integer(value 6):
        print({
            'english': '"Thou canst not carry that many, but I will give thee ',
            'russian': '"Ты не сможешь столько унести, я отдам тебе '
        })
        integer(value 6) = multiply(byte 12, integer(value 6))
        print({
            'english': '#6 $1s, $Y."',
            'russian': '$1, #6 шт., $Y".'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_273

    else:
        print({
            'english': '"Thou canst not carry any $1s, $Y!"',
            'russian': '"Ещё $1... Тебе столько не унести, $Y!"'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_273
    fi

label_3960:
    if integer(value 6):
        print({
            'english': '"Thou canst not afford that many, but I will give thee ',
            'russian': '"Ты не сможешь столько себе позволить, я отдам тебе '
        })
        integer(value 6) = multiply(byte 12, integer(value 6))
        print({
            'english': '#6 $1s, $Y."',
            'russian': '$1s, #6 шт., $Y".'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_273

    else:
        print({
            'english': '"Thou canst not afford any $1s, $Y!"',
            'russian': '"Ещё $1... Ты не можешь позволить себе ещё, $Y!"'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_273
    fi

integers_4093 = [
    30, // 0
    10, // 1
    40, // 2
    10, // 3
    2,  // 4
    15, // 5
    25, // 6
    4,  // 7
    3,  // 8
]

integers_4111 = [
    41, // 0
    34, // 1
    42, // 2
    38, // 3
    83, // 4
    36, // 5
    13, // 6
    55, // 7
    56, // 8
    0,  // 9
]

strings_4131 = [
    {
        'english': 'Bow',
        'russian': 'Лук'
    }, // 0
    {
        'english': 'Club',
        'russian': 'Дубина'
    }, // 1
    {
        'english': 'Crossbow',
        'russian': 'Арбалет'
    }, // 2
    {
        'english': 'Dagger',
        'russian': 'Кинжал'
    }, // 3
    {
        'english': 'Oil Flask',
        'russian': 'Колба с маслом'
    }, // 4
    {
        'english': 'Spear',
        'russian': 'Копьё'
    }, // 5
    {
        'english': 'Spiked Shield',
        'russian': 'Шипастый щит'
    }, // 6
    {
        'english': 'arrow',
        'russian': 'стрелы'
    }, // 7
    {
        'english': 'bolt',
        'russian': 'болты'
    }, // 8
]

integers_4197 = [
    0, // 0
    0, // 1
    0, // 2
    0, // 3
    0, // 4
    0, // 5
    0, // 6
    0, // 7
    0, // 8
    0, // 9
    0, // 10
    0, // 11
    0, // 12
    0, // 13
    0, // 14
]

integers_4227 = [
    0, // 0
    0, // 1
    0, // 2
    0, // 3
    0, // 4
    0, // 5
    0, // 6
    0, // 7
]

source('CONVERSE.B')
index(17)

id(116)
name({
    'english': 'Homer',
    'russian': 'Гомер'
})

description:
    print({
        'english': 'a shifty-eyed character. He carries a cane and walks with a slight ',
        'russian': 'типа с бегающими глазами. Он опирается на трость и слегка '
    })
    print({
        'english': 'limp.',
        'russian': 'прихрамывает.'
    })
    wait()

    print({
        'english': '\n',
        'russian': '\n'
    })

interaction:
    clearBit(byte 235, byte 7)

    if and(and(and(and(and(and(and(notEquals(partyHasObject(word 400, byte 0), word 32769), notEquals(partyHasObject(word 401, byte 0), word 32769)), notEquals(partyHasObject(word 402, byte 0), word 32769)), notEquals(partyHasObject(word 403, byte 0), word 32769)), notEquals(partyHasObject(word 404, byte 0), word 32769)), notEquals(partyHasObject(word 405, byte 0), word 32769)), notEquals(partyHasObject(word 406, byte 0), word 32769)), notEquals(partyHasObject(word 407, byte 0), word 32769)):
        setBit(byte 235, byte 7)
    fi

    if hasBit(byte 235, byte 4):
        print({
            'english': '"You served your purpose by bringing me the cloak... Now I have no ',
            'russian': '"Мой плащ теперь у меня... Я больше '
        })
        print({
            'english': 'further need of you."',
            'russian': 'в тебе не нуждаюсь".'
        })
        wait()

        print({
            'english': '\n\n"I have big plans now, and no time to waste talking."\n',
            'russian': '\n\n"У меня есть великие планы и нет времени на разговоры".\n'
        })
        bye()
    fi

    if hasBit(byte 235, byte 2):
        clearBit(byte 235, byte 2)
        print({
            'english': '"',
            'russian': '"'
        })
        jump label_4306
    fi

    if hasBit(byte 235, value 1):
        clearBit(byte 235, value 1)
        print({
            'english': '"',
            'russian': '"'
        })
        jump label_4848
    fi

    if hasBit(byte 235, byte 5):
        jump label_3284
    fi

    if hasBit(byte 235, byte 6):
        jump label_3872
    fi

    print({
        'english': 'He takes your measure, looking you over from head to toe. "What do you',
        'russian': 'Он окидывает вас оценивающим взглядом с ног до головы. "Что тебе'
    })
    print({
        'english': ' want?"',
        'russian': ' нужно?"'
    })

label_484:
    print({
        'english': '\n',
        'russian': '\n'
    })

    ask()

    case 'name':
    case {'russian': 'имя'}:
        print({
            'english': '"Who wants to know?"\n',
            'russian': '"А кто спрашивает?"\n'
        })

        ask()
        print({
            'english': '\n"Fine, \'$Z\' - if that\'s what your name really is... You can call me ',
            'russian': '\n"Ладно, \'$Z\' - если тебя так и правда зовут... Можешь звать меня '
        })
        print({
            'english': 'Homer."',
            'russian': 'Гомером".'
        })
        setBit(byte 235, value 0)
        jump label_484

    case 'home':
    case {'russian': 'гоме'}:
        print({
            'english': '"Well, get on with it!"',
            'russian': '"Ладно, выкладывай, что там у тебя!"'
        })
        jump label_484

    case 'job':
    case {'russian': 'раб'}:
        print({
            'english': '"I once sailed on the ship called \'@Empire,\' under Captain @Hawkins."',
            'russian': '"Когда-то я ходил на корабле \'@Империя\' под командованием капитана @Хокинса".'
        })
        jump label_484

    case 'empi':
    case {'russian': 'импе'}:
    case 'sail':
    case {'russian': 'ход'}:
        print({
            'english': '"It was wrecked on the cape, southwest of here. Not too far from ',
            'russian': '"Корабль потерпел крушение на мысе, к юго-западу отсюда. Не очень далеко от '
        })
        print({
            'english': 'Serpent\'s Hold."',
            'russian': 'Змеиной Крепости".'
        })

    case 'hawk':
    case {'russian': 'хок'}:
        print({
            'english': 'His eyes light up with hatred. "That heartless bastard..."',
            'russian': 'Ненависть сверкнула в его глазах. "Этот бессердечный подонок..."'
        })
        wait()

        print({
            'english': '\n\n"He was killed by his own men, and it was no worse than he ',
            'russian': '\n\n"Его убила собственная команда. Поделом. Он это '
        })
        print({
            'english': 'deserved."',
            'russian': 'заслужил".'
        })
        wait()

        print({
            'english': '\n\nHe hesitates, then adds quickly, "Of course, I had nothing to do ',
            'russian': '\n\nОн немного колеблется, затем быстро добавляет: "Конечно, я не был в этом '
        })
        print({
            'english': 'with it."',
            'russian': 'замешан".'
        })
        jump label_484

    case 'silv':
    case {'russian': 'сереб'}:
    case 'tabl':
    case {'russian': 'табл'}:
        if notEquals(partyHasObject(byte 25, byte 0), word 32769):
            jump label_1306
        fi

        print({
            'english': 'He regards you warily. "Who sent you?"\n',
            'russian': 'Он разглядывает вас с подозрением: "Кто прислал тебя?"\n'
        })

        ask()
        print({
            'english': '\n"I see." He screws his face up into an even more suspicious ',
            'russian': '\n"Понятно". Он морщится и смотрит на вас ещё более настороженно, '
        })
        print({
            'english': 'expression than before.',
            'russian': 'чем до этого.'
        })
        wait()

        print({
            'english': '\n\n"Just why do you want to know about it, anyway?"\n',
            'russian': '\n\n"Но тебе-то какое дело до этого?"\n'
        })

        ask()
        print({
            'english': '\n"You\'re not a member of the @guild. I don\'t have to tell you ',
            'russian': '\n"Ты не состоишь в @гильдии. Я ничего тебе не скажу. Да и '
        })
        print({
            'english': 'anything."',
            'russian': 'не должен".'
        })
        jump label_484

label_1306:
        print({
            'english': '"You\'re looking for the silver tablet? It\'s part of Captain Hawkin\'s ',
            'russian': '"Ищешь серебряную табличку? Это часть зарытого @сокровища '
        })
        print({
            'english': 'buried @treasure."',
            'russian': 'капитана Хокинса".'
        })
        jump label_484

    case 'buri':
    case {'russian': 'зары'}:
    case 'trea':
    case {'russian': 'сокр'}:
        if notEquals(partyHasObject(byte 25, byte 0), word 32769):
            print({
                'english': '"It was buried in a small @cave."',
                'russian': '"Оно закопано в небольшой @пещере".'
            })

        else:
            print({
                'english': '"Don\'t know anything about it."',
                'russian': '"Мне об этом ничего не известно".'
            })
        fi

        jump label_484

    case 'cave':
    case {'russian': 'пеще'}:
        if notEquals(partyHasObject(byte 25, byte 0), word 32769):
            jump label_1821

        else:
            print({
                'english': '"What are you talking about?"',
                'russian': '"О чем ты говоришь?"'
            })
        fi

        jump label_484

    case 'guil':
    case {'russian': 'гиль'}:
        print({
            'english': '"Go ask Budo. And you didn\'t hear that from me, understand?"',
            'russian': '"Поговори с Будо. И я тебе ничего не говорил, понятно?"'
        })
        jump label_484

    case 'bye':
    case {'russian': 'пока'}:
        if notEquals(partyHasObject(byte 25, byte 0), word 32769):
            print({
                'english': '"Farewell, brother thief."',
                'russian': '"Прощай, брат вор".'
            })

        else:
            print({
                'english': '"Can\'t say its been a pleasure."',
                'russian': '"Не могу сказать, что мне было приятно".'
            })
        fi

        print({
            'english': '\n',
            'russian': '\n'
        })
        bye()

    case '*':
        if notEquals(partyHasObject(byte 25, byte 0), word 32769):
            print({
                'english': '"Can\'t help you there."',
                'russian': '"Ничем не могу помочь".'
            })

        else:
            print({
                'english': '"You\'ve got an awful lot of questions... Maybe I don\'t care to talk ',
                'russian': '"У тебя отвратительно много вопросов... $Z... А может я не хочу говорить '
            })
            print({
                'english': 'about $Z."',
                'russian': 'об этом?"'
            })
        fi
    esac

    jump label_484

label_1821:
    print({
        'english': '"After Captain Hawkins passed away, we tore his treasure map into nine',
        'russian': '"Когда капитан Хокинс отправился к праотцам, мы разорвали его карту сокровищ на девять'
    })
    print({
        'english': ' pieces."',
        'russian': ' частей".'
    })
    wait()

    print({
        'english': '\n\n"The plan was, when nobody was looking for us any more, we\'d get ',
        'russian': '\n\n"Расчет был такой - когда нас оставят в покое, мы встретимся '
    })
    print({
        'english': 'together and go dig it up."',
        'russian': 'вновь и выкопаем сокровище".'
    })
    wait()

    print({
        'english': '\n\n"Splitting up the map was my idea - that way nobody could ',
        'russian': '\n\n"Я придумал разделить карту - всё для того, чтобы один '
    })
    print({
        'english': 'doublecross the others."',
        'russian': 'не мог подставить другого".'
    })
    wait()

    print({
        'english': '\n\n"I figure after all these years the others must have given up, so ',
        'russian': '\n\n"Как выяснилось годы спустя, остальные оставили всякие попытки, поэтому '
    })
    print({
        'english': 'its alright for me to search for the treasure by myself."',
        'russian': 'будет справедливо, если я займусь поисками сокровища в одиночку".'
    })
    wait()

    print({
        'english': '\n\n"Trouble is, I\'ve got a bit of the gout in one leg, and I can\'t ',
        'russian': '\n\n"Проблема в том, что меня совсем одолела подагра, и я не смогу '
    })
    print({
        'english': 'travel much any more."',
        'russian': 'путешествовать так много, как раньше".'
    })
    wait()

    print({
        'english': '\n\n"Maybe we can help each other out."',
        'russian': '\n\n"Возможно мы сможем быть полезны друг другу".'
    })
    wait()

    print({
        'english': '\n\n"I know where my piece of the map is hidden, and if you bring me the',
        'russian': '\n\n"Я знаю, где спрятана моя часть карты. Если ты принесешь'
    })
    print({
        'english': ' other eight pieces, perhaps we could make a deal."',
        'russian': ' остальные восемь частей, возможно, мы смогли бы договориться".'
    })
    wait()

    print({
        'english': '\n\n"I\'ll tell you all I know about where the pieces might be..."',
        'russian': '\n\n"Скажу вам всем вот что: я знаю, где могут находиться остальные части..."'
    })
    wait()

    print({
        'english': '\n\n"Ol\' Hawknose set out for the Dry Land, to kill the daemon that is ',
        'russian': '\n\n"Старый Клюв отправился в Сухие земли, чтобы убить даймона, который '
    })
    print({
        'english': 'said to live there."',
        'russian': 'завёлся там, как говорят".'
    })
    wait()

    print({
        'english': '\n\n"Sandy, the ship\'s cook, went to Trinsic with the first mate."',
        'russian': '\n\n"Сэнди, корабельный кок, и старпом вместе отправились в Тринсик".'
    })
    wait()

    print({
        'english': '\n\n"Old Ybarra said he was headed for the dungeon Shame, looking for ',
        'russian': '\n\n"Старый Ибарра сказал, что собирается в подземелье Позора - искать ещё '
    })
    print({
        'english': 'more treasure."',
        'russian': 'сокровища".'
    })
    wait()

    print({
        'english': '\n\n"I think one of the men died in a shipwreck."',
        'russian': '\n\n"Полагаю, что один член экипажа погиб в крушении".'
    })
    wait()

    print({
        'english': '\n\n"Then there was one more... Can\'t remember his name, but I\'ve heard ',
        'russian': '\n\n"Остается ещё один... Не припоминаю его имени, но говорили, '
    })
    print({
        'english': 'tell he settled in Jhelom."',
        'russian': 'что он обосновался в Джеломе".'
    })
    wait()

    print({
        'english': '\n\n"He\'ll be easy to recognize - he has a hook in place o\' one of his ',
        'russian': '\n\n"Его просто узнать - у него торчит крюк вместо '
    })
    print({
        'english': 'hands."',
        'russian': 'руки".'
    })
    wait()

    print({
        'english': '\n\n"That\'s all I know. Perhaps in your travels you can find out where ',
        'russian': '\n\n"Это всё, что я знаю. Возможно, в своих странствиях тебе удастся узнать, '
    })
    print({
        'english': 'the others have gone."',
        'russian': 'куда делись остальные".'
    })
    wait()

    print({
        'english': '\n\n"When you find the pieces, you can lay them out on the ground to see',
        'russian': '\n\n"Когда отыщешь части, можешь разложить их на полу, чтобы понять,'
    })
    print({
        'english': ' how they fit together."',
        'russian': ' как их собрать вместе".'
    })
    wait()

    print({
        'english': '\n\n"But remember, only I know where the ninth piece is, so come back ',
        'russian': '\n\n"Но помни, что только я знаю, где лежит девятая часть. Поэтому возвращайся '
    })
    print({
        'english': 'here when you\'ve got the other eight."\n',
        'russian': 'сюда, когда получишь остальные восемь".\n'
    })
    setBit(byte 235, byte 6)
    bye()

label_3284:
    print({
        'english': '"Have you found the storm cloak yet?" ',
        'russian': '"Удалось найти мой дождевой плащ?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Then get off your duff and go dig it up!"\n',
            'russian': '"Тогда отрывай свой зад и иди искать его!"\n'
        })
        bye()

    case 'y':
    case {'russian': 'д'}:
    esac

    print({
        'english': '"Then hand it over and we\'re even." His eyes gleam with greedy ',
        'russian': '"Тогда давай его сюда и мы квиты". Жадность промелькнула в '
    })
    print({
        'english': 'anticipation.',
        'russian': 'его глаза.'
    })
    wait()

    print({
        'english': '\n\nDo you give him the cloak? ',
        'russian': '\n\nОтдать ему плащ? '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Blast ye! If I still had two good legs, I\'d keelhaul the lot of you!"',
            'russian': '"Да чтоб тебя! Были бы у меня здоровые ноги, я бы протащил тебя под килем!"'
        })
        wait()

        print({
            'english': '\n\n"We had a deal! Besides, I helped steal that treasure myself, fair ',
            'russian': '\n\n"Договорились! К тому же, я сам помогал красть это сокровище, так '
        })
        print({
            'english': 'and square."',
            'russian': 'что всё честно".'
        })
        wait()

        print({
            'english': '\n"Can\'t trust anybody these days..."\n',
            'russian': '\n"Сейчас такое время, что никому нельзя доверять..."\n'
        })
        decreaseKarma(byte 10)
        bye()

    case 'y':
    case {'russian': 'д'}:
    esac

    integer(value 0) = partyHasObject(byte 81, byte 0)

    if equals(integer(value 0), word 32769):
        print({
            'english': 'You have no storm cloak to give him.\n',
            'russian': 'У вас нет дождевого плаща.\n'
        })
        bye()
    fi

    moveItem(byte 81, byte 0, integer(value 0), byte 235)
    increaseKarma(byte 10)
    setBit(byte 235, byte 4)
    print({
        'english': 'He takes the cloak from you. "Thanks for keeping your word. There\'s ',
        'russian': 'Он принимает плащ. "Спасибо, что держишь своё слово. В наше время '
    })
    print({
        'english': 'not many that does, these days..."\n',
        'russian': 'немногие могут похвастать этим..."\n'
    })
    bye()

label_3872:
    print({
        'english': '"So, have ye found the eight pieces of the map yet?" ',
        'russian': '"Ну что, удалось отыскать восемь частей карты?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Then what are you wasting my time for?"',
            'russian': '"Тогда почему ты тратишь моё время?"'
        })
        jump label_484

    case 'y':
    case {'russian': 'д'}:
    esac

    if equals(hasBit(byte 235, byte 7), byte 0):
        print({
            'english': '"Best count again. You need eight pieces before I\'ll bargain with ',
            'russian': '"Научись считать. Тебе нужно восемь частей, прежде чем обменяться '
        })
        print({
            'english': 'you."',
            'russian': 'со мной".'
        })
        jump label_484
    fi

    print({
        'english': '"Very well. I\'ve been thinking about how we could work out a deal."',
        'russian': '"Прекрасно. Я размышлял, как нам поступить".'
    })
    wait()

    print({
        'english': '\n\n"I know you want the silver tablet. Far as I\'m concerned, you can ',
        'russian': '\n\n"Я знаю, что тебе нужна серебряная табличка. Что до меня, так пускай она '
    })
    print({
        'english': 'have it."',
        'russian': 'будет твоя".'
    })
    wait()

    print({
        'english': '\n"All I really want is the magical cloak that\'s buried with the rest ',
        'russian': '\n"Всё, что мне нужно, это магический плащ, который закопан с остальным '
    })
    print({
        'english': 'of the treasure."',
        'russian': 'сокровищем".'
    })
    wait()

    print({
        'english': '\n\n"So ',
        'russian': '\n\n"Поэтому '
    })

label_4306:
    print({
        'english': 'I\'ll tell you where the ninth piece of the map is if you promise to ',
        'russian': 'я расскажу тебе, где лежит девятая часть карты, если пообещаешь '
    })
    print({
        'english': 'bring me the cloak."',
        'russian': 'принести мне плащ".'
    })
    wait()

    print({
        'english': '\n\n"The rest of the treasure should be loot enough to satisfy you. Is ',
        'russian': '\n\n"Остального сокровища тебе должно хватить с лихвой. Ну как, '
    })
    print({
        'english': 'it a deal?" ',
        'russian': 'по рукам?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Suit yourself, mate, that\'s the only deal I\'ll offer."\n',
            'russian': '"Как хочешь, дружок, никаких других условий я предложить не могу".\n'
        })
        setBit(byte 235, byte 2)
        bye()

    case 'y':
    case {'russian': 'д'}:
    esac

    print({
        'english': '\n"Okay. The ninth piece of the map is hidden..."',
        'russian': '\n"Хорошо. Девятая часть карты спрятана..."'
    })
    wait()

    print({
        'english': '\n\n"Right here in my pocket!" He grins wickedly.',
        'russian': '\n\n"Прямо здесь, у меня в кармане!" Он зловеще ухмыльнулся.'
    })
    wait()

    print({
        'english': '\n\n"I had to keep it safe while you were off gathering the others, ',
        'russian': '\n\n"Пришлось положить её в сохранное место, пока идёт поиск остальных частей, '
    })
    print({
        'english': 'didn\'t I?"',
        'russian': 'правильно?"'
    })
    wait()

    print({
        'english': '\n\nHe hands you the last piece of the map.\n*\n"The island in the upper ',
        'russian': '\n\nОн отдаёт вам последнюю часть карты.\n*\n"Остров в верхнем '
    })
    print({
        'english': 'left hand corner is Buccaneer\'s Den."',
        'russian': 'левом углу - это Логово Пиратов".'
    })
    wait()

    moveItem(word 408, byte 0, byte 235, byte 1)
    print({
        'english': '\n\n"',
        'russian': '\n\n"'
    })

label_4848:
    print({
        'english': 'You\'ll keep your word and come right back here with the magic storm ',
        'russian': 'Сдержи своё слово и возвратись сюда с волшебном дождевым '
    })
    print({
        'english': 'cloak, won\'t you?" ',
        'russian': 'плащом, хорошо?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Don\'t want to keep your word now that you have the map, eh?"',
            'russian': '"Ага, не хочешь держать своё слово, потому что карта уже в кармане, да?"'
        })
        wait()

        print({
            'english': '\n"Well, then, I won\'t tell you where you need to dig to find the ',
            'russian': '\n"Ладно, тогда я не скажу, где копать, чтобы найти '
        })
        print({
            'english': 'treasure!"\n',
            'russian': 'сокровище!"\n'
        })
        setBit(byte 235, value 1)
        bye()

    case 'y':
    case {'russian': 'д'}:
        setBit(byte 235, byte 5)
    esac

    print({
        'english': '"Good. Then I\'ll tell you this:"',
        'russian': '"Хорошо. Тогда слушай внимательно".'
    })
    wait()

    print({
        'english': '\n\n"When you reach the island marked with the X, find the three stones ',
        'russian': '\n\n"Когда достигнешь острова, помеченного буквой X, отыщи три камня '
    })
    print({
        'english': 'and stand in the center."',
        'russian': 'и встань посередине".'
    })
    wait()

    print({
        'english': '\n\n"Then walk three paces due south, nine paces due west, and twelve ',
        'russian': '\n\n"Затем сделай три шага строго на юг, девять шагов строго на запад и ещё двенадцать '
    })
    print({
        'english': 'more paces south."',
        'russian': '- на юг".'
    })
    wait()

    print({
        'english': '\n\n"That should put you right next to an old dead tree."',
        'russian': '\n\n"Так ты окажешься возле старого засохшего дерева".'
    })
    wait()

    print({
        'english': '\n\n"Dig in the patch of dirt just to the south of you, and you\'ll find ',
        'russian': '\n\n"Начни копать участок земли к югу от тебя - и ты найдёшь '
    })
    print({
        'english': 'the treasure!"',
        'russian': 'сокровище!"'
    })
    wait()

    print({
        'english': '\n\n"Now go get it!"\n',
        'russian': '\n\n"Теперь ступай и найди его!"\n'
    })
    bye()

source('CONVERSE.B')
index(17)

id(116)
name('Homer')

description:
    print('a shifty-eyed character. He carries a cane and walks with a slight ')
    print('limp.')
    wait()

    print('\n')

interaction:
    ('CLEARF', ('byte', 235), ('byte', 7))

    if and(and(and(and(and(and(and(notEquals(partyHasObject(word 400, byte 0), word 32769), notEquals(partyHasObject(word 401, byte 0), word 32769)), notEquals(partyHasObject(word 402, byte 0), word 32769)), notEquals(partyHasObject(word 403, byte 0), word 32769)), notEquals(partyHasObject(word 404, byte 0), word 32769)), notEquals(partyHasObject(word 405, byte 0), word 32769)), notEquals(partyHasObject(word 406, byte 0), word 32769)), notEquals(partyHasObject(word 407, byte 0), word 32769)):
        ('SETF', ('byte', 235), ('byte', 7))
    fi

    if hasBit(byte 235, byte 4):
        print('"You served your purpose by bringing me the cloak... Now I have no ')
        print('further need of you."')
        wait()

        print('\n\n"I have big plans now, and no time to waste talking."\n')
        bye()
    fi

    if hasBit(byte 235, byte 2):
        ('CLEARF', ('byte', 235), ('byte', 2))
        print('"')
        jump 4306
    fi

    if hasBit(byte 235, value 1):
        ('CLEARF', ('byte', 235), ('value', 1))
        print('"')
        jump 4848
    fi

    if hasBit(byte 235, byte 5):
        jump 3284
    fi

    if hasBit(byte 235, byte 6):
        jump 3872
    fi

    print('He takes your measure, looking you over from head to toe. "What do you')
    print(' want?"\n')

    ask()

    case 'name':
        print('"Who wants to know?"\n')

        ask()
        print('\n"Fine, \'$Z\' - if that\'s what your name really is... You can call me ')
        print('Homer."')
        ('SETF', ('byte', 235), ('value', 0))
        jump 484

    case 'home':
        print('"Well, get on with it!"')
        jump 484

    case 'job':
        print('"I once sailed on the ship called \'@Empire,\' under Captain @Hawkins."')
        jump 484

    case 'empi':
    case 'sail':
        print('"It was wrecked on the cape, southwest of here. Not too far from ')
        print('Serpent\'s Hold."')

    case 'hawk':
        print('His eyes light up with hatred. "That heartless bastard..."')
        wait()

        print('\n\n"He was killed by his own men, and it was no worse than he ')
        print('deserved."')
        wait()

        print('\n\nHe hesitates, then adds quickly, "Of course, I had nothing to do ')
        print('with it."')
        jump 484

    case 'silv':
    case 'tabl':
        if notEquals(partyHasObject(byte 25, byte 0), word 32769):
            jump 1306
        fi

        print('He regards you warily. "Who sent you?"\n')

        ask()
        print('\n"I see." He screws his face up into an even more suspicious ')
        print('expression than before.')
        wait()

        print('\n\n"Just why do you want to know about it, anyway?"\n')

        ask()
        print('\n"You\'re not a member of the @guild. I don\'t have to tell you ')
        print('anything."')
        jump 484

1306:
        print('"You\'re looking for the silver tablet? It\'s part of Captain Hawkin\'s ')
        print('buried @treasure."')
        jump 484

    case 'buri':
    case 'trea':
        if notEquals(partyHasObject(byte 25, byte 0), word 32769):
            print('"It was buried in a small @cave."')

        else:
            print('"Don\'t know anything about it."')
        fi

        jump 484

    case 'cave':
        if notEquals(partyHasObject(byte 25, byte 0), word 32769):
            jump 1821

        else:
            print('"What are you talking about?"')
        fi

        jump 484

    case 'guil':
        print('"Go ask Budo. And you didn\'t hear that from me, understand?"')
        jump 484

    case 'bye':
        if notEquals(partyHasObject(byte 25, byte 0), word 32769):
            print('"Farewell, brother thief."')

        else:
            print('"Can\'t say its been a pleasure."')
        fi

        print('\n')
        bye()

    case '*':
        if notEquals(partyHasObject(byte 25, byte 0), word 32769):
            print('"Can\'t help you there."')

        else:
            print('"You\'ve got an awful lot of questions... Maybe I don\'t care to talk ')
            print('about $Z."')
        fi
    esac

    jump 484

1821:
    print('"After Captain Hawkins passed away, we tore his treasure map into nine')
    print(' pieces."')
    wait()

    print('\n\n"The plan was, when nobody was looking for us any more, we\'d get ')
    print('together and go dig it up."')
    wait()

    print('\n\n"Splitting up the map was my idea - that way nobody could ')
    print('doublecross the others."')
    wait()

    print('\n\n"I figure after all these years the others must have given up, so ')
    print('its alright for me to search for the treasure by myself."')
    wait()

    print('\n\n"Trouble is, I\'ve got a bit of the gout in one leg, and I can\'t ')
    print('travel much any more."')
    wait()

    print('\n\n"Maybe we can help each other out."')
    wait()

    print('\n\n"I know where my piece of the map is hidden, and if you bring me the')
    print(' other eight pieces, perhaps we could make a deal."')
    wait()

    print('\n\n"I\'ll tell you all I know about where the pieces might be..."')
    wait()

    print('\n\n"Ol\' Hawknose set out for the Dry Land, to kill the daemon that is ')
    print('said to live there."')
    wait()

    print('\n\n"Sandy, the ship\'s cook, went to Trinsic with the first mate."')
    wait()

    print('\n\n"Old Ybarra said he was headed for the dungeon Shame, looking for ')
    print('more treasure."')
    wait()

    print('\n\n"I think one of the men died in a shipwreck."')
    wait()

    print('\n\n"Then there was one more... Can\'t remember his name, but I\'ve heard ')
    print('tell he settled in Jhelom."')
    wait()

    print('\n\n"He\'ll be easy to recognize - he has a hook in place o\' one of his ')
    print('hands."')
    wait()

    print('\n\n"That\'s all I know. Perhaps in your travels you can find out where ')
    print('the others have gone."')
    wait()

    print('\n\n"When you find the pieces, you can lay them out on the ground to see')
    print(' how they fit together."')
    wait()

    print('\n\n"But remember, only I know where the ninth piece is, so come back ')
    print('here when you\'ve got the other eight."\n')
    ('SETF', ('byte', 235), ('byte', 6))
    bye()

3284:
    print('"Have you found the storm cloak yet?" ')

    askc('yn')

    case 'n':
        print('"Then get off your duff and go dig it up!"\n')
        bye()

    case 'y':
    esac

    print('"Then hand it over and we\'re even." His eyes gleam with greedy ')
    print('anticipation.')
    wait()

    print('\n\nDo you give him the cloak? ')

    askc('yn')

    case 'n':
        print('"Blast ye! If I still had two good legs, I\'d keelhaul the lot of you!"')
        wait()

        print('\n\n"We had a deal! Besides, I helped steal that treasure myself, fair ')
        print('and square."')
        wait()

        print('\n"Can\'t trust anybody these days..."\n')
        ('SUB_KARMA', ('byte', 10))
        bye()

    case 'y':
    esac

    integer(value 0) = partyHasObject(byte 81, byte 0)

    if equals(integer(value 0), word 32769):
        print('You have no storm cloak to give him.\n')
        bye()
    fi

    ('GIVE', ('byte', 81), ('byte', 0), ('integer', [('value', 0)]), ('byte', 235))
    ('ADD_KARMA', ('byte', 10))
    ('SETF', ('byte', 235), ('byte', 4))
    print('He takes the cloak from you. "Thanks for keeping your word. There\'s ')
    print('not many that does, these days..."\n')
    bye()

3872:
    print('"So, have ye found the eight pieces of the map yet?" ')

    askc('yn')

    case 'n':
        print('"Then what are you wasting my time for?"')
        jump 484

    case 'y':
    esac

    if equals(hasBit(byte 235, byte 7), byte 0):
        print('"Best count again. You need eight pieces before I\'ll bargain with ')
        print('you."')
        jump 484
    fi

    print('"Very well. I\'ve been thinking about how we could work out a deal."')
    wait()

    print('\n\n"I know you want the silver tablet. Far as I\'m concerned, you can ')
    print('have it."')
    wait()

    print('\n"All I really want is the magical cloak that\'s buried with the rest ')
    print('of the treasure."')
    wait()

    print('\n\n"So I\'ll tell you where the ninth piece of the map is if you promise')
    print(' to bring me the cloak."')
    wait()

    print('\n\n"The rest of the treasure should be loot enough to satisfy you. Is ')
    print('it a deal?" ')

    askc('yn')

    case 'n':
        print('"Suit yourself, mate, that\'s the only deal I\'ll offer."\n')
        ('SETF', ('byte', 235), ('byte', 2))
        bye()

    case 'y':
    esac

    print('\n"Okay. The ninth piece of the map is hidden..."')
    wait()

    print('\n\n"Right here in my pocket!" He grins wickedly.')
    wait()

    print('\n\n"I had to keep it safe while you were off gathering the others, ')
    print('didn\'t I?"')
    wait()

    print('\n\nHe hands you the last piece of the map.\n*\n"The island in the upper ')
    print('left hand corner is Buccaneer\'s Den."')
    wait()

    ('GIVE', ('word', 408), ('byte', 0), ('byte', 235), ('byte', 1))
    print('\n\n"You\'ll keep your word and come right back here with the magic storm')
    print(' cloak, won\'t you?" ')

    askc('yn')

    case 'n':
        print('"Don\'t want to keep your word now that you have the map, eh?"')
        wait()

        print('\n"Well, then, I won\'t tell you where you need to dig to find the ')
        print('treasure!"\n')
        ('SETF', ('byte', 235), ('value', 1))
        bye()

    case 'y':
        ('SETF', ('byte', 235), ('byte', 5))
    esac

    print('"Good. Then I\'ll tell you this:"')
    wait()

    print('\n\n"When you reach the island marked with the X, find the three stones ')
    print('and stand in the center."')
    wait()

    print('\n\n"Then walk three paces due south, nine paces due west, and twelve ')
    print('more paces south."')
    wait()

    print('\n\n"That should put you right next to an old dead tree."')
    wait()

    print('\n\n"Dig in the patch of dirt just to the south of you, and you\'ll find ')
    print('the treasure!"')
    wait()

    print('\n\n"Now go get it!"\n')
    bye()

source('CONVERSE.A')
index(25)

id(25)
name('Cullen')

description:
    print('a short, dark man, covered in white flour.')
    wait()

interaction:
    print('\n"Hello ')

    if hasBit(byte 235, value 0):
        print('again')

    else:
        print('there')
        ('SETF', ('byte', 235), ('value', 0))
    fi

    print(', my friend')

    if integer(value 23):
        print('s')
    fi

    print('!"')
    wait()

    print('\n\nAs he shakes your hand enthusiastically, clouds of flour fly off his')
    print(' clothes.\n')

    ask()

    case 'name':
        print('"I\'m Cullen, Cullen the @Baker."')
        jump label_184

    case 'job':
        print('"I\'d have thought that\'d be obvious! I\'m a @baker!"')
        wait()

        print('\n\nAs he laughs heartily, more clouds of flour rise off his clothing.')
        wait()

        print('\n\n"You can @buy bakery goods from me or perhaps you have some flour to')
        print(' @sell, eh?"')
        jump label_184

    case 'bake':
        print('"I bake goods for Lord British himself!" the man says proudly.')
        wait()

        print('\n\n"If you\'d like to @buy some, just say the word!"')
        jump label_184

    case 'buy':
        jump label_695

    case 'flou':
    case 'sell':
        jump label_1941

    case 'bye':
        print('"Come again soon!"\n')
        bye()

    case '*':
        print('"Hmmm... $Z..."')
        wait()

        print('\n\n"$Z..."')
        wait()

        print('\n\n"Nope, I don\'t know anything about that!"')
        jump label_184
    esac

label_695:
    if notEquals(integer(value 32), byte 144):
        print('"Come to my shop when it\'s open!"')
        jump label_184
    fi

    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 0
        jump label_893
    fi

label_761:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_775:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print('#2) $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_775
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        print('"Suit yourself."')
        jump label_184
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_761
    fi

label_893:
    integer(value 0) = byte 1
    integer(value 9) = integer(value 3)
    integer(value 3) = character(integer(value 3), byte 0)
    ('SETNAME', ('integer', [('value', 3)]))

label_921:
    string(value 0) = data(dword 2697, minus(integer(value 0), byte 1))
    print('#0) $0\n')
    integer(value 0) = plus(integer(value 0), byte 1)

    if notEquals(data(dword 2689, minus(integer(value 0), byte 1)), byte 0):
        jump label_921
    fi

    integer(value 7) = integer(value 0)
    print('"Which item?" ')
    ('INPUTNUM', 0)

    if equals(integer(value 0), byte 0):
        print('"Suit thyself, $Y, but thou\'lt find no better!"')
        jump label_184
    fi

    if greaterOrEquals(integer(value 0), integer(value 7)):
        jump label_893
    fi

    integer(value 0) = minus(integer(value 0), byte 1)
    integer(value 1) = data(dword 2683, integer(value 0))
    string(value 1) = data(dword 2697, integer(value 0))
    print('"Those cost #1 gold each."')

label_1135:
    wait()

    print('\n\n"How many do you want, $Y?" ')
    ('INPUT', 4)

    if equals(integer(value 4), byte 0):
        print('"Suit thyself, but thou\'lt find no better!"')
        jump label_1742
    fi

    if greater(integer(value 4), byte 50):
        print('"Whoa! Don\'t buy out my entire stock!"')
        jump label_1135
    fi

    integer(value 5) = byte 0

label_1283:
    if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), multiply(plus(integer(value 5), byte 1), weight(data(dword 2689, integer(value 0)), byte 1))):
        jump label_1404
    fi

    if less(objectsCount(integer(value 3), byte 88), multiply(integer(value 1), plus(integer(value 5), byte 1))):
        jump label_1526
    fi

    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 1)]))
    ('NEW', ('integer', [('value', 3)]), ('data', [('dword', 2689), ('integer', [('value', 0)])]), ('byte', 0), ('byte', 1))
    integer(value 5) = plus(integer(value 5), byte 1)

    if equals(integer(value 5), minus(integer(value 4), byte 1)):
        jump label_1657

    else:
        jump label_1283
    fi

label_1404:
    if integer(value 5):
        print('"Thou canst not carry that many!"')
        wait()

        print('\n\n"I will sell thee just #5 $1\\s."')
        wait()

        print('\n\n')
        jump label_1657

    else:
        print('"But thou canst not carry any $1s!"')
        jump label_1742
    fi

label_1526:
    if integer(value 5):
        print('"Thou hast not enough gold for that many!"')
        wait()

        print('\n\n"I will sell thee just #5 $1\\s."')
        wait()

        print('\n\n')
        jump label_1657

    else:
        print('"But thou canst not afford any $1!"')
        jump label_1742
    fi

label_1657:
    print('"Here\'s thy $1')

    if greaterOrEquals(and(greater(integer(value 5), byte 11), canCarry(integer(value 3))), weight(data(dword 2689, integer(value 0)), byte 1)):
        ('NEW', ('integer', [('value', 3)]), ('data', [('dword', 2689), ('integer', [('value', 0)])]), ('byte', 0), ('byte', 1))
        print(', plus one for luck!"')

    else:
        print(', $Y."')
    fi

label_1742:
    wait()

    print('\n\n"How about something else, $Y?" ')

    choice('yn')

    case 'y':
        jump label_893

    case 'n':
        if equals(integer(value 23), byte 0):
            print('"Perhaps some other time, then."')
            jump label_184
        fi

        if greater(integer(value 23), byte 1):
            print('"Perhaps one of thy friends, then?"\n\n')
            jump label_695
        fi

        print('"Perhaps thy friend, then?"\n\n')

        if integer(value 9):
            integer(value 3) = byte 0

        else:
            integer(value 3) = byte 1
        fi

        jump label_893
    esac

label_1941:
    if notEquals(integer(value 32), byte 144):
        print('"Come to my shop when it\'s open!"')
        jump label_184
    fi

    integer(value 0) = byte 0
    integer(value 2) = byte 0
    integer(value 3) = byte 0

label_2008:
    integer(value 1) = byte 0

label_2015:
    if objectsCount(character(integer(value 0), byte 0), byte 167):
        data(dword 2667, integer(value 2)) = integer(value 0)
        integer(value 2) = plus(integer(value 2), byte 1)
        integer(value 3) = byte 1
        jump label_2084
    fi

    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), byte 7):
        jump label_2015
    fi

label_2084:
    integer(value 0) = plus(integer(value 0), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_2008
    fi

    if equals(integer(value 3), byte 0):
        print('"Sorry, none of you has any flour."')
        wait()

        print('\n')
        jump label_2627
    fi

    if equals(integer(value 2), byte 1):
        integer(value 3) = data(dword 2667, byte 0)
        jump label_2318
    fi

label_2183:
    integer(value 0) = byte 0
    integer(value 1) = byte 1

label_2197:
    ('SETNAME', ('character', [('data', [('dword', 2667), ('integer', [('value', 0)])]), ('byte', 0)]))
    print('#1. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 0), integer(value 2)):
        jump label_2197
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump label_2577
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greaterOrEquals(integer(value 3), integer(value 2)):
        jump label_2183
    fi

    integer(value 3) = data(dword 2667, integer(value 3))

label_2318:
    integer(value 4) = objectsCount(character(integer(value 3), byte 0), byte 167)
    ('SETNAME', ('character', [('integer', [('value', 3)]), ('byte', 0)]))

    if equals(integer(value 4), byte 0):
        jump label_2539
    fi

    print('$N turns to $Y, and says "Will you take 5 gold for that sack of ')
    print('flour?" ')

    choice('yn')

    case 'y':
        print('"Done!" He hands $Y 5 gold pieces and takes the sack of flour.')
        ('DELETE', ('character', [('integer', [('value', 3)]), ('byte', 0)]), ('byte', 167), ('byte', 0), ('byte', 1))
        ('NEW', ('character', [('integer', [('value', 3)]), ('byte', 0)]), ('byte', 88), ('byte', 0), ('byte', 5))
        wait()

        print('\n')
        jump label_2627

    case 'n':
        jump label_2577
    esac

label_2539:
    print('"Sorry, you haven\'t any flour."')
    wait()

    print('\n')
    jump label_2627

label_2577:
    print('"Changed your mind, eh?" he folds his arms.')
    wait()

    print('\n')
    jump label_2627

label_2627:
    print('\n"Well, what else will it be then?"')
    jump label_184

integers_2667 = [
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
]

integers_2683 = [
    3,
    5,
    1,
]

integers_2689 = [
    128,
    131,
    130,
    0,
]

strings_2697 = [
    'Bread',
    'Cake',
    'Rolls',
]

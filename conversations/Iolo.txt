source("CONVERSE.A")
index(4)

id(4)
name("Iolo")

description:
    print("your old friend Iolo.\n*")

interaction:
    ('SETF', ('byte', 235), ('value', 0))
    print("\"Well, $P, do you need @help with something? Or maybe you've got time ")
    print("for a @story, eh?\"\n")

    ask()
    integer(value 3) = byte 0

134:
    case "name":
        print("\"Iolo's the only name I remember having.\" (He pronounces his name 'Yo-")
        print("low.')")
        jump 125

    case "help":
        print("\"If you want me to @gather all our gold together so you can carry it, ")
        print("just say so.\"\n*\n\"Or I could @split it up evenly, if you prefer.\"")
        jump 125

    case "gath":
    case "pool":
        jump 4466

    case "shar":
    case "spli":
        jump 4873

    case "clue":
    case "home":
    case "hut":
    case "smit":
        print("\"My hut is in the Deep Forest, south of Yew.\"\n*\n\"My horse Smith lives ")
        print("there.\"")
        jump 125

    case "job":
        print("\"I've been a crossbow maker for so long, I've gotten weary of it.\"\n\n")
        print("*\"Hopefully, now that my @apprentice has taken over the shop, I'll be ")
        print("able to spend more time as a @bard.\"")
        jump 125

    case "appr":
    case "cros":
    case "shop":
        print("\"My shop still sells the finest crossbows in the land.\"\n*\n\"I've done a")
        print(" lot over the years to refine the design, and I trained my apprentice ")
        print("well.\"\n*\n\"I'm sure she'll carry on the tradition in fine fashion.\"")
        jump 125

    case "bard":
        print("\"Yes, it's always been a hobby of mine.\"\n*\n\"Have you heard the piece ")
        print("'Stones' that I composed some years ago?\" ")
        jump 2623

    case "gwen":
    case "wife":
        print("\"She's had more time to develop her musical talents than I all these ")
        print("years.\"\n*\n\"But after this @quest I hope to join her in @Minoc and ")
        print("enter the artisan's @guild.\"")
        jump 125

    case "ques":
        print("\"There always seems to be a quest when you come to visit us, doesn't ")
        print("there?\"\n*\n\"Some time you should just drop by for @tea.\"")
        jump 125

    case "tea":
        print("\"All right, make it Frasier's @Folly, then.\"")
        jump 125

    case "foll":
    case "fras":
        print("\"A drink worthy enough to greet an old friend.\"")
        jump 125

    case "mino":
        print("\"Not as big as @Britain, but it's a peaceful town.\"")
        jump 125

    case "arti":
    case "guil":
    case "musi":
        print("\"Though there is still need for the instruments of war, as I grow in ")
        print("years I would now take up those of peace.\"")
        jump 125

    case "brit":
        print("\"You know. Where Mr. @Nose hangs out.\"")
        jump 125

    case "mr":
    case "nibs":
    case "nose":
        print("\"Remember, he doesn't like people to call him that...\"")
        jump 125

    case "join":
        print("\"I've been with you since we saved you from those @gargoyles, haven't ")
        print("I?\"")
        jump 125

    case "garg":
        print("\"They're pretty ugly looking, if you ask me...\"")
        jump 125

    case "leav":
        print("\"His nibs, the king, told me I should stay with you constantly.\"\n*\n")
        print("\"I'll make an exception when you have to relieve yourself, of course.\"")
        jump 125

    case "stor":
        print("\"My favorite one is about the time I had to wake Dupre up for a ")
        print("tournament...")

        if partyHas(byte 2):
            print("\"\n")
            wait()

            ('PORTRAIT', ('byte', 2))
            print("\nDupre cuts in.\n\"Iolo! You promised NEVER to tell anyone about that!\"\n")
            wait()

            ('PORTRAIT', ('byte', 4))
            print("\n\"Yes, you're right. I'm sorry.\" He whispers to you, \"Ask me later ")
            print("when he's not around...\"")

        else:
            print("\"\n")
            wait()

            print("\n\"But maybe I shouldn't tell you about that. After all, I did ")
            print("promise...\"")

        endif

        jump 125

    case "bye":
        print("\"I've still got to tell you that story about Dupre sometime...\"\n")
        bye()

    case "spam":
        print("\"Ask Shamino about that.\"")
        integer(value 3) = plus(integer(value 3), byte 1)

        ask()
        jump 134

    case "humbug":
        if equals(integer(value 3), byte 3):
            integer(value 9) = integer(value 20)
            jump 2734

        endif

        print("\"Ask Shamino about that.\"")
        jump 125

    case "*":
        print("\"Ask Shamino about that.\"")

    esac

    jump 125

2623:
    askc("yn")

    case "n":
        print("\"Oh, you should get my wife @Gwenno to teach it to you some time.\"")
        jump 125

    esac

    print("\n\"It's one of my favorites.\"")
    jump 125

2734:
    print("Secret Cheaters Menu!\n1. Get items\n2. Set flags\n3. View npcs\n4. Edit ")
    print("party\n5. Edit player\n")
    ('INPUTNUM', 0)
    print("\n")

    if equals(integer(value 0), byte 1):
        jump 2911

    endif

    if equals(integer(value 0), byte 2):
        jump 3063

    endif

    if equals(integer(value 0), byte 3):
        jump 3229

    endif

    if equals(integer(value 0), byte 4):
        jump 3693

    endif

    if equals(integer(value 0), byte 5):
        jump 4239

    endif

    print("Have a nice day!\n")
    bye()

2911:
    print("Object number?\n")
    ('INPUT', 0)
    print("Quality? ")
    ('INPUT', 1)
    print("Quantity? ")
    ('INPUT', 2)

    if equals(integer(value 2), byte 0):
        integer(value 2) = byte 1

    endif

    if less(canCarry(byte 1), weight(integer(value 0), integer(value 2))):
        print("\"That's too heavy for you... But I'll let you have it anyway!\"\n*")

    endif

    ('NEW', ('byte', 1), ('integer', [('value', 0)]), ('integer', [('value', 1)]), ('integer', [('value', 2)]))
    jump 2734

3063:
    print("\nNpc number? ")
    ('INPUT', 0)

    if equals(integer(value 0), byte 0):
        jump 2734

    endif

3092:
    print("\n\nM H 2 3 4 5 6 7\n")
    integer(value 1) = byte 0

3117:
    integer(value 2) = hasBit(integer(value 0), integer(value 1))
    print("#2 ")
    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), byte 8):
        jump 3117

    endif

    print("\n\n0-7 to toggle, 8 or 9 exits: ")
    ('INPUTNUM', 3)

    if greater(integer(value 3), byte 7):
        print("\n")
        jump 3063

    endif

    if hasBit(integer(value 0), integer(value 3)):
        ('CLEARF', ('integer', [('value', 0)]), ('integer', [('value', 3)]))

    else:
        ('SETF', ('integer', [('value', 0)]), ('integer', [('value', 3)]))

    endif

    jump 3092

3229:
    print("1. Portraits\n2. Inventories\n3. Item search\n4. Set worktype\n")
    ('INPUTNUM', 0)
    print("\n")

    if equals(integer(value 0), byte 1):
        jump 3349

    endif

    if equals(integer(value 0), byte 2):
        jump 3349

    endif

    if equals(integer(value 0), byte 3):
        jump 3524

    endif

    if equals(integer(value 0), byte 4):
        jump 3629

    endif

    jump 2734

3349:
    print("1. Individuals\n2. View all\n")
    ('INPUTNUM', 1)
    print("\n")

    if equals(integer(value 1), byte 1):
        jump 3411

    endif

    if equals(integer(value 1), byte 2):
        jump 3462

    endif

    jump 3229

3411:
    print("Npc number? ")
    ('INPUT', 1)
    print("\n")

    if equals(integer(value 1), byte 0):
        jump 3229

    endif

    if equals(integer(value 0), byte 1):
        ('PORTRAIT', ('integer', [('value', 1)]))

    else:
        ('INVENTORY', ('integer', [('value', 1)]))

    endif

    jump 3411

3462:
    integer(value 1) = byte 1

3469:
    if equals(integer(value 0), byte 1):
        ('PORTRAIT', ('integer', [('value', 1)]))

    else:
        ('INVENTORY', ('integer', [('value', 1)]))

    endif

    print("Npc #1.\n*")
    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), word 189):
        jump 3469

    endif

    jump 3229

3524:
    print("Object type? ")
    ('INPUT', 0)

    if equals(integer(value 0), byte 0):
        jump 3229

    endif

    print("\nPeople that have those:\n")
    integer(value 1) = byte 1

3585:
    if hasObject(integer(value 1), integer(value 0), byte 0):
        print("#1 ")

    endif

    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), word 189):
        jump 3585

    endif

    print("\n\n")
    jump 3524

3629:
    print("Npc number? ")
    ('INPUT', 1)

    if equals(integer(value 1), byte 0):
        jump 3229

    endif

    print("Worktype? ")
    ('INPUT', 2)
    ('WORKTYPE', ('integer', [('value', 1)]), ('integer', [('value', 2)]))
    print("'Tis done!\n")
    jump 3629

3693:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

3707:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 1)]))
    print("#2. $Y\n")
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 24)):
        jump 3707

    endif

    print("Edit whom? ")
    ('INPUTNUM', 0)

    if equals(integer(value 0), byte 0):
        jump 2734

    endif

    integer(value 0) = minus(integer(value 0), byte 1)

    if greater(integer(value 0), integer(value 24)):
        jump 2734

    endif

    integer(value 0) = character(integer(value 0), byte 1)
    ('SETNAME', ('integer', [('value', 0)]))

3818:
    print("$Y\n")
    integer(value 1) = strength(integer(value 0), byte 0)
    print("1. Str = #1\n")
    integer(value 1) = intelligence(integer(value 0), byte 0)
    print("2. Int = #1\n")
    integer(value 1) = dexterity(integer(value 0), byte 0)
    print("3. Dex = #1\n")
    integer(value 1) = level(integer(value 0), byte 0)
    print("4. Lvl = #1\n")
    integer(value 1) = experience(integer(value 0), byte 0)
    print("5. Exp = #1\n6. Heal up\n7. Get a horse!\n")
    ('INPUTNUM', 1)

    if equals(integer(value 1), byte 1):
        jump 4057

    endif

    if equals(integer(value 1), byte 2):
        jump 4057

    endif

    if equals(integer(value 1), byte 3):
        jump 4057

    endif

    if equals(integer(value 1), byte 4):
        jump 4057

    endif

    if equals(integer(value 1), byte 5):
        jump 4057

    endif

    if equals(integer(value 1), byte 6):
        jump 4170

    endif

    if equals(integer(value 1), byte 7):
        jump 4212

    endif

    jump 2734

4057:
    print("\nAdd how much? ")
    ('INPUT', 2)

    if equals(integer(value 1), byte 1):
        integer(value 3) = strength(integer(value 0), integer(value 2))

    endif

    if equals(integer(value 1), byte 2):
        integer(value 3) = intelligence(integer(value 0), integer(value 2))

    endif

    if equals(integer(value 1), byte 3):
        integer(value 3) = dexterity(integer(value 0), integer(value 2))

    endif

    if equals(integer(value 1), byte 4):
        integer(value 3) = level(integer(value 0), integer(value 2))

    endif

    if equals(integer(value 1), byte 5):
        integer(value 3) = experience(integer(value 0), integer(value 2))

    endif

    jump 3818

4170:
    if isWounded(integer(value 0)):
        ('HEAL', ('integer', [('value', 0)]))
        print(" Healed! ")

    endif

    if isPoisoned(integer(value 0)):
        ('CURE', ('integer', [('value', 0)]))
        print(" Cured! ")

    endif

    jump 3818

4212:
    if equals(hasHorse(integer(value 0)), byte 0):
        ('HORSE', ('integer', [('value', 0)]))
        print(" Horsed! ")

    endif

    jump 3818

4239:
    integer(value 0) = integer(value 26)
    print("Quest flag = #0\nKarma = #9\n\n1. Set Quest Flag\n2. Add Karma\n3. Subtract")
    print(" Karma\n")
    ('INPUTNUM', 0)
    print("\n")

    if equals(integer(value 0), byte 1):
        jump 4371

    endif

    if equals(integer(value 0), byte 2):
        jump 4400

    endif

    if equals(integer(value 0), byte 3):
        jump 4433

    endif

    jump 2734

4371:
    print("Set to what? ")
    ('INPUTNUM', 0)
    integer(value 26) = integer(value 0)
    print("\n")
    jump 4239

4400:
    print("How much? ")
    ('INPUT', 0)
    ('ADD_KARMA', ('integer', [('value', 0)]))
    integer(value 9) = plus(integer(value 9), integer(value 0))
    print("\n")
    jump 4239

4433:
    print("How much? ")
    ('INPUT', 0)
    ('SUB_KARMA', ('integer', [('value', 0)]))
    integer(value 9) = minus(integer(value 9), integer(value 0))
    print("\n")
    jump 4239

4466:
    integer(value 6) = byte 1
    integer(value 7) = byte 0

4480:
    if greater(integer(value 6), integer(value 23)):
        jump 4618

    endif

    integer(value 5) = objectsCount(character(integer(value 6), byte 0), byte 88)

    if equals(integer(value 5), byte 0):
        jump 4603

    endif

    if equals(canCarry(byte 1), byte 0):
        jump 4720

    endif

    if greater(integer(value 5), canCarry(byte 1)):
        integer(value 5) = canCarry(byte 1)

    endif

    ('DELETE', ('character', [('integer', [('value', 6)]), ('byte', 0)]), ('byte', 88), ('byte', 0), ('integer', [('value', 5)]))
    ('NEW', ('byte', 1), ('byte', 88), ('byte', 0), ('integer', [('value', 5)]))
    integer(value 7) = plus(integer(value 7), integer(value 5))

    if equals(canCarry(byte 1), byte 0):
        jump 4480

    endif

4603:
    integer(value 6) = plus(integer(value 6), byte 1)
    jump 4480

4618:
    if integer(value 7):
        print("Iolo gathers up everyone's gold and hands it to you.")

    else:
        print("\"None of us are carrying any gold, $G.\"")

    endif

    jump 125

4720:
    if integer(value 7):
        print("Iolo collects some gold together and hands it to you.\n*\n\"Here, this is")
        print(" all you can carry right now.\"")

    else:
        print("\"You're carrying enough already, I think.\"")

    endif

    jump 125

4873:
    integer(value 6) = byte 0
    integer(value 7) = byte 0

4887:
    if greater(integer(value 6), integer(value 23)):
        jump 4967

    endif

    integer(value 5) = objectsCount(character(integer(value 6), byte 0), byte 88)

    if equals(integer(value 5), byte 0):
        jump 4952

    endif

    ('DELETE', ('character', [('integer', [('value', 6)]), ('byte', 0)]), ('byte', 88), ('byte', 0), ('integer', [('value', 5)]))
    integer(value 7) = plus(integer(value 7), integer(value 5))

4952:
    integer(value 6) = plus(integer(value 6), byte 1)
    jump 4887

4967:
    if equals(integer(value 7), byte 0):
        print("\"But we have no gold, $G!\"")
        jump 125

    endif

    if lessOrEquals(integer(value 7), integer(value 23)):
        print("\"We don't have enough gold to bother with, $G.\"")
        jump 125

    endif

    integer(value 6) = byte 0
    integer(value 8) = divide(integer(value 7), plus(integer(value 23), byte 1))

5086:
    if greater(integer(value 6), integer(value 23)):
        jump 5199

    endif

    integer(value 5) = integer(value 8)
    integer(value 9) = character(integer(value 6), byte 0)

    if greater(integer(value 5), canCarry(integer(value 9))):
        integer(value 5) = canCarry(integer(value 9))

    endif

    if greater(integer(value 5), integer(value 7)):
        integer(value 5) = integer(value 7)

    endif

    if equals(integer(value 5), byte 0):
        jump 5184

    endif

    ('NEW', ('integer', [('value', 9)]), ('byte', 88), ('byte', 0), ('integer', [('value', 5)]))
    integer(value 7) = minus(integer(value 7), integer(value 5))

5184:
    integer(value 6) = plus(integer(value 6), byte 1)
    jump 5086

5199:
    if equals(integer(value 7), byte 0):
        print("Iolo gathers everyone's gold together and divides it evenly.")
        jump 125

    endif

    integer(value 6) = byte 0

5279:
    if greater(integer(value 6), integer(value 23)):
        jump 5389

    endif

    integer(value 9) = character(integer(value 6), byte 0)
    integer(value 5) = canCarry(integer(value 9))

    if greater(integer(value 5), integer(value 7)):
        integer(value 5) = integer(value 7)

    endif

    if equals(integer(value 5), byte 0):
        jump 5374

    endif

    ('NEW', ('integer', [('value', 9)]), ('byte', 88), ('byte', 0), ('integer', [('value', 5)]))
    integer(value 7) = minus(integer(value 7), integer(value 5))

    if equals(integer(value 7), byte 0):
        jump 5389

    endif

5374:
    integer(value 6) = plus(integer(value 6), byte 1)
    jump 5279

5389:
    print("Iolo splits up the gold between everyone who has room to carry any.")
    jump 125

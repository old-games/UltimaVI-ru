source('CONVERSE.A')
index(4)

id(4)
name('Iolo')

description:
    print('your old friend Iolo.\n*')

interaction:
    setBit(byte 235, value 0)
    print('"Well, $P, do you need @help with something? Or maybe you\'ve got time ')
    print('for a @story, eh?"\n')

    ask()
    integer(value 3) = byte 0

label_134:
    case 'name':
        print('"Iolo\'s the only name I remember having." (He pronounces his name \'Yo-')
        print('low.\')')
        jump label_125

    case 'help':
        print('"If you want me to @gather all our gold together so you can carry it, ')
        print('just say so."\n*\n"Or I could @split it up evenly, if you prefer."')
        jump label_125

    case 'gath':
    case 'pool':
        jump label_4466

    case 'shar':
    case 'spli':
        jump label_4873

    case 'clue':
    case 'home':
    case 'hut':
    case 'smit':
        print('"My hut is in the Deep Forest, south of Yew."\n*\n"My horse Smith lives ')
        print('there."')
        jump label_125

    case 'job':
        print('"I\'ve been a crossbow maker for so long, I\'ve gotten weary of it."\n\n')
        print('*"Hopefully, now that my @apprentice has taken over the shop, I\'ll be ')
        print('able to spend more time as a @bard."')
        jump label_125

    case 'appr':
    case 'cros':
    case 'shop':
        print('"My shop still sells the finest crossbows in the land."\n*\n"I\'ve done a')
        print(' lot over the years to refine the design, and I trained my apprentice ')
        print('well."\n*\n"I\'m sure she\'ll carry on the tradition in fine fashion."')
        jump label_125

    case 'bard':
        print('"Yes, it\'s always been a hobby of mine."\n*\n"Have you heard the piece ')
        print('\'Stones\' that I composed some years ago?" ')
        jump label_2623

    case 'gwen':
    case 'wife':
        print('"She\'s had more time to develop her musical talents than I all these ')
        print('years."\n*\n"But after this @quest I hope to join her in @Minoc and ')
        print('enter the artisan\'s @guild."')
        jump label_125

    case 'ques':
        print('"There always seems to be a quest when you come to visit us, doesn\'t ')
        print('there?"\n*\n"Some time you should just drop by for @tea."')
        jump label_125

    case 'tea':
        print('"All right, make it Frasier\'s @Folly, then."')
        jump label_125

    case 'foll':
    case 'fras':
        print('"A drink worthy enough to greet an old friend."')
        jump label_125

    case 'mino':
        print('"Not as big as @Britain, but it\'s a peaceful town."')
        jump label_125

    case 'arti':
    case 'guil':
    case 'musi':
        print('"Though there is still need for the instruments of war, as I grow in ')
        print('years I would now take up those of peace."')
        jump label_125

    case 'brit':
        print('"You know. Where Mr. @Nose hangs out."')
        jump label_125

    case 'mr':
    case 'nibs':
    case 'nose':
        print('"Remember, he doesn\'t like people to call him that..."')
        jump label_125

    case 'join':
        print('"I\'ve been with you since we saved you from those @gargoyles, haven\'t ')
        print('I?"')
        jump label_125

    case 'garg':
        print('"They\'re pretty ugly looking, if you ask me..."')
        jump label_125

    case 'leav':
        print('"His nibs, the king, told me I should stay with you constantly."\n*\n')
        print('"I\'ll make an exception when you have to relieve yourself, of course."')
        jump label_125

    case 'stor':
        print('"My favorite one is about the time I had to wake Dupre up for a ')
        print('tournament...')

        if partyHas(byte 2):
            print('"\n')
            wait()

            portrait(byte 2)
            print('\nDupre cuts in.\n"Iolo! You promised NEVER to tell anyone about that!"\n')
            wait()

            portrait(byte 4)
            print('\n"Yes, you\'re right. I\'m sorry." He whispers to you, "Ask me later ')
            print('when he\'s not around..."')

        else:
            print('"\n')
            wait()

            print('\n"But maybe I shouldn\'t tell you about that. After all, I did ')
            print('promise..."')
        fi

        jump label_125

    case 'bye':
        print('"I\'ve still got to tell you that story about Dupre sometime..."\n')
        bye()

    case 'spam':
        print('"Ask Shamino about that."')
        integer(value 3) = plus(integer(value 3), byte 1)

        ask()
        jump label_134

    case 'humbug':
        if equals(integer(value 3), byte 3):
            integer(value 9) = integer(value 20)
            jump label_2734
        fi

        print('"Ask Shamino about that."')
        jump label_125

    case '*':
        print('"Ask Shamino about that."')
    esac

    jump label_125

label_2623:
    choice('yn')

    case 'n':
        print('"Oh, you should get my wife @Gwenno to teach it to you some time."')
        jump label_125
    esac

    print('\n"It\'s one of my favorites."')
    jump label_125

label_2734:
    print('Secret Cheaters Menu!\n1. Get items\n2. Set flags\n3. View npcs\n4. Edit ')
    print('party\n5. Edit player\n')
    inputNumber(integer(value 0))
    print('\n')

    if equals(integer(value 0), byte 1):
        jump label_2911
    fi

    if equals(integer(value 0), byte 2):
        jump label_3063
    fi

    if equals(integer(value 0), byte 3):
        jump label_3229
    fi

    if equals(integer(value 0), byte 4):
        jump label_3693
    fi

    if equals(integer(value 0), byte 5):
        jump label_4239
    fi

    print('Have a nice day!\n')
    bye()

label_2911:
    print('Object number?\n')
    input(integer(value 0))
    print('Quality? ')
    input(integer(value 1))
    print('Quantity? ')
    input(integer(value 2))

    if equals(integer(value 2), byte 0):
        integer(value 2) = byte 1
    fi

    if less(canCarry(byte 1), weight(integer(value 0), integer(value 2))):
        print('"That\'s too heavy for you... But I\'ll let you have it anyway!"\n*')
    fi

    create(byte 1, integer(value 0), integer(value 1), integer(value 2))
    jump label_2734

label_3063:
    print('\nNpc number? ')
    input(integer(value 0))

    if equals(integer(value 0), byte 0):
        jump label_2734
    fi

label_3092:
    print('\n\nM H 2 3 4 5 6 7\n')
    integer(value 1) = byte 0

label_3117:
    integer(value 2) = hasBit(integer(value 0), integer(value 1))
    print('#2 ')
    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), byte 8):
        jump label_3117
    fi

    print('\n\n0-7 to toggle, 8 or 9 exits: ')
    inputNumber(integer(value 3))

    if greater(integer(value 3), byte 7):
        print('\n')
        jump label_3063
    fi

    if hasBit(integer(value 0), integer(value 3)):
        clearBit(integer(value 0), integer(value 3))

    else:
        setBit(integer(value 0), integer(value 3))
    fi

    jump label_3092

label_3229:
    print('1. Portraits\n2. Inventories\n3. Item search\n4. Set worktype\n')
    inputNumber(integer(value 0))
    print('\n')

    if equals(integer(value 0), byte 1):
        jump label_3349
    fi

    if equals(integer(value 0), byte 2):
        jump label_3349
    fi

    if equals(integer(value 0), byte 3):
        jump label_3524
    fi

    if equals(integer(value 0), byte 4):
        jump label_3629
    fi

    jump label_2734

label_3349:
    print('1. Individuals\n2. View all\n')
    inputNumber(integer(value 1))
    print('\n')

    if equals(integer(value 1), byte 1):
        jump label_3411
    fi

    if equals(integer(value 1), byte 2):
        jump label_3462
    fi

    jump label_3229

label_3411:
    print('Npc number? ')
    input(integer(value 1))
    print('\n')

    if equals(integer(value 1), byte 0):
        jump label_3229
    fi

    if equals(integer(value 0), byte 1):
        portrait(integer(value 1))

    else:
        inventory(integer(value 1))
    fi

    jump label_3411

label_3462:
    integer(value 1) = byte 1

label_3469:
    if equals(integer(value 0), byte 1):
        portrait(integer(value 1))

    else:
        inventory(integer(value 1))
    fi

    print('Npc #1.\n*')
    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), word 189):
        jump label_3469
    fi

    jump label_3229

label_3524:
    print('Object type? ')
    input(integer(value 0))

    if equals(integer(value 0), byte 0):
        jump label_3229
    fi

    print('\nPeople that have those:\n')
    integer(value 1) = byte 1

label_3585:
    if hasObject(integer(value 1), integer(value 0), byte 0):
        print('#1 ')
    fi

    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), word 189):
        jump label_3585
    fi

    print('\n\n')
    jump label_3524

label_3629:
    print('Npc number? ')
    input(integer(value 1))

    if equals(integer(value 1), byte 0):
        jump label_3229
    fi

    print('Worktype? ')
    input(integer(value 2))
    do(integer(value 1), integer(value 2))
    print('\'Tis done!\n')
    jump label_3629

label_3693:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_3707:
    look(character(integer(value 0), byte 1))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 24)):
        jump label_3707
    fi

    print('Edit whom? ')
    inputNumber(integer(value 0))

    if equals(integer(value 0), byte 0):
        jump label_2734
    fi

    integer(value 0) = minus(integer(value 0), byte 1)

    if greater(integer(value 0), integer(value 24)):
        jump label_2734
    fi

    integer(value 0) = character(integer(value 0), byte 1)
    look(integer(value 0))

label_3818:
    print('$Y\n')
    integer(value 1) = strength(integer(value 0), byte 0)
    print('1. Str = #1\n')
    integer(value 1) = intelligence(integer(value 0), byte 0)
    print('2. Int = #1\n')
    integer(value 1) = dexterity(integer(value 0), byte 0)
    print('3. Dex = #1\n')
    integer(value 1) = level(integer(value 0), byte 0)
    print('4. Lvl = #1\n')
    integer(value 1) = experience(integer(value 0), byte 0)
    print('5. Exp = #1\n6. Heal up\n7. Get a horse!\n')
    inputNumber(integer(value 1))

    if equals(integer(value 1), byte 1):
        jump label_4057
    fi

    if equals(integer(value 1), byte 2):
        jump label_4057
    fi

    if equals(integer(value 1), byte 3):
        jump label_4057
    fi

    if equals(integer(value 1), byte 4):
        jump label_4057
    fi

    if equals(integer(value 1), byte 5):
        jump label_4057
    fi

    if equals(integer(value 1), byte 6):
        jump label_4170
    fi

    if equals(integer(value 1), byte 7):
        jump label_4212
    fi

    jump label_2734

label_4057:
    print('\nAdd how much? ')
    input(integer(value 2))

    if equals(integer(value 1), byte 1):
        integer(value 3) = strength(integer(value 0), integer(value 2))
    fi

    if equals(integer(value 1), byte 2):
        integer(value 3) = intelligence(integer(value 0), integer(value 2))
    fi

    if equals(integer(value 1), byte 3):
        integer(value 3) = dexterity(integer(value 0), integer(value 2))
    fi

    if equals(integer(value 1), byte 4):
        integer(value 3) = level(integer(value 0), integer(value 2))
    fi

    if equals(integer(value 1), byte 5):
        integer(value 3) = experience(integer(value 0), integer(value 2))
    fi

    jump label_3818

label_4170:
    if isWounded(integer(value 0)):
        heal(integer(value 0))
        print(' Healed! ')
    fi

    if isPoisoned(integer(value 0)):
        cure(integer(value 0))
        print(' Cured! ')
    fi

    jump label_3818

label_4212:
    if equals(hasHorse(integer(value 0)), byte 0):
        horse(integer(value 0))
        print(' Horsed! ')
    fi

    jump label_3818

label_4239:
    integer(value 0) = integer(value 26)
    print('Quest flag = #0\nKarma = #9\n\n1. Set Quest Flag\n2. Add Karma\n3. Subtract')
    print(' Karma\n')
    inputNumber(integer(value 0))
    print('\n')

    if equals(integer(value 0), byte 1):
        jump label_4371
    fi

    if equals(integer(value 0), byte 2):
        jump label_4400
    fi

    if equals(integer(value 0), byte 3):
        jump label_4433
    fi

    jump label_2734

label_4371:
    print('Set to what? ')
    inputNumber(integer(value 0))
    integer(value 26) = integer(value 0)
    print('\n')
    jump label_4239

label_4400:
    print('How much? ')
    input(integer(value 0))
    increaseKarma(integer(value 0))
    integer(value 9) = plus(integer(value 9), integer(value 0))
    print('\n')
    jump label_4239

label_4433:
    print('How much? ')
    input(integer(value 0))
    decreaseKarma(integer(value 0))
    integer(value 9) = minus(integer(value 9), integer(value 0))
    print('\n')
    jump label_4239

label_4466:
    integer(value 6) = byte 1
    integer(value 7) = byte 0

label_4480:
    if greater(integer(value 6), integer(value 23)):
        jump label_4618
    fi

    integer(value 5) = objectsCount(character(integer(value 6), byte 0), byte 88)

    if equals(integer(value 5), byte 0):
        jump label_4603
    fi

    if equals(canCarry(byte 1), byte 0):
        jump label_4720
    fi

    if greater(integer(value 5), canCarry(byte 1)):
        integer(value 5) = canCarry(byte 1)
    fi

    destroy(character(integer(value 6), byte 0), byte 88, byte 0, integer(value 5))
    create(byte 1, byte 88, byte 0, integer(value 5))
    integer(value 7) = plus(integer(value 7), integer(value 5))

    if equals(canCarry(byte 1), byte 0):
        jump label_4480
    fi

label_4603:
    integer(value 6) = plus(integer(value 6), byte 1)
    jump label_4480

label_4618:
    if integer(value 7):
        print('Iolo gathers up everyone\'s gold and hands it to you.')

    else:
        print('"None of us are carrying any gold, $G."')
    fi

    jump label_125

label_4720:
    if integer(value 7):
        print('Iolo collects some gold together and hands it to you.\n*\n"Here, this is')
        print(' all you can carry right now."')

    else:
        print('"You\'re carrying enough already, I think."')
    fi

    jump label_125

label_4873:
    integer(value 6) = byte 0
    integer(value 7) = byte 0

label_4887:
    if greater(integer(value 6), integer(value 23)):
        jump label_4967
    fi

    integer(value 5) = objectsCount(character(integer(value 6), byte 0), byte 88)

    if equals(integer(value 5), byte 0):
        jump label_4952
    fi

    destroy(character(integer(value 6), byte 0), byte 88, byte 0, integer(value 5))
    integer(value 7) = plus(integer(value 7), integer(value 5))

label_4952:
    integer(value 6) = plus(integer(value 6), byte 1)
    jump label_4887

label_4967:
    if equals(integer(value 7), byte 0):
        print('"But we have no gold, $G!"')
        jump label_125
    fi

    if lessOrEquals(integer(value 7), integer(value 23)):
        print('"We don\'t have enough gold to bother with, $G."')
        jump label_125
    fi

    integer(value 6) = byte 0
    integer(value 8) = divide(integer(value 7), plus(integer(value 23), byte 1))

label_5086:
    if greater(integer(value 6), integer(value 23)):
        jump label_5199
    fi

    integer(value 5) = integer(value 8)
    integer(value 9) = character(integer(value 6), byte 0)

    if greater(integer(value 5), canCarry(integer(value 9))):
        integer(value 5) = canCarry(integer(value 9))
    fi

    if greater(integer(value 5), integer(value 7)):
        integer(value 5) = integer(value 7)
    fi

    if equals(integer(value 5), byte 0):
        jump label_5184
    fi

    create(integer(value 9), byte 88, byte 0, integer(value 5))
    integer(value 7) = minus(integer(value 7), integer(value 5))

label_5184:
    integer(value 6) = plus(integer(value 6), byte 1)
    jump label_5086

label_5199:
    if equals(integer(value 7), byte 0):
        print('Iolo gathers everyone\'s gold together and divides it evenly.')
        jump label_125
    fi

    integer(value 6) = byte 0

label_5279:
    if greater(integer(value 6), integer(value 23)):
        jump label_5389
    fi

    integer(value 9) = character(integer(value 6), byte 0)
    integer(value 5) = canCarry(integer(value 9))

    if greater(integer(value 5), integer(value 7)):
        integer(value 5) = integer(value 7)
    fi

    if equals(integer(value 5), byte 0):
        jump label_5374
    fi

    create(integer(value 9), byte 88, byte 0, integer(value 5))
    integer(value 7) = minus(integer(value 7), integer(value 5))

    if equals(integer(value 7), byte 0):
        jump label_5389
    fi

label_5374:
    integer(value 6) = plus(integer(value 6), byte 1)
    jump label_5279

label_5389:
    print('Iolo splits up the gold between everyone who has room to carry any.')
    jump label_125

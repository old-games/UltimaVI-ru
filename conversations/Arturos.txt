source("CONVERSE.B")
index(39)

id(138)
name("Arturos")

description:
    print("a colorfully clad, bemused looking gypsy.")
    wait()

    print("\n")

interaction:
    print("\"Hey, paisan! If you were looking to geta your @fortune told, you came")
    print(" to the right place.\"")
    ('CLEARF', ('byte', 235), ('byte', 7))

152:
    print("\n")

    ask()

    // Wrong flow!
    case "name":
        print("\"I'ma called Arturos. That meansa either 'foolish monkey' or 'he who ")
        print("sells cheese', depending on howa you @translate it.\"")
        ('SETF', ('byte', 235), ('value', 0))
        jump 152

    case "chee":
    case "fool":
    case "monk":
    case "tran":
        print("\"Yeah, go figure, huh?\"")
        jump 152

    case "map":
        if equals(hasObject(byte 235, word 402, byte 0), byte 0):
            print("\"Yeah, I used to have a map like that. Can't remember what I did with ")
            print("it, though...\"")
            jump 152

        endif

        print("\"Map. Hmm, map... Oh yeah, thata old thing. Sure, I got that, but ")
        print("she'sa not very interesting.\"")
        jump 3958

    case "job":
        print("\"Ima the king of all the gypsies.\"\n*\n\"Of course, thatsa what you call ")
        print("more of an 'honorary' @title, so I tell @fortunes on the side.\"")
        jump 152

    case "artu":
    case "gyps":
    case "hono":
    case "king":
    case "titl":
        print("\"You cana just call me '@Uncle @Arthur' if you like.\"")
        jump 152

    case "zolt":
        print("\"He's a whadda you call, an impostor. You shouldn'ta listen to him.\"")
        jump 152

    case "card":
    case "fort":
    case "tell":
        jump 1402

    case "arth":
    case "uncl":
        print("\"That'sa nice and friendly. I like you too.\" He comes over and gives ")
        print("you a big hug.")

        if less(objectsCount(byte 1, byte 88), byte 75):
            jump 152

        endif

        ('DELETE', ('byte', 1), ('byte', 88), ('byte', 0), ('byte', 75))
        ('NEW', ('byte', 235), ('byte', 88), ('byte', 0), ('byte', 75))
        ('SETF', ('byte', 235), ('byte', 7))
        jump 152

    case "bye":
        print("\"Hey, you come again soon, okay?\"")

        if and(hasBit(byte 235, byte 7), partyHas(byte 3)):
            wait()

            ('PORTRAIT', ('byte', 3))
            print("\n\nShamino whispers to you, \"Best check your coinpouch. I think I saw ")
            print("something when that gypsy hugged you.\"")

        endif

        print("\n")
        bye()

    case "silv":
    case "tabl":
        print("\"The silver tablet? I don't know anything about that.\"")
        wait()

        print("\n\n\"But hey, maybe there's something in the @cards about it, ah?\"")
        ('SETF', ('byte', 235), ('byte', 6))
        jump 152

    case "*":
        print("\"Can'ta you think of something more interesting to talk about?\"")

    esac

    jump 152

1402:
    print("\"I gota this fine set of fortune telling cards. These werea hand ")
    print("painted by Musgrave himself.\"")
    wait()

    print("\n\n\"For justa two gold, ")

    if hasBit(byte 235, byte 6):
        print("maybe I can help you finda this silver tablet.\"")
        wait()

        print("\n\n\"And I'll tell you the rest of your future as well. What a bargain! ")
        print("Whadda you say?\" ")

    else:
        print("I'll tella you your future. Whadda you say?\" ")

    endif

    askc("yn")

    // Wrong flow!
    case "n":
        print("\"Ok, have it your way.\"")
        wait()

        print("\n\n\"But ifa some maniac with an axe catches you in a dark alley ")
        print("somewhere, don'ta blame me for not warning you.\"")
        jump 152

    case "y":
        if less(objectsCount(byte 1, byte 88), byte 2):
            print("\"Come back whena you have the money.\"")
            jump 152

        endif

        ('DELETE', ('byte', 1), ('byte', 88), ('byte', 0), ('byte', 2))
        ('NEW', ('byte', 235), ('byte', 88), ('byte', 0), ('byte', 2))
        print("He takes out a deck of cards, shuffles it, and has you pick one.")

    esac

    wait()

    print("\n\"Okay, thisa card, she'sa the Tower. That means you'rea going to go ")
    print("into a real big building soon, like maybe a castle.\"")
    wait()

    print("\n\n\"Pretty good, huh? Maybe you want a better card, though. Do you want")
    print(" to pick again?\" ")

    askc("yn")

    // Wrong flow!
    case "n":
        print("\"Okay.\"")
        jump 152

    case "y":
        integer(value 0) = byte 1

    esac

    print("You pick another card. \"This here isa the Wheel of Fortune.\"")
    wait()

    print("\n\n\"Wheels, they go 'round and 'round, so that means you'rea gonna have")
    print(" some good luck, and some bad luck.\"")
    wait()

    print("\n\n\"That doesn't tell you so much. Try for another card?\" ")

    askc("yn")

    // Wrong flow!
    case "n":
        jump 3560

    case "y":
        integer(value 0) = byte 2

    esac

    print("\"Oh, hey, you picked the Lovers this time. I thinka maybe you should ")
    print("go talk to ")

    if integer(value 16):
        print("Andreas")

    else:
        print("Wanda")

    endif

    print(", you know what I mean?\"")
    wait()

    print("\n\n\"That'sa pretty good card. How about another one?\" ")

    askc("yn")

    // Wrong flow!
    case "n":
        jump 3560

    case "y":
        integer(value 0) = byte 5

    esac

    print("\"This here's Temperance. Thata means that you shouldn't lose your ")
    print("temper.\"\n*\n\"I cana find you a better card than that, here, wait a ")
    print("minute.\"")
    wait()

    print("\n\nHe picks out a card. \"This is Justice, that'sa one of what they call")
    print(" the 'court cards.' Let me try again.\" He picks another.")
    wait()

    print("\n\n\"Okay, this isa better. This is the Hierophant. That'sa like an ")
    print("elephant, but taller and without the trunk.\"")
    wait()

    print("\n\n\"That means you'rea gonna see one of them someday. Pretty ")
    print("interesting, huh? Another card?\" ")

    askc("yn")

    // Wrong flow!
    case "n":
        jump 3560

    esac

    integer(value 0) = byte 6
    print("\n\"Uh-oh, you justa drew the Death card. That means eithera you're ")
    print("going to kill somebody soon, ora somebody's gonna kill you.\"")
    wait()

    print("\"I can never geta that part straight. One more card?\" ")

    askc("yn")

    // Wrong flow!
    case "n":
        jump 3560

    esac

    integer(value 0) = byte 7
    print("\n\"Allaright, now we're talking. You pickeda the Crow card. That'sa ")
    print("telling you adventuring isa for the birds.\"")
    wait()

    print("\n\n\"You should open a little shop somewhere and settle down, you know?\"")
    wait()

    print("\n")

3560:
    integer(value 1) = multiply(integer(value 0), byte 5)

    if hasBit(byte 235, byte 6):
        print("\n\"The cards didn't say nothin' about the silver tablet. Guess that ")
        print("means you're not gonna find it.\"")
        wait()

        print("\n\n\"That's life, you know?\"")
        ('CLEARF', ('byte', 235), ('byte', 6))
        wait()

        print("\n")

    endif

    print("\n\"Okay, that'sa #0 extra cards at 5 gold apiece. That makes #1 total.\"")
    wait()

    print("\n\n")

    if less(objectsCount(byte 1, byte 88), integer(value 1)):
        print("\"Since you don'ta have that much, I'll just settle for what you've ")
        print("got.\"")
        wait()

        print("\n\n")
        integer(value 1) = objectsCount(byte 1, byte 88)

    endif

    ('DELETE', ('byte', 1), ('byte', 88), ('byte', 0), ('integer', [('value', 1)]))
    ('NEW', ('byte', 235), ('byte', 88), ('byte', 0), ('integer', [('value', 1)]))
    print("\"It was a pleasure doinga business with you.\"")
    jump 152

3958:
    wait()

    print("\n\n\"Say--do you want to buy it?\" ")

    askc("yn")

    // Wrong flow!
    case "n":
        print("\"Nah, I didn't think so. What for would anybody want to buy it, ah?\"")
        jump 152

    case "y":
        print("\"Oh! Well, sure you do, she's a very important map!\"")

        if integer(value 23):
            wait()

            print("\n\nHe leads you away from the rest of the group. \"Don't want no spyin' ")
            print("ears, ah?\"")

        endif

    esac

    wait()

    print("\n\n\"Yeah, this map, she'sa leading to the treasure of - oh, who was it,")
    print(" Yellowbeard or somebody.\"")
    wait()

    print("\n\n\"Well, I forget, but the point is it leads to a big, huge treasure!\"")
    wait()

    print("\n\n\"So if you want this map you're agonna have to pay - 100 gold! ")
    print("Okay?\" ")
    integer(value 0) = byte 100

4460:
    askc("yn")

    // Wrong flow!
    case "n":
        if equals(integer(value 0), byte 50):
            print("\"Thank you! You have asaved me from amaking a big mistake!\"")
            wait()

            print("\n\n\"You're right, I better hold on to this valuable map myself. No way ")
            print("is it worth less than 100 gold.\"")
            jump 152

        endif

        if equals(integer(value 0), byte 75):
            print("\"What, are you nuts? But okay, how'sabout just 50 gold?\" ")
            integer(value 0) = byte 50
            jump 4460

        endif

        print("\"Well, I hate to see anybody pass up good fortune, so I tell you what ")
        print("I do.\"")
        wait()

        print("\n\n\"I sell you this map, this key to infinite wealth, for just 75 gold.")
        print(" Okay?\" ")
        integer(value 0) = byte 75
        jump 4460

    case "y":
        if less(objectsCount(byte 1, byte 88), integer(value 0)):
            print("\"Hey, what are you, a deadbeat? Come back when you can afford the ")
            print("map!\"")
            jump 152

        endif

        ('DELETE', ('byte', 1), ('byte', 88), ('byte', 0), ('integer', [('value', 0)]))

        if less(canCarry(byte 1), weight(word 402, byte 1)):
            print("\"Yeah, well, you've got a lot to carry right now.\"")
            wait()

            print("\n\n\"I do you a favor and just hold on to the map for you until you got ")
            print("room for it.\"")
            wait()

            print("\n\n\"I do you another favor and hold on to the money, too.\"")
            jump 152

        endif

        print("\"Okay, here's the map, and may fortune bring you lotsa gold!\"")
        ('GIVE', ('word', 402), ('byte', 0), ('byte', 235), ('byte', 1))
        jump 152

        // Unreachable code!

    esac

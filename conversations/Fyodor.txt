source('CONVERSE.A')
index(20)

id(20)
name('Fyodor')

f3()

description:
    print('a man in a multicolored jacket. His fingers are long and graceful.')
    wait()

    print('\n')

interaction:
    if hasBit(byte 235, value 0):
        print('"Hello again, $G."')

    else:
        print('"Good $T, $G."')
    fi

    integer(value 5) = byte 0
    wait()

    print('\n\n"What can I do for you?"\n')

    ask()

    case 'name':
        print('"My name is Fyodor. What is thy name?"\n')

        ask()
        print('\n"Pleased to meet thee, `$Z."')
        ('SETF', ('byte', 235), ('value', 0))
        jump label_153

    case 'job':
        print('"I make cloth upon my @loom. Perhaps you\'d like to @buy some."')
        jump label_153

    case 'buy':
        if equals(integer(value 32), byte 146):
            jump label_1598

        else:
            print('"I fear I have none with me, $G."')
            wait()

            print('\n\n"Come back when I\'m at my loom; I\'ll help thee then."')
            jump label_153
        fi

    case 'sell':
        if equals(integer(value 32), byte 146):
            jump label_2197

        else:
            print('"But I don\'t need wool here, $G!"')
            wait()

            print('\n\n"Come back when I\'m at my loom; I\'ll deal with thee then."')
            jump label_153
        fi

    case 'clot':
    case 'loom':
        if equals(integer(value 32), byte 146):
            print('"I push the pedals with my feet--like this."')
            wait()

            print('\n\n"Then I pull these levers."')
            wait()

            print('\n\n"The pattern depends on which combinations of levers and pedals I ')
            print('move."')
            wait()

            print('\n\n"My father\'s loom was not so complicated as mine. This design came ')
            print('from one of Lord British\'s old @books."')
            jump label_153
        fi

        print('"I work on a large new loom. The plans for it were found in one of ')
        print('Lord British\'s old @books."')
        jump label_153

    case 'book':
    case 'brit':
    case 'lord':
    case 'old':
        print('"Lord British treasures antiques. There is one book for which he hath ')
        print('offered a reward:')
        wait()

        print('\n\n"\'The Wizard of @Oz.\'"')
        jump label_153

    case 'oz':
    case 'wiza':
        print('"By Master L. Frank Baum, I believe."')
        wait()

        print('\n\n"It concerns a girl adventurer, a strange land, and a clever ')
        print('@balloonist."')
        jump label_153

    case 'ball':
        print('"Are they not made of @silk, in the form of a great bag?"')
        jump label_153

    case 'bag':
    case 'silk':
        print('"\'Tis a wondrous strong stuff, silk, and very light."')
        wait()

        print('\n\n"I regret that I am not skillful enough to weave silk."')
        wait()

        print('\n\n"In New Magincia, however, lives the silk-weaver @Charlotte."')
        jump label_153

    case 'char':
        print('"She is the only person I know of who can weave silk."')
        jump label_153

    case 'bye':
        print('"May our paths cross again some day."\n')
        bye()

    case '*':
        print('"That I cannot help thee with."')
        jump label_153
    esac

label_1598:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 0
        jump label_1734
    fi

label_1618:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1632:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1632
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump label_2134
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1618
    fi

label_1734:
    integer(value 3) = character(integer(value 3), byte 0)
    ('SETNAME', ('integer', [('value', 3)]))
    print('"@Cloth or @thread, $Y?"\n')

    ask()

    case 'clot':
        integer(value 0) = byte 0
        jump label_1814

    case 'thre':
        integer(value 0) = byte 1

    case '*':
        jump label_1618
    esac

label_1814:
    integer(value 1) = data(dword 2818, integer(value 0))
    string(value 0) = data(dword 2826, integer(value 0))
    print('"It\'ll cost you #1 gold for the $0. Interested?" ')

    choice('yn')

    case 'y':
        if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(dword 2822, integer(value 0)), byte 1)):
            print('"You look pretty full to me."')
            wait()

            print('\n')
            jump label_128
        fi

        if greaterOrEquals(objectsCount(integer(value 3), byte 88), byte 30):
            ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('data', [('dword', 2818), ('integer', [('value', 0)])]))
            ('NEW', ('integer', [('value', 3)]), ('data', [('dword', 2822), ('integer', [('value', 0)])]), ('byte', 0), ('byte', 1))
            string(value 0) = data(dword 2826, integer(value 0))
            print('"Excellent!" After accepting $Y\'s gold, $N hands over the $0.')
            wait()

            integer(value 5) = byte 1
            print('\n\n')
            jump label_2134

        else:
            print('"You haven\'t the money."')
            wait()

            print('\n')
            jump label_128
        fi

    case 'n':
        jump label_2134
    esac

label_2134:
    if integer(value 5):
        print('"That is fine $0."')
        wait()

        print('\n')
        jump label_128
    fi

    print('"You\'ll find none better."')
    wait()

    print('\n')
    jump label_128

label_2197:
    integer(value 0) = byte 0
    integer(value 2) = byte 0
    integer(value 3) = byte 0

label_2218:
    integer(value 1) = byte 0

label_2225:
    if objectsCount(character(integer(value 0), byte 0), byte 190):
        data(dword 2802, integer(value 2)) = integer(value 0)
        integer(value 2) = plus(integer(value 2), byte 1)
        integer(value 3) = byte 1
        jump label_2294
    fi

    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), byte 7):
        jump label_2225
    fi

label_2294:
    integer(value 0) = plus(integer(value 0), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_2218
    fi

    if equals(integer(value 3), byte 0):
        print('"Sorry, none of you has anything I need."')
        wait()

        print('\n')
        jump label_128
    fi

    if equals(integer(value 2), byte 1):
        integer(value 3) = data(dword 2802, byte 0)
        jump label_2534
    fi

label_2399:
    integer(value 0) = byte 0
    integer(value 1) = byte 1

label_2413:
    ('SETNAME', ('character', [('data', [('dword', 2802), ('integer', [('value', 0)])]), ('byte', 0)]))
    print('#1. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 0), integer(value 2)):
        jump label_2413
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump label_2771
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greaterOrEquals(integer(value 3), integer(value 2)):
        jump label_2399
    fi

    integer(value 3) = data(dword 2802, integer(value 3))

label_2534:
    integer(value 3) = character(integer(value 3), byte 0)
    ('SETNAME', ('integer', [('value', 3)]))
    integer(value 4) = objectsCount(integer(value 3), byte 190)

    if equals(integer(value 4), byte 0):
        jump label_2734
    fi

    print('$N turns to $Y and says "Will you take 8 gold for that wool?" ')

    choice('yn')

    case 'y':
        print('"Done!" He hands $Y 8 gold pieces and takes the wool.')
        ('DELETE', ('integer', [('value', 3)]), ('byte', 190), ('byte', 0), ('byte', 1))
        ('NEW', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('byte', 8))
        wait()

        print('\n')
        jump label_128

    case 'n':
        jump label_2771
    esac

label_2734:
    print('"Sorry, you haven\'t any wool."')
    wait()

    print('\n')
    jump label_128

label_2771:
    print('"Changed your mind, eh?"')
    wait()

    print('\n')
    jump label_128

integers_2802 = [
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
]

integers_2818 = [
    20,
    5,
]

integers_2822 = [
    185,
    225,
]

strings_2826 = [
    'cloth',
    'thread',
]

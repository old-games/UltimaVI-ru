source("CONVERSE.B")
index(53)

id(152)
name("Gherick")

description:
    print("a tall man, covered with scars and drooling uncontrollably.")
    wait()

    f3()

interaction:
    print("\n")
    integer(value 8) = byte 5

    if hasBit(byte 235, value 0):
        print("\"Back again?\"")

    else:
        print("\"What do you want?\"")
        ('SETF', ('byte', 235), ('value', 0))
    fi

126:
    print("\n")

    ask()

    case "buy":
        print("\"I's a great craftsman, I is. Me shop is 'uge!\"")
        wait()

        print("\n\n\"You'll hafta be more specific: @arms or @armor?\"")
        jump 126

    case "arms":
    case "weap":
        integer(value 9) = byte 0
        jump 2495

    case "armo":
        integer(value 9) = integer(value 8)
        jump 2495

    case "sell":
        jump 1513

    case "magi":
    case "orde":
    case "serp":
    case "shie":
        if hasBit(byte 235, byte 2):
            print("\"What, you gone daft?\"")
            wait()

            print("\n\n\"I already made ya one!\"")
            jump 126
        fi

        if equals(hasBit(byte 159, byte 7), byte 0):
            print("\"Go talk ta Koranada about that first.\"")
            wait()

            jump 126
        fi

        jump 972

    case "name":
        print("\"@Gherick.\"")
        jump 126

    case "gher":
        print("\"Are ya learnin' how ta speak or do ya need somethin'?\"")
        jump 126

    case "job":
        print("\"I makes the most @hideous weapons!\"")
        jump 126

    case "hide":
        if greater(integer(value 20), byte 40):
            print("\"You ain't the sort what'd be interested.\"")

        else:
            print("\"I ain't gonna tell you, you'd steal me brilliant ideas!\"")
        fi

        wait()

        print("\n\n\"I got some other stuff you could @buy, though.\"")
        jump 126

    case "aman":
        print("\"She's got the best food in the land. Go see for yerself.\"")
        jump 126

    case "segg":
        print("\"A fine warrior. New to this area.\"")
        jump 126

    case "bye":
        print("\"Shut the door on yer way out,\" he snarls.\n")
        bye()

    case "*":
        if random(byte 0, byte 1):
            print("He doesn't hear you.")

        else:
            print("He hears you but doesn't respond.")
        fi

        jump 126

        // Unreachable code!
    esac

972:
    if notEquals(integer(value 32), byte 144):
        print("\"Come to my shop when I'm open!\"")
        jump 126
    fi

    integer(value 0) = partyHasObject(byte 10, byte 0)
    print("\"Huh? Oh, yeah, da serpent shield.\"")
    wait()

    print("\n\nHe looks around and then at the ceiling.")
    wait()

    print("\n\n\"I needs a snake shield, a chunk o' gold, and a magic gem.\"")
    wait()

    print("\n\n\"Have ya got dese tings?\" ")

    askc("yn")

    case "y":
        if and(and(notEquals(partyHasObject(byte 10, byte 0), word 32769), notEquals(partyHasObject(byte 89, byte 0), word 32769)), notEquals(partyHasObject(byte 77, byte 0), word 32769)):
            ('DELETE', ('integer', [('value', 0)]), ('byte', 10), ('byte', 0), ('byte', 1))
            ('DELETE', ('partyHasObject', [('byte', 89), ('byte', 0)]), ('byte', 89), ('byte', 0), ('byte', 1))
            ('DELETE', ('partyHasObject', [('byte', 77), ('byte', 0)]), ('byte', 77), ('byte', 0), ('byte', 1))
            ('NEW', ('integer', [('value', 0)]), ('byte', 16), ('byte', 0), ('byte', 1))
            print("He holds up a beautiful golden shield that glows softly.")
            wait()

            print("\n\n\"Here ya go. Just as promised.\"")
            ('SETF', ('byte', 235), ('byte', 2))
            wait()

            jump 1481

        else:
            jump 1401
        fi

1401:
        print("\n\n\"You ain't got all that I asked for.\"")
        wait()

        print("\n\n\"Come back when ya do!\"")
        wait()

        jump 1481

    case "n":
        jump 1443

        // Unreachable code!
    esac

1481:
    print("\n\n\"What else can I get ya?\"")
    jump 126

1513:
    if notEquals(integer(value 32), byte 144):
        print("\"Come to my shop when I'm open!\"")
        jump 126
    fi

    integer(value 0) = byte 0
    integer(value 2) = byte 0
    integer(value 3) = byte 0

1579:
    integer(value 1) = byte 0

1586:
    if hasObject(character(integer(value 0), byte 0), data(dword 3185, integer(value 1)), byte 0):
        data(dword 3369, integer(value 2)) = integer(value 0)
        integer(value 2) = plus(integer(value 2), byte 1)
        integer(value 3) = byte 1
        jump 1666
    fi

    integer(value 1) = plus(integer(value 1), byte 1)

    if data(dword 3185, integer(value 1)):
        jump 1586
    fi

1666:
    integer(value 0) = plus(integer(value 0), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump 1579
    fi

    if equals(integer(value 3), byte 0):
        print("\"You ain't got nothing I wants.\"")
        wait()

        jump 126
    fi

    if equals(integer(value 2), byte 1):
        integer(value 3) = character(data(dword 3369, byte 0), byte 0)
        ('SETNAME', ('integer', [('value', 3)]))
        print("\"Aye, $Y got somethin' interestin'...\"")
        wait()

        print("\n\n")
        jump 1933
    fi

1809:
    integer(value 1) = byte 1

1816:
    ('SETNAME', ('character', [('data', [('dword', 3369), ('minus', [('integer', [('value', 1)]), ('byte', 1)])]), ('byte', 0)]))
    print("#1) $Y\n")
    integer(value 1) = plus(integer(value 1), byte 1)

    if lessOrEquals(integer(value 1), integer(value 2)):
        jump 1816
    fi

    print("\"Which of you?\" ")
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump 2465
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greaterOrEquals(integer(value 3), integer(value 2)):
        jump 1809
    fi

    integer(value 3) = character(data(dword 3369, integer(value 3)), byte 0)

1933:
    integer(value 0) = byte 0
    integer(value 5) = byte 0

1947:
    if equals(hasObject(integer(value 3), data(dword 3185, integer(value 0)), byte 0), byte 0):
        jump 1994
    fi

    data(dword 3339, integer(value 5)) = integer(value 0)
    integer(value 5) = plus(integer(value 5), byte 1)

1994:
    integer(value 0) = plus(integer(value 0), byte 1)

    if data(dword 3185, integer(value 0)):
        jump 1947
    fi

    if equals(integer(value 5), byte 1):
        integer(value 6) = data(dword 3339, byte 0)
        jump 2158
    fi

    integer(value 0) = byte 1

2053:
    print("#0) ")
    ('DPRINT', [('data', [('dword', 3339), ('minus', [('integer', [('value', 0)]), ('byte', 1)])]), ('dword', 3209)])
    print("\n")
    integer(value 0) = plus(integer(value 0), byte 1)

    if lessOrEquals(integer(value 0), integer(value 5)):
        jump 2053
    fi

    print("\"Which item?\" ")
    ('INPUTNUM', 6)

    if greater(integer(value 6), integer(value 5)):
        jump 1933
    fi

    if equals(integer(value 6), byte 0):
        jump 2465
    fi

    integer(value 6) = data(dword 3339, minus(integer(value 6), byte 1))

2158:
    string(value 0) = data(dword 3209, integer(value 6))
    integer(value 7) = divide(data(dword 3163, integer(value 6)), byte 3)
    ('SETNAME', ('integer', [('value', 3)]))
    print("\"I'll give ya #7 gold for that $0, $Y. Whaddya say?\" ")

    askc("yn")

    case "n":
        if equals(integer(value 5), byte 1):
            print("\"I don't bargain, mate. #7 and not a copper.\"")
            wait()

            jump 126

        else:
            print("\"Well, how 'bout somethin' else?\"")
            wait()

            print("\n\n")
            jump 1933
        fi

    case "y":
        ('SETNAME', ('integer', [('value', 3)]))
        print("\"Done!\" $N hands $Y #7 gold pieces and takes the $0.")
        ('DELETE', ('integer', [('value', 3)]), ('data', [('dword', 3185), ('integer', [('value', 6)])]), ('byte', 0), ('byte', 1))
        ('NEW', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 7)]))

        if equals(integer(value 5), byte 1):
            jump 126

        else:
            wait()

            print("\n\n")
            jump 1933

            // Unreachable code!
        fi
    esac

2465:
    print("\"Changed your mind, eh?\"")
    wait()

    jump 126

2495:
    if notEquals(integer(value 32), byte 144):
        print("\"Come to my shop when I'm open!\"")
        jump 126
    fi

    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 1
        jump 2686
    fi

2560:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

2574:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print("#2) $Y\n")
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump 2574
    fi

    print("\"Which of you?\" ")
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump 2465
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump 2560
    fi

    integer(value 3) = character(integer(value 3), byte 0)

2686:
    integer(value 0) = byte 1
    ('SETNAME', ('integer', [('value', 3)]))

2697:
    string(value 0) = data(dword 3209, plus(integer(value 9), minus(integer(value 0), byte 1)))
    print("#0) $0\n")
    integer(value 0) = plus(integer(value 0), byte 1)

    if and(integer(value 9), notEquals(data(dword 3185, plus(integer(value 9), minus(integer(value 0), byte 1))), byte 0)):
        jump 2697
    fi

    if and(equals(integer(value 9), byte 0), lessOrEquals(integer(value 0), integer(value 8))):
        jump 2697
    fi

    integer(value 7) = integer(value 0)
    print("\"Which item?\" ")
    ('INPUTNUM', 0)

    if equals(integer(value 0), byte 0):
        jump 2465
    fi

    if greaterOrEquals(integer(value 0), integer(value 7)):
        jump 2686
    fi

    integer(value 0) = minus(plus(integer(value 9), integer(value 0)), byte 1)
    integer(value 1) = data(dword 3163, integer(value 0))
    string(value 1) = data(dword 3209, integer(value 0))
    print("\"That $1 costs #1 gold.\"")
    wait()

    print("\n\n\"Interested, $Y?\" ")

    askc("yn")

    case "y":
        jump 2934

    case "n":
        jump 2686

        // Unreachable code!
    esac

2934:
    if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(dword 3185, integer(value 0)), byte 1)):
        print("\"What's this? You can't carry no $1, $Y!\"")
        wait()

        jump 126
    fi

    if greaterOrEquals(objectsCount(integer(value 3), byte 88), integer(value 1)):
        ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 1)]))
        ('NEW', ('integer', [('value', 3)]), ('data', [('dword', 3185), ('integer', [('value', 0)])]), ('byte', 0), ('byte', 1))
        print("\"Great!\"\n\nAfter accepting $Y's gold, $N hands over the $1.")
        wait()

        print("\n\n")
        jump 2686

    else:
        print("\"What's this? You can't afford no $1, $Y!\"")
        wait()

        jump 126

        // Unreachable code!
    fi

    [['INTEGERS', [100, 20, 40, 15, 50, 30, 40, 75, 20, 25, 30]]]
    [['INTEGERS', [47, 204, 40, 37, 45, 14, 15, 20, 24, 4, 13, 0]]]
    [['STRINGS', ['Halberd', 'Hammer', 'Morning Star', 'Throwing Axe', '2-Handed Axe', 'Black Shield', 'Door Shield', 'Scale Mail', 'Spiked Collar', 'Spiked Helm', 'Spiked Shield']]]
    [['INTEGERS', [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]]
    [['INTEGERS', [0, 0, 0, 0, 0, 0, 0, 0]]]

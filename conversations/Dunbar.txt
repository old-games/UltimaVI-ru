source('CONVERSE.A')
index(96)

id(96)
name('Dunbar')

description:
    print('a plump, jovial fellow chewing on a leg of lamb.')
    wait()

    print('\n')

interaction:
    integer(value 5) = byte 0
    print('"Welcome to the Humble Palate."')
    jump label_136

label_103:
    print('"Anything else I can do for you?"')

label_136:
    print('\n')

    ask()

    case 'name':
        print('"My name is Dunbar," he says between bites of mutton.')
        setBit(byte 235, value 0)
        jump label_136

    case 'buy':
        print('"Which, @fish, @ale, @mead, @wine, or @mutton?"')
        jump label_136

    case 'job':
        print('"I sell @fish, @ale, @mead, @wine, and @mutton."')
        jump label_136

    case 'fish':
        jump label_1367

    case 'mead':
        integer(value 4) = byte 0
        jump label_878

    case 'ale':
        integer(value 4) = byte 1
        jump label_878

    case 'wine':
        integer(value 4) = byte 2
        jump label_878

    case 'mutt':
    case 'rati':
        jump label_1870

    case 'humb':
    case 'humi':
        print('"Serving others it the humblest occupation I could imagine. That\'s why')
        print(' I opened this place."')
        wait()

        print('\n\nHe pauses to wipe his mouth with the back of his hand.')
        jump label_136

    case 'cono':
        print('"I hear he used to be the head of some important @guild."')
        jump label_136

    case 'guil':
    case 'head':
    case 'impo':
        print('"I don\'t know anything about it, but maybe it explains that strange ')
        print('@glow you can see over by his house at night."')
        jump label_136

    case 'expl':
    case 'glow':
    case 'stra':
        print('"Go see for yourself."')
        jump label_136

    case 'bye':
    case 'no':
        print('"See you later."\n')
        bye()

    case '*':
        print('"I can\'t help you with that."')
    esac

    jump label_136

label_878:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 1
        jump label_1024
    fi

label_898:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_912:
    look(character(integer(value 0), byte 0))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_912
    fi

    print('"Which of you?" ')
    inputInteger(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_1327
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_898
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_1024:
    integer(value 1) = data(integers_2580, integer(value 4))
    print('"For that I charge a modest #1 gold. Want some?" ')

    choice('yn')

    case 'y':
        jump label_1113

    case 'n':
        integer(value 5) = byte 0
        jump label_1327
    esac

label_1113:
    if less(objectsCount(integer(value 3), byte 88), integer(value 1)):
        print('"I\'m afraid you haven\'t enough money for it."')
        wait()

        print('\n\n')
        jump label_103
    fi

    if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(integers_2586, integer(value 4)), byte 1)):
        print('"You don\'t have room to carry it."\n\n')
        integer(value 5) = byte 0
        jump label_1327
    fi

    destroyItem(integer(value 3), byte 88, byte 0, integer(value 1))
    createItem(integer(value 3), data(integers_2586, integer(value 4)), byte 0, byte 1)
    look(integer(value 3))
    integer(value 5) = byte 1
    string(value 1) = data(strings_2592, integer(value 4))
    print('"Here you go."')
    wait()

    print('\n\n')
    jump label_1327

label_1327:
    if integer(value 5):
        print('"I hope you enjoy it."')
        wait()

        print('\n\n')
        jump label_103
    fi

    jump label_103

label_1367:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 1
        jump label_1513
    fi

label_1387:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1401:
    look(character(integer(value 0), byte 0))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1401
    fi

    print('"Which of you?" ')
    inputInteger(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_1818
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1387
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_1513:
    print('"I buy all my fish fresh from @Conor. It\'s 3 gold per serving. Would ')
    print('you like some?" ')

    choice('yn')

    case 'y':
        if less(objectsCount(integer(value 3), byte 88), byte 3):
            print('"I\'m afraid you haven\'t enough money for it."')
            wait()

            print('\n\n')
            jump label_103
        fi

        if less(plus(canCarry(integer(value 3)), weight(byte 88, byte 3)), weight(word 265, byte 1)):
            print('"You don\'t have room to carry it."*\n\n')
            integer(value 5) = byte 0
            jump label_103
        fi

        destroyItem(integer(value 3), byte 88, byte 0, byte 3)
        createItem(integer(value 3), word 265, byte 0, byte 1)
        look(integer(value 3))
        print('$N serves $Y a fish.')
        wait()

        integer(value 5) = byte 1
        print('\n\n')
        jump label_1818

    case 'n':
        integer(value 5) = byte 0
        jump label_1818
    esac

label_1818:
    print('"Next week we should have some red snapper."')
    wait()

    print('\n\n')
    jump label_103

label_1870:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 1
        jump label_2016
    fi

label_1890:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1904:
    look(character(integer(value 0), byte 0))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1904
    fi

    print('"Which of you?" ')
    inputInteger(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_103
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1890
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_2016:
    if or(less(plus(canCarry(integer(value 3)), weight(byte 88, byte 4)), weight(byte 129, byte 1)), less(objectsCount(integer(value 3), byte 88), byte 4)):
        integer(value 9) = byte 1
        jump label_2147
    fi

    print('"Rations cost 4 gold. How many do you want?" ')
    input(integer(value 9))

    if greater(integer(value 9), word 200):
        integer(value 9) = word 200
    fi

    integer(value 8) = integer(value 9)

    if equals(integer(value 9), byte 0):
        jump label_103
    fi

    integer(value 0) = byte 0

label_2147:
    integer(value 6) = byte 0
    integer(value 7) = byte 0

    if less(plus(canCarry(integer(value 3)), weight(byte 88, multiply(integer(value 9), byte 4))), weight(byte 129, integer(value 9))):
        integer(value 6) = byte 1
        integer(value 0) = byte 1
        integer(value 9) = minus(integer(value 9), byte 1)
        jump label_2252
    fi

    if less(objectsCount(integer(value 3), byte 88), multiply(integer(value 9), byte 4)):
        integer(value 7) = byte 1
        integer(value 9) = minus(integer(value 9), byte 1)
        jump label_2252
    fi

    jump label_2393

label_2252:
    if integer(value 9):
        jump label_2147
    fi

    if integer(value 6):
        look(integer(value 3))
        print('$N looks at $Y. "You haven\'t any room in your pack."')
        wait()

        print('\n\n')
        jump label_103
    fi

    if integer(value 7):
        look(integer(value 3))
        print('"I\'m afraid you haven\'t enough money for it."')
        wait()

        print('\n\n')
        jump label_103
    fi

label_2393:
    destroyItem(integer(value 3), byte 88, byte 0, multiply(integer(value 9), byte 4))
    createItem(integer(value 3), byte 129, byte 0, integer(value 9))
    look(integer(value 3))

    if equals(integer(value 8), integer(value 9)):
        print('$N hands the rations to $Y.')
        wait()

        print('\n\n')
        jump label_103
    fi

    print('He hands $Y #9 mutton ration\\s.')
    wait()

    print('\n\n')

    if integer(value 0):
        print('"That\'s all you can carry."')
        wait()

        print('\n\n')
        jump label_103

    else:
        print('"That\'s all you can afford."')
        wait()

        print('\n\n')
        jump label_103
    fi

integers_2580 = [
    3, // 0
    2, // 1
    4, // 2
]

integers_2586 = [
    116, // 0
    117, // 1
    115, // 2
]

strings_2592 = [
    'Mead', // 0
    'Ale',  // 1
    'Wine', // 2
]

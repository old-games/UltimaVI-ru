source('CONVERSE.B')
index(19)

id(118)
name({
    'english': 'Shawn',
    'russian': 'Шон'
})

description:
    print({
        'english': 'a charismatic man with an engaging smile.',
        'russian': 'харизматичного мужчину с очаровательной улыбкой.'
    })
    wait()

    print({
        'english': '\n',
        'russian': '\n'
    })

interaction:
    if hasBit(byte 235, value 0):
        print({
            'english': '"Welcome back, stranger." He winks at you.\n',
            'russian': '"С возвращением!" - говорит он, подмигивая.\n'
        })

    else:
        print({
            'english': '"Welcome." He makes a sweeping gesture with his hat.\n',
            'russian': '"Добро пожаловать!" - он снимает и взмахивает перед вами шляпой.\n'
        })
    fi

label_156:
    ask()

    case 'name':
    case {'russian': 'имя'}:
        print({
            'english': '"Shawn, friend."\n',
            'russian': '"Меня зовут Шон, мой друг".\n'
        })
        setBit(byte 235, value 0)
        jump label_156

    case 'buy':
    case {'russian': 'куп'}:
        print({
            'english': '"Which: @ham, @ale, @mead, @wine, or @rations?"\n',
            'russian': '"Что именно: @ветчину, @эль, @медовуху, @вино или @пайки?"\n'
        })
        jump label_156

    case 'job':
    case {'russian': 'раб'}:
        print({
            'english': '"I sell @ham, @ale, @mead, @wine, and @rations."\n',
            'russian': '"Я продаю @ветчину, @эль, @медовуху, @вино и @пайки".\n'
        })
        jump label_156

    case 'ham':
    case {'russian': 'ветч'}:
        jump label_1018

    case 'mead':
    case {'russian': 'мед'}:
        integer(value 4) = byte 0
        jump label_528

    case 'ale':
    case {'russian': 'эль'}:
        integer(value 4) = byte 1
        jump label_528

    case 'wine':
    case {'russian': 'вино'}:
        integer(value 4) = byte 2
        jump label_528

    case 'rati':
    case {'russian': 'пай'}:
        jump label_1471

    case 'shaw':
    case {'russian': 'шон'}:
        print({
            'english': '"That\'s it."\n',
            'russian': '"Так и есть".\n'
        })
        jump label_156

    case 'bye':
    case {'russian': 'пока'}:
        print({
            'english': '"I\'m glad you stopped by." He gives you a firm handshake.\n',
            'russian': '"Я рад, что вы заглянули", - он крепко пожимает вам руку.\n'
        })
        bye()

    case '*':
        print({
            'english': '"I\'m sorry. Perhaps you could ask someone else."\n',
            'russian': '"Простите, возможно, вам следует спросить кого-то другого".\n'
        })
    esac

    jump label_156

label_528:
    if equals(integer(value 23), byte 0):
        integer(value 3) = character(byte 0, byte 0)
        jump label_692
    fi

label_551:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_565:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': '#2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_565
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        print({
            'english': '"Very well..."\n',
            'russian': '"Замечательно..."\n'
        })
        jump label_156
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_551
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_692:
    look(integer(value 3))
    integer(value 1) = data(integers_2217, integer(value 4))
    print({
        'english': '$N smiles at $Y and says, "That will cost you #1 gold. Interested?" ',
        'russian': '$N улыбается персонажу $Y и говорит: "С вас #1 золотых. По рукам?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        jump label_812

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Very well..."\n',
            'russian': '"Замечательно..."\n'
        })
        jump label_156
    esac

label_812:
    if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(integers_2223, integer(value 4)), byte 1)):
        print({
            'english': '"You can\'t carry it, $Y."\n',
            'russian': '"Вам это не унести, $Y".\n'
        })
        jump label_156
    fi

    if greaterOrEquals(objectsCount(integer(value 3), byte 88), integer(value 1)):
        destroyItem(integer(value 3), byte 88, byte 0, integer(value 1))
        createItem(integer(value 3), data(integers_2223, integer(value 4)), byte 0, byte 1)
        print({
            'english': '"Fine!" After accepting $Y\'s gold, $N hands over the purchase.\n',
            'russian': '"Отлично!" Взяв у персонажа $Y золото, $N передаёт покупку.\n'
        })
        jump label_156

    else:
        print({
            'english': '"You don\'t have enough gold, $Y."\n',
            'russian': '"У вас не хватает золота, $Y".\n'
        })
        jump label_156
    fi

label_1018:
    if equals(integer(value 23), byte 0):
        integer(value 3) = character(byte 0, byte 0)
        jump label_1182
    fi

label_1041:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1055:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': '#2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1055
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        print({
            'english': '"Very well..."\n',
            'russian': '"Замечательно..."\n'
        })
        jump label_156
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1041
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_1182:
    look(integer(value 3))
    print({
        'english': '"It\'ll cost you 5 gold for the ham. Interested?" ',
        'russian': '"Ветчина стоит 5 золотых. По рукам?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        if less(plus(canCarry(integer(value 3)), weight(byte 88, byte 5)), weight(byte 133, byte 1)):
            print({
                'english': '"You can\'t carry it, $Y."\n',
                'russian': '"Вам это не унести, $Y".\n'
            })
            jump label_156
        fi

        if greaterOrEquals(objectsCount(integer(value 3), byte 88), byte 5):
            destroyItem(integer(value 3), byte 88, byte 0, byte 5)
            createItem(integer(value 3), byte 133, byte 0, byte 1)
            print({
                'english': '"Excellent!" After accepting the gold, $N serves $Y the ham.\n',
                'russian': '"Потрясающе!" - взяв золото, $N подаёт персонажу $Y ветчину.\n'
            })
            jump label_156

        else:
            print({
                'english': '"How were you looking to pay for the meal? Eh?"\n',
                'russian': '"И как вы собирались расплатиться за еду? А?"\n'
            })
            jump label_156
        fi

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Very well..."\n',
            'russian': '"Замечательно..."\n'
        })
        jump label_156
    esac

label_1471:
    if equals(integer(value 23), byte 0):
        integer(value 3) = character(byte 0, byte 0)
        jump label_1635
    fi

label_1494:
    integer(value 0) = byte 0
    integer(value 1) = byte 1

label_1508:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#1. $Y\n',
        'russian': '#1. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 1) = plus(integer(value 1), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1508
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        print({
            'english': '"Very well..."\n',
            'russian': '"Замечательно..."\n'
        })
        jump label_156
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1494
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_1635:
    look(integer(value 3))

    if or(less(plus(canCarry(integer(value 3)), weight(byte 88, byte 4)), weight(byte 129, byte 1)), less(objectsCount(integer(value 3), byte 88), byte 4)):
        integer(value 5) = byte 1
        jump label_1899
    fi

label_1678:
    print({
        'english': '$N looks at $Y and says, "It\'ll cost you 4 gold for each ration. How ',
        'russian': '$N смотрит на персонажа $Y и говорит: "Пайки стоят 4 золотых за штуку. Сколько '
    })
    print({
        'english': 'many do you want?" ',
        'russian': 'вам нужно?" '
    })
    inputInteger(integer(value 5))

    if greater(integer(value 5), byte 100):
        print({
            'english': '"Come now, that\'s a little much, don\'t you think?"',
            'russian': '"Полно вам, не многовато ли вам?"'
        })
        wait()

        print({
            'english': '\n\n',
            'russian': '\n\n'
        })
        jump label_1678
    fi

    if equals(integer(value 5), byte 0):
        print({
            'english': '$N frowns at $Y and says, "That was a good price."\n',
            'russian': '$N хмуро смотрит на персонажа $Y и говорит: "Это была выгодная цена".\n'
        })
        jump label_156
    fi

label_1899:
    integer(value 2) = integer(value 5)
    integer(value 0) = byte 0
    integer(value 1) = byte 0

label_1920:
    if less(plus(canCarry(integer(value 3)), weight(byte 88, multiply(byte 4, integer(value 2)))), weight(byte 129, integer(value 2))):
        integer(value 1) = byte 1
        integer(value 0) = byte 1
        integer(value 2) = minus(integer(value 2), byte 1)
        jump label_2011
    fi

    if less(objectsCount(integer(value 3), byte 88), multiply(integer(value 2), byte 4)):
        integer(value 1) = byte 2
        integer(value 2) = minus(integer(value 2), byte 1)
        jump label_2011
    fi

    jump label_2139

label_2011:
    if integer(value 2):
        jump label_1920
    fi

    if equals(integer(value 1), byte 1):
        print({
            'english': '"You haven\'t any room in your pack, $Y."\n',
            'russian': '"В вашем мешке нет места, $Y".\n'
        })
        jump label_156
    fi

    if equals(integer(value 1), byte 2):
        print({
            'english': '"Mutton rations cost more gold than you have, $Y."\n',
            'russian': '"Пайки с бараниной стоят больше, чем вы можете себе позволить, $Y".\n'
        })
        jump label_156
    fi

label_2139:
    destroyItem(integer(value 3), byte 88, byte 0, multiply(integer(value 2), byte 4))
    createItem(integer(value 3), byte 129, byte 0, integer(value 2))
    print({
        'english': 'He hands $Y #2 mutton ration\\s.',
        'russian': 'Он передаёт персонажу $Y пайки с бараниной, #2 шт.'
    })
    wait()

    print({
        'english': '\n\n',
        'russian': '\n\n'
    })
    printString(strings_2243, integer(value 1))
    print({
        'english': '\n',
        'russian': '\n'
    })
    jump label_156

integers_2217 = [
    5, // 0
    3, // 1
    4, // 2
]

integers_2223 = [
    116,   // 0
    117,   // 1
    115,   // 2
    25933, // 3
    25697, // 4
    16640, // 5
    25964, // 6
    22272, // 7
    28265, // 8
    101,   // 9
]

strings_2243 = [
    {
        'english': '"There ya go."',
        'russian': '"Держите".'
    }, // 0
    {
        'english': '"That\'s all you can carry."',
        'russian': '"Больше вам не унести".'
    }, // 1
    {
        'english': '"That\'s all you can afford."',
        'russian': '"Это всё, что вы можете себе позволить".'
    }, // 2
]

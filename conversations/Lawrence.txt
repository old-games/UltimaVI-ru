source('CONVERSE.A')
index(77)

id(77)
name({
    'english': 'Lawrence',
    'russian': 'Лоуренс'
})

description:
    print({
        'english': 'a small, fussy looking man.',
        'russian': 'маленького вертлявого мужчину.'
    })
    wait()

    print({
        'english': '\n',
        'russian': '\n'
    })

interaction:
    integer(value 5) = byte 0
    print({
        'english': '"Welcome to the Fool\'s Pair o\' Dice."',
        'russian': '"Добро пожаловать в Лудем!"'
    })
    jump label_124

label_90:
    print({
        'english': '\n"Anything else I can do for you?"',
        'russian': '\n"Что-нибудь ещё?"'
    })

label_124:
    print({
        'english': '\n',
        'russian': '\n'
    })

    ask()

    case 'name':
    case {'russian': 'имя'}:
        print({
            'english': '"It\'s Lawrence."',
            'russian': '"Зовут Лоуренс".'
        })
        setBit(byte 235, value 0)
        jump label_124

    case 'buy':
    case {'russian': 'куп'}:
        print({
            'english': '"Which, @grapes, @ale, @mead, @wine, or @rations?"',
            'russian': '"Что интересует? @Виноград, @эль, @медовуха, @вино или @пайки?"'
        })
        jump label_124

    case 'job':
    case {'russian': 'раб'}:
        print({
            'english': '"I sell @grapes, @ale, @mead, @wine, and @rations."',
            'russian': '"Я продаю @виноград, @эль, @медовуху, @вино и @пайки".'
        })
        jump label_124

    case 'grap':
    case {'russian': 'виног'}:
        jump label_877

    case 'mead':
    case {'russian': 'мед'}:
        integer(value 4) = byte 0
        jump label_413

    case 'ale':
    case {'russian': 'эль'}:
        integer(value 4) = byte 1
        jump label_413

    case 'wine':
    case {'russian': 'вино'}:
        integer(value 4) = byte 2
        jump label_413

    case 'rati':
    case {'russian': 'пай'}:
        jump label_1255

    case 'no':
    case {'russian': 'нет'}:
    case 'bye':
    case {'russian': 'пока'}:
        print({
            'english': '"Goodbye."\n',
            'russian': '"Прощайте".\n'
        })
        bye()

    case '*':
        print({
            'english': '"I can\'t help you with that."',
            'russian': '"Ничем не могу помочь".'
        })
    esac

    jump label_124

label_413:
    if equals(integer(value 23), byte 0):
        integer(value 3) = character(byte 0, byte 0)
        jump label_562
    fi

label_436:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_450:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': '#2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_450
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_834
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_436
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_562:
    look(integer(value 3))
    integer(value 1) = data(integers_1967, integer(value 4))
    print({
        'english': '"That\'s #1 gold, okay?" ',
        'russian': '"С вас #1 золотых, по рукам?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        jump label_630

    case 'n':
    case {'russian': 'н'}:
        integer(value 5) = byte 0
        jump label_834
    esac

label_630:
    if less(objectsCount(integer(value 3), byte 88), integer(value 1)):
        print({
            'english': '"Come back when you have some gold."',
            'russian': '"Возвращайтесь, когда раздобудете золото".'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_90
    fi

    if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(integers_1973, integer(value 4)), byte 1)):
        print({
            'english': '"You don\'t have room to carry it."',
            'russian': '"В вашем мешке недостаточно места".'
        })
        integer(value 5) = byte 0
        jump label_834
    fi

    destroyItem(integer(value 3), byte 88, byte 0, integer(value 1))
    createItem(integer(value 3), data(integers_1973, integer(value 4)), byte 0, byte 1)
    integer(value 5) = byte 1
    string(value 1) = data(strings_1979, integer(value 4))
    print({
        'english': '$N gives $Y some $1.',
        'russian': '$N отдаёт персонажу $Y предметы: $1.'
    })
    wait()

    print({
        'english': '\n\n',
        'russian': '\n\n'
    })
    jump label_834

label_834:
    if integer(value 5):
        print({
            'english': '"That ought to hold you."',
            'russian': '"Этого должно хватить".'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_90
    fi

    print({
        'english': '\n',
        'russian': '\n'
    })
    jump label_90

label_877:
    if equals(integer(value 23), byte 0):
        integer(value 3) = character(byte 0, byte 0)
        jump label_1026
    fi

label_900:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_914:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': '#2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_914
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_1249
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_900
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_1026:
    look(integer(value 3))
    print({
        'english': '"That\'ll be 3 gold, okay?" ',
        'russian': '"Это стоит 3 золотых, по рукам?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        if less(objectsCount(integer(value 3), byte 88), byte 3):
            print({
                'english': '"Come back when you have some gold."',
                'russian': '"Возвращайтесь, когда раздобудете золото".'
            })
            wait()

            print({
                'english': '\n',
                'russian': '\n'
            })
            jump label_90
        fi

        if less(plus(canCarry(integer(value 3)), weight(byte 88, byte 3)), weight(byte 95, byte 1)):
            print({
                'english': '"You don\'t have room to carry them."',
                'russian': '"Вам столько не унести".'
            })
            integer(value 5) = byte 0
            jump label_1249
        fi

        destroyItem(integer(value 3), byte 88, byte 0, byte 3)
        createItem(integer(value 3), byte 95, byte 0, byte 1)
        print({
            'english': '$N gives $Y some grapes.',
            'russian': '$N отдаёт персонажу $Y немного винограда.'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_1249

    case 'n':
    case {'russian': 'н'}:
        jump label_1249
    esac

label_1249:
    print({
        'english': '\n',
        'russian': '\n'
    })
    jump label_90

label_1255:
    if equals(integer(value 23), byte 0):
        integer(value 3) = character(byte 0, byte 0)
        jump label_1404
    fi

label_1278:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1292:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': '#2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1292
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_90
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1278
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_1404:
    if or(less(plus(canCarry(integer(value 3)), weight(byte 88, byte 4)), weight(byte 129, byte 1)), less(objectsCount(integer(value 3), byte 88), byte 4)):
        integer(value 9) = byte 1
        jump label_1541
    fi

    print({
        'english': '"Rations are 4 gold apiece. How many do you want?" ',
        'russian': '"Пайки продаются за 4 золотых за штуку. Сколько вам нужно?" '
    })
    inputInteger(integer(value 9))

    if greater(integer(value 9), word 200):
        integer(value 9) = word 200
    fi

    integer(value 8) = integer(value 9)

    if equals(integer(value 9), byte 0):
        jump label_90
    fi

    integer(value 0) = byte 0

label_1541:
    integer(value 6) = byte 0
    integer(value 7) = byte 0

    if less(plus(canCarry(integer(value 3)), weight(byte 88, multiply(byte 4, integer(value 9)))), weight(byte 129, integer(value 9))):
        integer(value 6) = byte 1
        integer(value 0) = byte 1
        integer(value 9) = minus(integer(value 9), byte 1)
        jump label_1646
    fi

    if less(objectsCount(integer(value 3), byte 88), multiply(integer(value 9), byte 4)):
        integer(value 7) = byte 1
        integer(value 9) = minus(integer(value 9), byte 1)
        jump label_1646
    fi

    jump label_1776

label_1646:
    if integer(value 9):
        jump label_1541
    fi

    if integer(value 6):
        look(integer(value 3))
        print({
            'english': '$N looks at $Y. "You haven\'t any room in your pack."',
            'russian': '$N смотрит на персонажа $Y: "В вашем мешке недостаточно места".'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_90
    fi

    if integer(value 7):
        look(integer(value 3))
        print({
            'english': '"Come back when you have some gold."',
            'russian': '"Возвращайтесь, когда раздобудете золото".'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_90
    fi

label_1776:
    destroyItem(integer(value 3), byte 88, byte 0, multiply(integer(value 9), byte 4))
    createItem(integer(value 3), byte 129, byte 0, integer(value 9))
    look(integer(value 3))

    if equals(integer(value 8), integer(value 9)):
        look(integer(value 3))
        print({
            'english': '$N hands the rations to $Y.',
            'russian': '$N передаёт пайки персонажу $Y.'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_90
    fi

    print({
        'english': 'He hands $Y #9 ration\\s of mutton.',
        'russian': 'Он передаёт персонажу $Y пайки из баранины х#9.'
    })
    wait()

    print({
        'english': '\n\n',
        'russian': '\n\n'
    })

    if integer(value 0):
        print({
            'english': '"That\'s all you can carry."',
            'russian': '"Больше вам не унести".'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_90

    else:
        print({
            'english': '"That\'s all you can afford."',
            'russian': '"Больше вам не по карману".'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_90
    fi

integers_1967 = [
    2, // 0
    5, // 1
    5, // 2
]

integers_1973 = [
    116, // 0
    117, // 1
    115, // 2
]

strings_1979 = [
    {
        'english': 'Mead',
        'russian': 'Медовуха'
    }, // 0
    {
        'english': 'Ale',
        'russian': 'Эль'
    }, // 1
    {
        'english': 'Wine',
        'russian': 'Вино'
    }, // 2
]

source('CONVERSE.A')
index(77)

id(77)
name('Lawrence')

description:
    print('a small, fussy looking man.')
    wait()

    print('\n')

interaction:
    integer(value 5) = byte 0
    print('"Welcome to the Fool\'s Pair o\' Dice."')
    jump label_124

label_90:
    print('\n"Anything else I can do for you?"\n')

label_124:
    print('\n')

    ask()

    case 'name':
        print('"It\'s Lawrence."')
        ('SETF', ('byte', 235), ('value', 0))
        jump label_124

    case 'buy':
        print('"Which, @grapes, @ale, @mead, @wine, or @rations?"')
        jump label_124

    case 'job':
        print('"I sell @grapes, @ale, @mead, @wine, and @rations."')
        jump label_124

    case 'grap':
        jump label_877

    case 'mead':
        integer(value 4) = byte 0
        jump label_413

    case 'ale':
        integer(value 4) = byte 1
        jump label_413

    case 'wine':
        integer(value 4) = byte 2
        jump label_413

    case 'rati':
        jump label_1255

    case 'bye':
    case 'no':
        print('"Goodbye."\n')
        bye()

    case '*':
        print('"I can\'t help you with that."')
    esac

    jump label_124

label_413:
    if equals(integer(value 23), byte 0):
        integer(value 3) = character(byte 0, byte 0)
        jump label_562
    fi

label_436:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_450:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_450
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump label_834
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_436
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_562:
    ('SETNAME', ('integer', [('value', 3)]))
    integer(value 1) = data(dword 1967, integer(value 4))
    print('"That\'s #1 gold, okay?" ')

    choice('yn')

    case 'y':
        jump label_630

    case 'n':
        integer(value 5) = byte 0
        jump label_834
    esac

label_630:
    if less(objectsCount(integer(value 3), byte 88), integer(value 1)):
        print('"Come back when you have some gold."')
        wait()

        print('\n')
        jump label_90
    fi

    if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(dword 1973, integer(value 4)), byte 1)):
        print('"You don\'t have room to carry it."')
        integer(value 5) = byte 0
        jump label_834
    fi

    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 1)]))
    ('NEW', ('integer', [('value', 3)]), ('data', [('dword', 1973), ('integer', [('value', 4)])]), ('byte', 0), ('byte', 1))
    integer(value 5) = byte 1
    string(value 1) = data(dword 1979, integer(value 4))
    print('$N gives $Y some $1.')
    wait()

    print('\n\n')
    jump label_834

label_834:
    if integer(value 5):
        print('"That ought to hold you."')
        wait()

        print('\n')
        jump label_90
    fi

    print('\n')
    jump label_90

label_877:
    if equals(integer(value 23), byte 0):
        integer(value 3) = character(byte 0, byte 0)
        jump label_1026
    fi

label_900:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_914:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_914
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump label_1249
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_900
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_1026:
    ('SETNAME', ('integer', [('value', 3)]))
    print('"That\'ll be 3 gold, okay?" ')

    choice('yn')

    case 'y':
        if less(objectsCount(integer(value 3), byte 88), byte 3):
            print('"Come back when you have some gold."')
            wait()

            print('\n')
            jump label_90
        fi

        if less(plus(canCarry(integer(value 3)), weight(byte 88, byte 3)), weight(byte 95, byte 1)):
            print('"You don\'t have room to carry them."')
            integer(value 5) = byte 0
            jump label_1249
        fi

        ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('byte', 3))
        ('NEW', ('integer', [('value', 3)]), ('byte', 95), ('byte', 0), ('byte', 1))
        print('$N gives $Y some grapes.')
        wait()

        print('\n')
        jump label_1249

    case 'n':
        jump label_1249
    esac

label_1249:
    print('\n')
    jump label_90

label_1255:
    if equals(integer(value 23), byte 0):
        integer(value 3) = character(byte 0, byte 0)
        jump label_1404
    fi

label_1278:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1292:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1292
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump label_90
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1278
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_1404:
    if or(less(plus(canCarry(integer(value 3)), weight(byte 88, byte 4)), weight(byte 129, byte 1)), less(objectsCount(integer(value 3), byte 88), byte 4)):
        integer(value 9) = byte 1
        jump label_1541
    fi

    print('"Rations are 4 gold apiece. How many do you want?" ')
    ('INPUT', 9)

    if greater(integer(value 9), word 200):
        integer(value 9) = word 200
    fi

    integer(value 8) = integer(value 9)

    if equals(integer(value 9), byte 0):
        jump label_90
    fi

    integer(value 0) = byte 0

label_1541:
    integer(value 6) = byte 0
    integer(value 7) = byte 0

    if less(plus(canCarry(integer(value 3)), weight(byte 88, multiply(byte 4, integer(value 9)))), weight(byte 129, integer(value 9))):
        integer(value 6) = byte 1
        integer(value 0) = byte 1
        integer(value 9) = minus(integer(value 9), byte 1)
        jump label_1646
    fi

    if less(objectsCount(integer(value 3), byte 88), multiply(integer(value 9), byte 4)):
        integer(value 7) = byte 1
        integer(value 9) = minus(integer(value 9), byte 1)
        jump label_1646
    fi

    jump label_1776

label_1646:
    if integer(value 9):
        jump label_1541
    fi

    if integer(value 6):
        ('SETNAME', ('integer', [('value', 3)]))
        print('$N looks at $Y. "You haven\'t any room in your pack."')
        wait()

        print('\n')
        jump label_90
    fi

    if integer(value 7):
        ('SETNAME', ('integer', [('value', 3)]))
        print('"Come back when you have some gold."')
        wait()

        print('\n')
        jump label_90
    fi

label_1776:
    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('multiply', [('integer', [('value', 9)]), ('byte', 4)]))
    ('NEW', ('integer', [('value', 3)]), ('byte', 129), ('byte', 0), ('integer', [('value', 9)]))
    ('SETNAME', ('integer', [('value', 3)]))

    if equals(integer(value 8), integer(value 9)):
        ('SETNAME', ('integer', [('value', 3)]))
        print('$N hands the rations to $Y.')
        wait()

        print('\n')
        jump label_90
    fi

    print('He hands $Y #9 ration\\s of mutton.')
    wait()

    print('\n\n')

    if integer(value 0):
        print('"That\'s all you can carry."')
        wait()

        print('\n')
        jump label_90

    else:
        print('"That\'s all you can afford."')
        wait()

        print('\n')
        jump label_90
    fi

integers_1967 = [
    2, // 0
    5, // 1
    5, // 2
]

integers_1973 = [
    116, // 0
    117, // 1
    115, // 2
]

strings_1979 = [
    'Mead', // 0
    'Ale',  // 1
    'Wine', // 2
]

source("CONVERSE.A")
index(80)

id(80)
name("Immanuelle")

description:
    print("a sultry, dark-skinned woman dressed in riding-leathers.")
    wait()

    print("\n")

interaction:
    integer(value 9) = byte 60

    if hasBit(byte 235, value 0):
        print("\"Hello again, my friend")

    else:
        print("\"Hello, stranger")
        ('SETF', ('byte', 235), ('value', 0))
    fi

    if integer(value 23):
        print("s. What can I do for you")

    else:
        print(". What can I do for thee")
    fi

    print(" this $T?\"\n")

    ask()

    case "name":
        print("\"Some call me Immanuelle, $G.\"")
        wait()

        print("\n\n\"Others call me...something @else.\"")
        wait()

        print("\n\nShe winks at you.")
        jump 196

    case "else":
    case "some":
        if equals(integer(value 16), byte 0):
            print("\"Perhaps some time I will @show you...\"")

        else:
            print("\"I think you get the idea.\"")
        fi

        jump 196

    case "show":
        print("\"Not here.\"")
        jump 196

    case "job":
        print("\"I raise horses here, in the stables.\"")
        wait()

        print("\n\n\"I also sell @horses, if you wish to @buy one.\"")
        jump 196

    case "hors":
    case "sell":
        print("\"I can hardly bear to part with any of these magnificent beasts.\"")
        wait()

        print("\n\n\"But there are a few that fail to please me.\"")
        wait()

        print("\n\n\"If you wish to @buy one of them, just say the word.\"")
        jump 196

    case "buy":
        if notEquals(integer(value 32), byte 143):
            print("\"Come to my shop when I'm open!\"")
            jump 196

        else:
            jump 851
        fi

    case "bye":
        print("\"Come back again soon!\"")

        if equals(integer(value 16), byte 0):
            wait()

            print("\n\nAs you leave, she blows you a kiss.")
        fi

        print("\n")
        bye()

    case "*":
        print("\"Beg pardon, $G?\"")
        jump 196

        // Unreachable code!
    esac

851:
    if greater(integer(value 23), byte 0):
        integer(value 1) = byte 0
        integer(value 2) = byte 0
        integer(value 4) = byte 0
        jump 951
    fi

    integer(value 3) = character(byte 0, byte 0)

    if hasHorse(integer(value 3)):
        print("\"But thou already hast a horse!\"")
        jump 196

    else:
        integer(value 4) = byte 1
        jump 1252

        // Unreachable code!
    fi

951:
    if greater(integer(value 1), integer(value 23)):
        jump 1058
    fi

    integer(value 3) = character(integer(value 1), byte 0)

    if hasHorse(integer(value 3)):
        jump 1043
    fi

    if equals(integer(value 4), byte 0):
        integer(value 4) = integer(value 3)
        integer(value 2) = plus(integer(value 2), byte 1)
        jump 1043
    fi

    ('SETNAME', ('integer', [('value', 4)]))
    print("#2) $Y\n")
    integer(value 2) = plus(integer(value 2), byte 1)
    integer(value 4) = integer(value 3)

1043:
    integer(value 1) = plus(integer(value 1), byte 1)
    jump 951

1058:
    if equals(integer(value 2), byte 0):
        print("\"But all of you are already on horses!\"")
        jump 196
    fi

    if equals(integer(value 2), byte 1):
        integer(value 3) = integer(value 4)
        jump 1252
    fi

    ('SETNAME', ('integer', [('value', 4)]))
    print("#2) $Y\n")
    integer(value 4) = byte 0
    print("\"Which of you?\" ")
    ('INPUTNUM', 2)

    if equals(integer(value 2), byte 0):
        jump 196
    fi

    integer(value 1) = byte 0

1187:
    integer(value 3) = character(integer(value 1), byte 0)

    if equals(hasHorse(integer(value 3)), byte 0):
        integer(value 2) = minus(integer(value 2), byte 1)
    fi

    if equals(integer(value 2), byte 0):
        jump 1252
    fi

    integer(value 1) = plus(integer(value 1), byte 1)

    if lessOrEquals(integer(value 1), integer(value 23)):
        jump 1187
    fi

1252:
    ('SETNAME', ('integer', [('value', 3)]))
    print("\"Aye, $Y, thou hast need of a horse.\"")
    wait()

    print("\n\n")

    if less(objectsCount(integer(value 3), byte 88), integer(value 9)):
        print("\"But thou canst not afford one!\"")
        jump 1532
    fi

    print("\"My price is #9 gold pieces, no less. Interested?\" ")

    askc("yn")

    case "y":
        print("\"Good!\" $N takes $Y's gold, and hands over the reins of a fine horse.")
        ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 9)]))
        ('HORSE', ('integer', [('value', 3)]))
        jump 1532

    case "n":
        print("\"Perhaps some other time then.\"")
        jump 1532

        // Unreachable code!
    esac

1532:
    if integer(value 4):
        jump 196
    fi

    wait()

    print("\n\n\"How about ")

    if greater(integer(value 23), byte 1):
        print("one of thy friends")

    else:
        print("thy friend")
    fi

    print("?\"")
    wait()

    print("\n\n")
    integer(value 1) = byte 0
    integer(value 2) = byte 0
    integer(value 4) = byte 0
    jump 951

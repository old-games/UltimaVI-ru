source('CONVERSE.B')
index(55)

id(154)
name('Amanda')

description:
    print('a large black woman with a loud laugh.')
    wait()

    print('\n')

    f3()

interaction:
    integer(value 5) = byte 0

    if hasBit(byte 235, value 0):
        jump 133
    fi

    print('"Hello, hello!" she cries, clapping her hands together.*\n\n')
    jump 179

133:
    print('"You\'re here again! Good." She smiles widely. "What can I get ya?"\n')

179:
    print('"What can I get ya?"\n')

200:
    ask()

    case 'name':
        ('SETF', ('byte', 235), ('value', 0))
        print('"Amanda, but you can call me \'Miss Mandy\'."\n')
        jump 200

    case 'buy':
        print('"Which, @ale, @mead, @wine, @rations or @Waybread?"\n')
        jump 200

    case 'job':
        print('"I sell @ale, @mead, @wine, @rations and @Waybread."\n')
        jump 200

    case 'brea':
    case 'way':
        jump 1233

    case 'mead':
        integer(value 4) = byte 0
        jump 745

    case 'ale':
        integer(value 4) = byte 0
        jump 745

    case 'wine':
        integer(value 4) = byte 0
        jump 745

    case 'rati':
        jump 1738

    case 'aman':
        print('"Please, call me \'Miss Mandy\'."\n')
        jump 200

    case 'mand':
    case 'miss':
        print('"There, that\'s much better."\n')
        jump 200

    case 'segg':
        print('"He\'s been in here a few times. He has a homesick look, he does."\n')
        jump 200

    case 'bye':
        print('"Remember to tell your friends \'bout Miss Mandy."\n')
        bye()

    case '*':
        print('"That\'s one on me. \'Tain\'t never heard o\' that."\n')
    esac

    jump 200

745:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 1
        jump 891
    fi

765:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

779:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump 779
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump 1191
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump 765
    fi

    integer(value 3) = character(integer(value 3), byte 0)

891:
    integer(value 1) = data(dword 2450, integer(value 4))
    print('"That\'ll be #1 crowns, okay sugar?" ')

    choice('yn')

    case 'y':
        jump 967

    case 'n':
        integer(value 5) = byte 0
        jump 1191
    esac

967:
    if less(objectsCount(integer(value 3), byte 88), integer(value 1)):
        print('"Come back when you have some gold."')
        wait()

        print('\n\n')
        jump 179
    fi

    if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(dword 2456, integer(value 4)), byte 1)):
        print('"You don\'t have room to carry it."')
        integer(value 5) = byte 0
        jump 1191
    fi

    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 1)]))
    ('NEW', ('integer', [('value', 3)]), ('data', [('dword', 2456), ('integer', [('value', 4)])]), ('byte', 0), ('byte', 1))
    ('SETNAME', ('integer', [('value', 3)]))
    integer(value 5) = byte 1
    string(value 1) = data(dword 2462, integer(value 4))
    print('"Here you are." $N gives $Y the $1.')
    wait()

    print('\n\n')
    jump 1191

1191:
    if integer(value 5):
        print('"Y\'all enjoy it, now."')
        wait()

        print('\n\n')
        jump 179
    fi

    print('\n\n')
    jump 179

1233:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 1
        jump 1379
    fi

1253:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

1267:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump 1267
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump 1687
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump 1253
    fi

    integer(value 3) = character(integer(value 3), byte 0)

1379:
    print('"Some say I make the best Waybread in these parts. It costs just 2 ')
    print('gold. You want to try some?" ')

    choice('yn')

    case 'y':
        if less(objectsCount(integer(value 3), byte 88), byte 2):
            print('"Come back when you have some gold."')
            wait()

            print('\n\n')
            jump 179
        fi

        if less(plus(canCarry(integer(value 3)), weight(byte 88, byte 2)), weight(byte 130, byte 1)):
            print('"You don\'t have room to carry it."')
            integer(value 5) = byte 0
            jump 1687
        fi

        ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('byte', 2))
        ('NEW', ('integer', [('value', 3)]), ('byte', 130), ('byte', 0), ('byte', 1))
        ('SETNAME', ('integer', [('value', 3)]))
        print('$N gives $Y some Waybread.')
        wait()

        integer(value 5) = byte 1
        print('\n\n')
        jump 1687

    case 'n':
        integer(value 5) = byte 0
        jump 1687
    esac

1687:
    if integer(value 5):
        print('"That\'ll put some meat on your bones."')
        wait()
    fi

    print('\n\n')
    jump 179

1738:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 1
        jump 1884
    fi

1758:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

1772:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump 1772
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump 179
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump 1758
    fi

    integer(value 3) = character(integer(value 3), byte 0)

1884:
    if or(less(plus(canCarry(integer(value 3)), weight(byte 88, byte 4)), weight(byte 129, byte 1)), less(objectsCount(integer(value 3), byte 88), byte 4)):
        integer(value 9) = byte 1
        jump 2021
    fi

    print('"Rations are 4 gold apiece. How many do you want?" ')
    ('INPUT', 9)

    if greater(integer(value 9), word 200):
        integer(value 9) = word 200
    fi

    integer(value 8) = integer(value 9)

    if equals(integer(value 9), byte 0):
        jump 179
    fi

    integer(value 0) = byte 0

2021:
    integer(value 6) = byte 0
    integer(value 7) = byte 0

    if less(plus(canCarry(integer(value 3)), weight(byte 88, multiply(integer(value 9), byte 4))), weight(byte 129, integer(value 9))):
        integer(value 6) = byte 1
        integer(value 0) = byte 1
        integer(value 9) = minus(integer(value 9), byte 1)
        jump 2126
    fi

    if less(objectsCount(integer(value 3), byte 88), multiply(integer(value 9), byte 4)):
        integer(value 7) = byte 1
        integer(value 9) = minus(integer(value 9), byte 1)
        jump 2126
    fi

    jump 2258

2126:
    if integer(value 9):
        jump 2021
    fi

    if integer(value 6):
        ('SETNAME', ('integer', [('value', 3)]))
        print('$N looks at $Y. "You haven\'t got room to carry any!"')
        wait()

        print('\n\n')
        jump 179
    fi

    if integer(value 7):
        ('SETNAME', ('integer', [('value', 3)]))
        print('"Come back when you have some gold."')
        wait()

        print('\n\n')
        jump 179
    fi

2258:
    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('multiply', [('integer', [('value', 9)]), ('byte', 4)]))
    ('NEW', ('integer', [('value', 3)]), ('byte', 129), ('byte', 0), ('integer', [('value', 9)]))
    ('SETNAME', ('integer', [('value', 3)]))

    if equals(integer(value 8), integer(value 9)):
        print('$N hands the rations to $Y.')
        wait()

        print('\n\n')
        jump 179
    fi

    print('She hands $Y #9 mutton ration\\s.')
    wait()

    print('\n\n')
    ('SETNAME', ('integer', [('value', 3)]))

    if integer(value 0):
        print('"That\'s all you can carry."')
        wait()

        print('\n\n')
        jump 179

    else:
        print('"That\'s all you can afford."')
        wait()

        print('\n\n')
        jump 179
    fi

    ('INTEGERS', [4, 4, 4], [])
    ('INTEGERS', [116, 117, 115], [])
    ('STRINGS', ['Mead', 'Ale', 'Wine'], [])

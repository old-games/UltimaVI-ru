source('CONVERSE.A')
index(84)

id(84)
name('Stivius')

description:
    print('a tiny little man with wild eyes.')
    wait()

    print('\n')

interaction:
    integer(value 5) = byte 0

    if hasBit(byte 235, value 0):
        jump label_174
    fi

    print('"Yeah. Ok. Yeah."')
    wait()

    print('\nHe looks you up and down and then claps his hands together. "Yeah. ')
    print('Ok. Yeah."\n')
    wait()

    ('SETF', ('byte', 235), ('value', 0))
    jump label_206

label_174:
    print('"Back for some more wine?"\n')
    jump label_232

label_206:
    print('\n"What can I do you for?"\n')

label_232:
    ask()

    case 'name':
        print('"@Stivius the wine merchant is mine."\n')
        jump label_232

    case 'stiv':
        print('"Quite a name, eh?"\n')
        jump label_232

    case 'job':
        print('"I make @wine."')

    case 'buy':
    case 'merc':
    case 'wine':
        print('"Yeah. Maybe you want to buy some."\n*\n')
        jump label_2676

    case 'ghos':
        print('"It\'s not just a @tale you\'ve been hearing."\n')
        jump label_232

    case 'tale':
        print('"Everyone knows that @Quenton haunts this town."')
        wait()

        print('\n\n"If I had been @murdered by those evil ones...but that\'s just ')
        print('gossip."\n')
        jump label_232

    case 'murd':
    case 'ones':
        print('"It was late one night and I had just returned from my fields."')
        wait()

        print('\n\n"\'Course my path takes me right by @Gideon\'s garden."')
        wait()

        print('\n"I heard a @noise by the well and saw some @dark forms hunched ')
        print('there."')
        wait()

        print('\n\n"They had huge wings and @evil red eyes."')
        wait()

        print('\n\n"I ran like the wind to my doorway. I was sure I was dead."\n')
        jump label_232

    case 'quen':
        print('"He was a nice enough soul. I sold many bottles to him."\n')
        jump label_232

    case 'gard':
    case 'gide':
        print('"Gideon runs the Haunting @Inn."')
        wait()

        print('\n\n"His @wife has a garden which you can see from my front door."\n')
        jump label_232

    case 'haun':
    case 'inn':
        print('"It\'s the Inn straight across the lane from here."\n')
        jump label_232

    case 'wife':
        print('"She doesn\'t do much. Helps him run the place."\n')
        jump label_232

    case 'nois':
        print('"Twas a strange @whispering, in a tongue I could not understand."\n')
        jump label_232

    case 'stra':
    case 'tong':
    case 'whis':
        print('"It didn\'t sound like any language I ever heard."')
        wait()

        print('\n\n"More like one o\' them guild @languages."\n')
        jump label_232

    case 'guil':
    case 'lang':
        print('"Like the one the @alchemist speaks."\n')
        jump label_232

    case 'alch':
        print('"Go ask old @Horance. He can tell ya - if you can understand him!"\n')
        jump label_232

    case 'hora':
        print('"He lives over on @Ivers Rounding by himself.\n')
        jump label_232

    case 'iver':
    case 'roun':
        print('"You must be new to this village."')
        wait()

        print('\n"Go see @Marney, she\'ll get you there."\n')
        jump label_232

    case 'marn':
        print('"She\'s the daughter of @Quenton - the ghost."\n')
        jump label_232

    case 'dark':
    case 'form':
        print('"I couldn\'t see too clearly. They were about man-@sized though."\n')
        jump label_232

    case 'man':
    case 'size':
        print('"Yes, but they were hunched down so it was hard to see them."\n')
        jump label_232

    case 'evil':
    case 'eyes':
    case 'huge':
    case 'red':
    case 'wing':
        print('His eyes widen. "@Gargoyles they were!"')
        wait()

        print('\n\n"Must\'a been ten or @twelve of \'em."\n')
        jump label_232

    case 'ten':
    case 'twel':
        print('"Well, perhaps more like two or three."')
        wait()

        print('\n\n"I didn\'t stay around and count \'em."\n')
        jump label_232

    case 'garg':
        print('"Yes. Big, ugly, snarling beasts."')
        wait()

        print('\n"\'Course, they were @kneeling when I saw \'em."\n')
        jump label_232

    case 'knee':
        print('"You know, on their knees."\n')
        jump label_232

    case 'bell':
    case 'tren':
        print('"I don\'t care much for him. He\'s always trying to get me to sell him ')
        print('my wine cheaper."\n')
        jump label_232

    case 'deza':
        print('"She\'s my sweetie."')
        wait()

        print('\n\nHe clasps his hands next to his cheek. "I count the hours until I ')
        print('can see her."\n')
        jump label_232

    case 'mich':
        print('"I have never talked to him. He bought wine from me once but that\'s ')
        print('it."\n')
        jump label_232

    case 'brit':
    case 'lord':
        print('"Well, what\'s to say? I am glad he is again our ruler."\n')
        jump label_232

    case 'bye':
        print('"Come back if you get thirsty."\n')
        bye()

    case '*':
        print('"Ask someone else about that."\n')
    esac

    jump label_232

label_2676:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 1
        jump label_2822
    fi

label_2696:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_2710:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_2710
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump label_3296
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_2696
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_2822:
    integer(value 0) = byte 1

label_2829:
    string(value 0) = data(dword 3388, minus(integer(value 0), byte 1))
    print('#0. $0\n')
    integer(value 0) = plus(integer(value 0), byte 1)

    if less(integer(value 0), byte 7):
        jump label_2829
    fi

    print('"Which item?" ')
    ('INPUTNUM', 0)

    if equals(integer(value 0), byte 0):
        jump label_3296
    fi

    if greater(integer(value 0), byte 6):
        jump label_2822
    fi

    integer(value 0) = minus(integer(value 0), byte 1)
    ('SETNAME', ('integer', [('value', 3)]))
    string(value 0) = data(dword 3388, integer(value 0))
    integer(value 1) = data(dword 3364, integer(value 0))
    print('$N smiles at $Y. "For $0 it will cost you #1 gold. Interested?" ')

    choice('yn')

    case 'n':
        jump label_2822

    case 'y':
    esac

    if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(dword 3376, integer(value 0)), byte 1)):
        print('"You look pretty full to me."')
        wait()

        print('\n')
        jump label_206
    fi

    if greaterOrEquals(objectsCount(integer(value 3), byte 88), data(dword 3364, integer(value 0))):
        ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('data', [('dword', 3364), ('integer', [('value', 0)])]))
        ('NEW', ('integer', [('value', 3)]), ('data', [('dword', 3376), ('integer', [('value', 0)])]), ('byte', 0), ('byte', 1))
        print('"Excellent!" After accepting $Y\'s gold, $N hands over the wine.')
        wait()

        print('\n')
        integer(value 5) = byte 1
        string(value 1) = data(dword 3388, integer(value 0))
        print('\n')
        jump label_2822

    else:
        print('$N looks at $Y. "You don\'t have enough gold."')
        wait()

        print('\n')
        jump label_206
    fi

label_3296:
    if integer(value 5):
        print('"Enjoy your $1."')
        wait()

        print('\n')
        jump label_206
    fi

    print('"Too bad, it\'s really good wine."')
    wait()

    print('\n')
    jump label_206

integers_3364 = [
    10,  // 0
    20,  // 1
    30,  // 2
    40,  // 3
    100, // 4
    100, // 5
]

integers_3376 = [
    115, // 0
    115, // 1
    115, // 2
    115, // 3
    115, // 4
    115, // 5
]

strings_3388 = [
    'White Wine', // 0
    'Red Wine',   // 1
    'Dry Wine',   // 2
    'Sweet Wine', // 3
    'Skara Red',  // 4
    'Skara Dry',  // 5
]

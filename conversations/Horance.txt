source("CONVERSE.A")
index(88)

id(88)
name("Horance")

description:
    print("a bent, aging man with a scraggly beard and few teeth.")

    f3()

interaction:
    if hasBit(byte 235, byte 7):
    print("\n\"Once they came for wanting,")
    wait()

    print("\nTwice they came to see,")
    wait()

    print("\nIf I am relenting,")
    wait()

    print("\nIn my mystery.\"")

    else:
    print("\n\"Dogs are at my doorstep,")
    wait()

    print("\nYapping at my heels.")
    wait()

    print("\nNo way to ignore them.")
    wait()

    print("\nJust pretend that they are eels.\"")
    ('SETF', ('byte', 235), ('byte', 7))

    endif

    print("\n")

    ask()
    case "buy,reag":
    print("The mention of business brings the senile man to his senses ")
    print("momentarily.")
    wait()

    print("\n\n")
    jump 3940

    case "lear,spel":
    print("The mention of business brings the senile man to his senses ")
    print("momentarily.")
    wait()

    print("\n\n")
    jump 2840

    case "magi,book,sell":
    print("The mention of business brings the senile man to his senses ")
    print("momentarily.")
    wait()

    print("\n\n")
    jump 4713

    case "name":
    print("\"Names I'm always thinking,")
    wait()

    print("\nNames I always see.")
    wait()

    print("\nHave you any inkling")
    wait()

    print("\nWhat they seem to mean?\"")
    jump 280

    case "job":
    print("\"I have nice @reagents,")
    wait()

    print("\nAlso wondrous @spells.")
    wait()

    print("\nIf you need a magic @book,")
    wait()

    print("\nThose I also sell.\"")
    jump 280

    case "hora,tubl":
    print("\"That is too familiar,")
    wait()

    print("\nCould it be a friend?")
    wait()

    print("\nNo, none is delivered,")
    wait()

    print("\nSo I must pretend.\"")
    ('SETF', ('byte', 235), ('value', 0))
    jump 280

    case "kill,murd":
    print("\"'Step into my parlor,'")
    wait()

    print("\nSaid the spider to the fly.")
    wait()

    print("\nPerhaps if he could holler,")
    wait()

    print("\nHe would not have to die.\"")
    jump 280

    case "relt,rent":
    print("\"Many are pretenders,")
    wait()

    print("\nA harmless game they play.")
    wait()

    print("\nBut for the few offenders,")
    wait()

    print("\nOf constant night they pray.\"")
    jump 280

    case "ghos":
    print("He purses his lips and lets out an eery, high-pitched cry.")
    wait()

    print("\n\n\"That is my impression.")
    wait()

    print("\nTell me what you think.")
    wait()

    print("\nCan you learn a lesson,")
    wait()

    print("\nFrom what it has to teach?\"")
    jump 280

    case "burm,shav":
    print("\"Don't stick your arm")
    wait()

    print("\nOut too far.")
    wait()

    print("\nIt may go home")
    wait()

    print("\nIn another car!\"")
    wait()

    print("\n-- Burma Shave.")
    jump 280

    case "quen":
    print("\"Ask about a traitor,")
    wait()

    print("\nAsk about a love,")
    wait()

    print("\nAnd if you are creative,")
    wait()

    print("\nAsk above the dove.\"")
    jump 280

    case "garg":
    print("\"What is truly fearsome,")
    wait()

    print("\nWhat can evil be?")
    wait()

    print("\nNot all that growls is gruesome,")
    wait()

    print("\nNot all that hates has wings.\"")
    jump 280

    case "moon,gate,shri":
    print("\"Through a glowing door,")
    wait()

    print("\nBy the full moons' light.")
    wait()

    print("\nFor me to tell you more")
    wait()

    print("\nWould take us half the night!\"")
    jump 280

    case "tren,bell":
    print("\"He who has opinions,")
    wait()

    print("\nThinks he knows it all,")
    wait()

    print("\nWill someday end up learning")
    wait()

    print("\nWhat comes before a fall.\"")
    jump 280

    case "yorl":
    print("\"Simple has its moment")
    wait()

    print("\nAnd often is received")
    wait()

    print("\nMuch better than the brilliant,")
    wait()

    print("\nWho often will deceive.\"")
    jump 280

    case "mich":
    print("\"Pain can run so deeply")
    wait()

    print("\nThat one becomes a mute,")
    wait()

    print("\nIn fear of leading others")
    wait()

    print("\nWhere goodness is in dispute.\"")
    jump 280

    case "gide":
    print("\"Kindness is a proverb")
    wait()

    print("\nThat all can understand,")
    wait()

    print("\nAnd those who share it with you")
    wait()

    print("\nWill oft be in demand.\"")
    jump 280

    case "stiv":
    print("\"Little is the difference,")
    wait()

    print("\nThat seperates ourselves.")
    wait()

    print("\nRemembering this inference,")
    wait()

    print("\nIs oft a great challenge.\"")
    jump 280

    case "marn":
    print("\"Love has many rivers,")
    wait()

    print("\nYet grief can twist them all.")
    wait()

    print("\nBe guided by your wisdom,")
    wait()

    print("\nAnd you'll achieve the goal.\"")
    jump 280

    case "lord,brit":
    print("\"A council has a purpose,")
    wait()

    print("\nAnd yet it can be wrong.")
    wait()

    print("\nThere are no notes that singly")
    wait()

    print("\nPut the melody in a song.\"")
    jump 280

    case "bye":
    print("\"I see that they are going,")
    wait()

    print("\nI'm sure they will return.")
    wait()

    print("\nFor if they lack the knowing,")
    wait()

    print("\nThey'll always need to learn.\"\n")
    bye()

    case "*":
    print("\"I hear you have a question.")
    wait()

    print("\nI'm here to answer some.")
    wait()

    print("\nIf I may make suggestions,")
    wait()

    print("\nPlease ask another one.\"")
    jump 280

2840:
    if greater(integer(value 23), byte 0):
    integer(value 1) = byte 0
    integer(value 2) = byte 0
    integer(value 4) = byte 0
    jump 2938

    endif

    integer(value 3) = character(byte 0, byte 0)

    if hasObject(integer(value 3), byte 57, byte 0):
    jump 3236

    else:
    print("\"But thou hast not a spell@book!\"")
    jump 280

    endif

2938:
    if greater(integer(value 1), integer(value 23)):
    jump 3052

    endif

    integer(value 3) = character(integer(value 1), byte 0)

    if equals(hasObject(integer(value 3), byte 57, byte 0), byte 0):
    jump 3037

    endif

    if equals(integer(value 4), byte 0):
    integer(value 4) = integer(value 3)
    integer(value 2) = plus(integer(value 2), byte 1)
    jump 3037

    endif

    ('SETNAME', ('integer', [('value', 4)]))
    print("#2) $Y\n")
    integer(value 2) = plus(integer(value 2), byte 1)
    integer(value 4) = integer(value 3)
    integer(value 1) = plus(integer(value 1), byte 1)
    jump 2938

3052:
    if equals(integer(value 2), byte 0):
    print("\"But none of you has a spell@book!\"")
    jump 280

    endif

    if equals(integer(value 2), byte 1):
    integer(value 3) = integer(value 4)
    jump 3236

    endif

    ('SETNAME', ('integer', [('value', 4)]))
    print("#2) $Y\n\"Which of you?\" ")
    ('INPUTNUM', 2)

    if equals(integer(value 2), byte 0):
    jump 281

    endif

    integer(value 1) = byte 0
    integer(value 3) = character(integer(value 1), byte 0)

    if hasObject(integer(value 3), byte 57, byte 0):
    integer(value 2) = minus(integer(value 2), byte 1)

    endif

    if equals(integer(value 2), byte 0):
    jump 3236

    endif

    integer(value 1) = plus(integer(value 1), byte 1)

    if lessOrEquals(integer(value 1), integer(value 23)):
    jump 3170

    endif

3236:
    ('SETNAME', ('integer', [('value', 3)]))
    integer(value 1) = level(integer(value 3), byte 0)
    string(value 1) = data(dword 5226, integer(value 1))
    print("\"In which Circle does $Y wish to study?\" ")
    ('INPUTNUM', 0)

    if equals(integer(value 0), byte 0):
    jump 280

    endif

    if greater(integer(value 0), byte 8):
    print("\"As everybody knows, there are only eight circles.\"")
    wait()

    print("\n\n")
    jump 3236

    endif

    if greater(integer(value 0), integer(value 1)):
    print("\"I sense that $Y is only ready for the #1$1 Circle.\"")
    wait()

    print("\n\n\"But such matters are not my concern...\"")
    wait()

    print("\n\n")

    endif

    integer(value 0) = minus(integer(value 0), byte 1)
    integer(value 0) = multiply(integer(value 0), byte 10)

    if equals(data(dword 5253, integer(value 0)), byte 0):
    print("\"I have no spells of that circle.\"")
    wait()

    print("\n\n")
    jump 3236

    endif

    integer(value 2) = byte 1
    string(value 0) = data(dword 5413, minus(plus(integer(value 0), integer(value 2)), byte 1))
    print("#2) $0\n")
    integer(value 2) = plus(integer(value 2), byte 1)

    if greater(data(dword 5253, minus(plus(integer(value 0), integer(value 2)), byte 1)), byte 0):
    jump 3576

    endif

    print("\"Which of these?\" ")
    ('INPUTNUM', 4)

    if or(equals(integer(value 4), byte 0), greaterOrEquals(integer(value 4), integer(value 2))):
    print("\"Perhaps $Y is not ready for this circle.\"")
    wait()

    print("\n\n")
    jump 3236

    endif

    integer(value 4) = minus(integer(value 4), byte 1)
    integer(value 5) = plus(byte 30, multiply(integer(value 0), byte 3))

    if less(objectsCount(integer(value 3), byte 88), integer(value 5)):
    print("\"$Y lacks the #5 gold required.\"")
    wait()

    print("\n\n")
    jump 3236

    endif

    print("\"That spell costs #5 gold. Interested?\" ")

    askc("yn")
    case "y":
    print("$N hands $Y a piece of rune-covered parchment.")
    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 5)]))
    ('NEW', ('integer', [('value', 3)]), ('byte', 58), ('data', [('dword', 5253), ('plus', [('integer', [('value', 0)]), ('integer', [('value', 4)])])]), ('byte', 1))
    wait()

    print("\n\n")
    jump 3236

    case "n":
    jump 3236

3940:
    if greater(integer(value 23), byte 0):
    integer(value 1) = byte 0
    integer(value 2) = byte 1
    integer(value 4) = byte 0
    jump 3989

    endif

    integer(value 3) = character(byte 0, byte 0)
    jump 4091

3989:
    integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)
    ('SETNAME', ('integer', [('value', 3)]))
    print("#2) $Y\n")

    if lessOrEquals(integer(value 2), integer(value 23)):
    integer(value 2) = plus(integer(value 2), byte 1)
    jump 3989

    endif

    print("\"Which of you?\" ")
    ('INPUTNUM', 2)

    if or(equals(integer(value 2), byte 0), greater(integer(value 2), plus(integer(value 23), byte 1))):
    jump 281

    else:
    integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)

    endif

4091:
    ('SETNAME', ('integer', [('value', 3)]))
    integer(value 1) = byte 1
    string(value 1) = data(dword 5148, minus(integer(value 1), byte 1))
    print("#1) $1\n")
    integer(value 1) = plus(integer(value 1), byte 1)

    if greater(data(dword 5116, minus(integer(value 1), byte 1)), byte 0):
    jump 4102

    endif

    print("\"Which of these?\" ")
    ('INPUTNUM', 2)

    if or(equals(integer(value 2), byte 0), greaterOrEquals(integer(value 2), integer(value 1))):
    jump 281

    endif

    integer(value 2) = minus(integer(value 2), byte 1)
    integer(value 1) = data(dword 5132, integer(value 2))
    string(value 1) = data(dword 5148, integer(value 2))
    integer(value 5) = byte 0
    print("\"$1 costs #1 per portion.\"")
    wait()

    print("\n\n\"How many dost thou want?\" ")
    ('INPUT', 4)

    if greater(integer(value 4), word 500):
    integer(value 4) = word 500

    endif

    if equals(integer(value 4), byte 0):
    jump 4091

    endif

    if less(canCarry(integer(value 3)), weight(data(dword 5116, integer(value 2)), byte 1)):
    jump 4451

    endif

    if less(objectsCount(integer(value 3), byte 88), integer(value 1)):
    jump 4582

    endif

    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 1)]))
    ('NEW', ('integer', [('value', 3)]), ('data', [('dword', 5116), ('integer', [('value', 2)])]), ('byte', 0), ('byte', 1))
    integer(value 5) = plus(integer(value 5), byte 1)

    if equals(integer(value 5), integer(value 4)):
    print("$N hands $Y the $1.")
    wait()

    print("\n\n")
    jump 4091

    else:
    jump 4329

    endif

4451:
    if integer(value 5):
    print("\"Thou cannot carry that much!\"")
    wait()

    print("\n\n\"I'll give thee #5; thou dost not need the rest.\"")
    wait()

    print("\n\n")
    jump 4091

    else:
    print("\"Thou cannot carry any $1!\"")
    wait()

    print("\n\n")
    jump 4091

    endif

4582:
    if integer(value 5):
    print("\"Thou cannot afford that much!\"")
    wait()

    print("\n\n\"I'll give thee #5; thou cannot have the rest.\"")
    wait()

    print("\n\n")
    jump 4091

    else:
    print("\"Thou cannot afford any $1!\"")
    wait()

    print("\n\n")
    jump 4091

    endif

4713:
    if greater(integer(value 23), byte 0):
    integer(value 1) = byte 0
    integer(value 2) = byte 1
    integer(value 4) = byte 0
    jump 4762

    endif

    integer(value 3) = character(byte 0, byte 0)
    jump 4864

4762:
    integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)
    ('SETNAME', ('integer', [('value', 3)]))
    print("#2) $Y\n")

    if lessOrEquals(integer(value 2), integer(value 23)):
    integer(value 2) = plus(integer(value 2), byte 1)
    jump 4762

    endif

    print("\"Which of you?\" ")
    ('INPUTNUM', 2)

    if or(equals(integer(value 2), byte 0), greater(integer(value 2), plus(integer(value 23), byte 1))):
    jump 280

    else:
    integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)

    endif

4864:
    ('SETNAME', ('integer', [('value', 3)]))

    if less(canCarry(integer(value 3)), weight(byte 57, byte 1)):
    print("\"But thou cannot carry a spellbook!\"")
    jump 280

    endif

    if less(objectsCount(integer(value 3), byte 88), byte 50):
    print("\"But thou cannot afford a spellbook!\"")
    jump 280

    endif

    print("\"A spellbook costs 50 gold pieces. Interested?\" ")

    askc("yn")
    case "y":
    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('byte', 50))
    ('NEW', ('integer', [('value', 3)]), ('byte', 57), ('byte', 0), ('byte', 1))
    jump 280

    case "n":

    if integer(value 23):
    print("\"Perhaps one of thy friends then.\"")
    wait()

    print("\n\n")
    jump 4713

    else:
    jump 280

    endif

5116:
    ['INTEGERS', [65, 66, 69, 70, 71, 72, 0, 0]]

5132:
    ['INTEGERS', [3, 3, 5, 2, 1, 2, 0, 0]]

5148:
    ['STRINGS', ['Black Pearl', 'Blood Moss', 'Mandrake Root', 'Nightshade', 'Spider Silk', 'Sulfurous Ash', ' ', ' ']]

5226:
    ['STRINGS', ['th', 'st', 'nd', 'rd', 'th', 'th', 'th', 'th', 'th']]

5253:
    ['INTEGERS', [5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 17, 18, 22, 23, 0, 0, 0, 0, 0, 0, 32, 34, 0, 0, 0, 0, 0, 0, 0, 0, 50, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65, 68, 69, 0, 0, 0, 0, 0, 0, 0, 83, 84, 87, 0, 0, 0, 0, 0, 0, 0, 96, 98, 101, 102, 104, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

5413:
    ['STRINGS', ['Harm', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'Magic Arrow', 'Poison', 'Trap', 'Unlock Magic', ' ', ' ', ' ', ' ', ' ', ' ', 'Curse', 'Fireball', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'Disable', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'Explosion', 'Lightning', 'Paralyze', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'Flame Wind', 'Hail Storm', 'Poison Wind', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'Chain Bolt', 'Energy Wind', 'Kill', 'Mass Curse', 'Wing Strike', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']]

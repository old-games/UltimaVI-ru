source('CONVERSE.A')
index(23)

id(23)
name('Rufus')

description:
    print('a rough and tumble man with wild, unkempt hair.')
    wait()

    print('\n')

interaction:
    integer(value 5) = byte 0

    if equals(integer(value 32), byte 144):
        jump label_229
    fi

    print('"Aye, and a fine $T to you, my friend')

    if integer(value 23):
        print('s')
    fi

    print('."')
    wait()

    print('\n\n"I\'m busy just now. Why don\'t ya come t\'my smithy ')

    if greater(integer(value 17), byte 18):
        print('tomorrow ')

    else:
        print('later today ')
    fi

    print('and we\'ll talk then."\n')
    bye()

label_229:
    if hasBit(byte 235, value 0):
        jump label_278
    fi

    print('"Good $T, friend')

    if integer(value 23):
        print('s')
    fi

    print('."')
    setBit(byte 235, value 0)
    wait()

    print('\n')
    jump label_340

label_278:
    print('"\'Tis good to see thee, friend!" he says, grabbing your arm.')
    wait()

    print('\n')

label_340:
    print('\n"What d\'ya need?"\n')

label_359:
    ask()

    case 'name':
        print('"Rufus the @Red."\n')
        jump label_359

    case 'red':
    case 'rufu':
        print('"Can ya not tell by my hair?"\n')
        jump label_359

    case 'buy':
        jump label_649

    case 'job':
        print('"If you want to @buy horseshoes, just ask."\n')
        jump label_359

    case 'bye':
    case 'noth':
        print('"Remember to shoe yer steed often. Bye."\n')
        bye()

    case 'shoe':
        print('"Aye, it saves their feet from stones and such."\n')
        jump label_359

    case '*':
        print('"I just @shoe horses, sorry."\n')
    esac

    jump label_359

label_649:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 0
        jump label_785
    fi

label_669:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_683:
    look(character(integer(value 0), byte 0))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_683
    fi

    print('"Which of you?" ')
    inputInteger(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_1092
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_669
    fi

label_785:
    print('"It\'ll cost you 2 gold for the horseshoes. Interested?" ')

    choice('yn')

    case 'y':
        if less(plus(canCarry(character(integer(value 3), byte 0)), weight(byte 88, byte 2)), weight(byte 202, byte 1)):
            print('"You look pretty full to me."')
            wait()

            print('\n')
            jump label_340
        fi

        if greaterOrEquals(objectsCount(character(integer(value 3), byte 0), byte 88), byte 2):
            destroyItem(character(integer(value 3), byte 0), byte 88, byte 0, byte 2)
            createItem(character(integer(value 3), byte 0), byte 202, byte 0, byte 1)
            look(character(integer(value 3), byte 0))
            print('"Good, good!" After accepting $Y\'s gold, $N hands over the horseshoes.')
            wait()

            integer(value 5) = byte 1
            print('\n\n')
            jump label_1092

        else:
            look(character(integer(value 3), byte 0))
            print('"You haven\'t enough gold!"')
            wait()

            print('\n')
            jump label_340
        fi

    case 'n':
        jump label_1092
    esac

label_1092:
    if integer(value 5):
        print('"Those shoes will last ya."')
        wait()

        print('\n')
        jump label_340
    fi

    print('"You\'ll find none stronger."')
    wait()

    print('\n')
    jump label_340

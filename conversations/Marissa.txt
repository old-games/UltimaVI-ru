source('CONVERSE.B')
index(3)

id(102)
name({
    'english': 'Marissa',
    'russian': 'Марисса'
})

description:
    print({
        'english': 'a finely adorned woman with a tight mouth and wide eyes.',
        'russian': 'изысканно одетую женщину с поджатыми губами и большими глазами.'
    })
    wait()

    print({
        'english': '\n',
        'russian': '\n'
    })

interaction:
    if notEquals(integer(value 32), byte 144):
        jump label_137
    fi

    if hasBit(byte 235, value 0):
        print({
            'english': '"Hello again."',
            'russian': '"И снова здравствуйте".'
        })

    else:
        print({
            'english': '"Hello."',
            'russian': '"Здравствуйте".'
        })
    fi

    print({
        'english': ' She bows formally.\n',
        'russian': ' Она торжественно кланяется.\n'
    })
    jump label_283

label_137:
    print({
        'english': 'She bows stiffly. "I\'m sorry, good ',
        'russian': 'Она кланяется с холодными видом. "Прошу прощения, '
    })

    if integer(value 16):
        print({
            'english': 'madam',
            'russian': 'мадам'
        })

    else:
        print({
            'english': 'sir',
            'russian': 'сэр'
        })
    fi

    print({
        'english': ', but my shop is closed for now."',
        'russian': ', но моя лавка сейчас закрыта".'
    })
    wait()

    print({
        'english': '\n\n"See me some other time, when I am available for business."\n',
        'russian': '\n\n"Приходите в другой раз, когда я буду работать".\n'
    })
    bye()

label_283:
    ask()

    case 'name':
    case {'russian': 'имя'}:
        print({
            'english': '"Marissa. You may call me \'@Miss Trihune."\n',
            'russian': '"Марисса. Можете звать меня \'@мисс Трихун\'".\n'
        })
        setBit(byte 235, value 0)
        jump label_283

    case 'miss':
    case {'russian': 'мисс'}:
    case 'trih':
    case {'russian': 'трих'}:
        print({
            'english': '"Yes, that is much better."\n',
            'russian': '"Да, так намного лучше".\n'
        })
        jump label_283

    case 'buy':
    case {'russian': 'куп'}:
    case 'tuni':
    case {'russian': 'туни'}:
    case 'dres':
    case {'russian': 'плат'}:
    case 'pant':
    case {'russian': 'штан'}:
    case 'clot':
    case {'russian': 'одеж'}:
        jump label_1892

    case 'sell':
    case {'russian': 'прод'}:
        jump label_2550

    case 'silk':
    case {'russian': 'шёлк'}:
        print({
            'english': '"Yes, I can work with silk. But \'tis out of fashion..."',
            'russian': '"Да, я могу работать с шёлком. Но он вышел из моды..."'
        })
        wait()

        print({
            'english': '\n\n"Nobody wears silk clothes this season."\n',
            'russian': '\n\n"В этом сезоне никто не носит шёлковую одежду".\n'
        })
        jump label_283

    case 'arbe':
    case {'russian': 'арбе'}:
        print({
            'english': '"Oh, he\'s a threadmaker who lives here in town."',
            'russian': '"Хм, это местный ниточник".'
        })
        wait()

        print({
            'english': '\n\n"Silly little man, but a fine spinner."',
            'russian': '\n\n"Пугливый мужичонка, но своё дело знает".'
        })
        wait()

        print({
            'english': '\n\n"I get all my thread straight from him. No other source would do."\n',
            'russian': '\n\n"Именно он поставляет мне нитки. Никто другой бы не справился".\n'
        })
        jump label_283

    case 'bolt':
    case {'russian': 'руло'}:
        print({
            'english': '"Yes, that silly Arbeth person can spin spidersilk into thread."',
            'russian': '"Да, этот глупыш Арбет может делать нить из паучьего шёлка".'
        })
        wait()

        print({
            'english': '\n\n"Charlotte, from New Magincia, weaves thread into silk cloth."',
            'russian': '\n\n"Шарлотта из Новой Маджинсии плетёт шёлковую ткань из нитей".'
        })
        wait()

        print({
            'english': '\n\n"Bring me a bolt of her finest silk cloth, and then I can sew you a ',
            'russian': '\n\n"Принесите мне рулон её ткани из тончайшего шёлка, и тогда я смогу сшить '
        })
        print({
            'english': 'silk bag."\n',
            'russian': 'шёлковый мешок".\n'
        })
        jump label_283

    case 'ball':
    case {'russian': 'бал'}:
    case 'mamm':
    case {'russian': 'мам'}:
    case 'bag':
    case {'russian': 'меш'}:
    case 'plan':
    case {'russian': 'черт'}:
        print({
            'english': '"Oh, I understand. A large silk bag."',
            'russian': '"Понятно. Большой шёлковый мешок".'
        })
        wait()

        print({
            'english': '\n\n"Well, \'tis hardly a challenge for one of my skills. But, since it ',
            'russian': '\n\n"Хорошо, звучит, как пустяк, чтобы за это браться человеку с моими навыками. Но раз уж '
        })
        print({
            'english': 'is important, I\'ll do it."',
            'russian': 'это важно, то я займусь этим".'
        })
        wait()

        print({
            'english': '\n\n',
            'russian': '\n\n'
        })

        if equals(partyHasObject(word 270, byte 0), word 32769):
            print({
                'english': '"But I\'ll need to see the plans."\n',
                'russian': '"Но мне нужно взглянуть на чертежи".\n'
            })
            jump label_283
        fi

        integer(value 0) = partyHasObject(byte 241, byte 0)

        if equals(integer(value 0), word 32769):
            print({
                'english': '"But I\'ll need a @bolt of silk to do it, of course."\n',
                'russian': '"Разумеется, мне понадобится @рулон шёлка для этого".\n'
            })
            jump label_283
        fi

        jump label_1477

    case 'job':
    case {'russian': 'раб'}:
        print({
            'english': '"I create garments of the highest @fashion."\n',
            'russian': '"Я создаю предметы одежды высокой @моды".\n'
        })
        jump label_283

    case 'high':
    case {'russian': 'выс'}:
    case 'fash':
    case {'russian': 'мод'}:
        print({
            'english': '"Clothes fit to see the King in."\n',
            'russian': '"Это одежда, в которой не стыдно показаться королю".\n'
        })
        jump label_283

    case 'bye':
    case {'russian': 'пока'}:
        print({
            'english': '"Yes, well, come see me again." She yawns widely.\n',
            'russian': '"Хорошо, приходите ещё". Она зевает с широко открытым ртом.\n'
        })
        bye()

    case '*':
        if random(byte 0, byte 1):
            print({
                'english': '"Hmph! I am not a gossip, $G."\n',
                'russian': '"Хм! Я не какая-то там сплетница, $G".\n'
            })

        else:
            print({
                'english': '"\'Tis not my place to speak of that..."\n',
                'russian': '"Мне не пристало об этом говорить..."\n'
            })
        fi

        jump label_283
    esac

    // Unreachable code!
    jump label_283

label_1477:
    print({
        'english': '"But it will cost you 75 gold. Alright?" ',
        'russian': '"Это стоит 75 золотых. Покупаете?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        if less(objectsCount(integer(value 0), byte 88), byte 75):
            look(integer(value 0))
            print({
                'english': '"Come back when you have the gold, $Y."\n',
                'russian': '"Возвращайтесь, когда раздобудете золото, $Y".\n'
            })
            jump label_283
        fi

        destroyItem(integer(value 0), byte 88, byte 0, byte 75)
        destroyItem(integer(value 0), byte 241, byte 0, byte 1)
        print({
            'english': 'She takes the silk cloth and begins to work, following the balloon ',
            'russian': 'Она берёт шёлковую ткань и принимается за работу, следуя чертежам '
        })
        print({
            'english': 'plans.',
            'russian': 'воздушного шара.'
        })
        wait()

        print({
            'english': '\n\nShe works in silence, intent on her sewing.',
            'russian': '\n\nОна трудится в тишине, сосредоточившись на шитье.'
        })
        wait()

        print({
            'english': '\n\nAfter a while, she completes the silk bag.',
            'russian': '\n\nСпустя некоторое время она заканчивает работу над шёлковым мешком.'
        })
        wait()

        print({
            'english': '\n\n"There, \'tis done!" she cries, handing you the bag.\n',
            'russian': '\n\n"Вот, готово!" - восклицает она, передавая вам мешок.\n'
        })
        createItem(integer(value 0), word 421, byte 0, byte 1)
        jump label_283

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Very well," she sniffs, offended.\n',
            'russian': '"Замечательно", - фыркает она обиженно.\n'
        })
        jump label_283
    esac

label_1892:
    if equals(integer(value 23), byte 0):
        integer(value 3) = character(byte 0, byte 0)
        jump label_2080
    fi

label_1915:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1929:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': '#2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1929
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        print({
            'english': '"Suit yourself," she sniffs, offended.\n',
            'russian': '"Как пожелаете", - фыркает она обиженно.\n'
        })
        jump label_283
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1915
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_2080:
    print({
        'english': '1. Tunic\n2. Dress\n3. Pants\n"Which one?" ',
        'russian': '1. Туника\n2. Платье\n3. Штаны\n"Что именно?" '
    })
    inputDigit(integer(value 0))

    if or(less(integer(value 0), byte 1), greater(integer(value 0), byte 3)):
        print({
            'english': '\n\n',
            'russian': '\n\n'
        })
        jump label_2080
    fi

    integer(value 0) = minus(integer(value 0), byte 1)
    integer(value 1) = data(integers_3258, integer(value 0))
    string(value 0) = data(strings_3270, integer(value 0))
    print({
        'english': '"It\'ll cost you #1 gold for that $0. Interested?" ',
        'russian': '"$0 стоит #1 золотых. Договорились?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(integers_3264, integer(value 0)), byte 1)):
            print({
                'english': '"You look pretty full to me."\n',
                'russian': '"Кажется, ваш рюкзак перегружен".\n'
            })
            jump label_283
        fi

        if greaterOrEquals(objectsCount(integer(value 3), byte 88), data(integers_3258, integer(value 0))):
            destroyItem(integer(value 3), byte 88, byte 0, data(integers_3258, integer(value 0)))
            createItem(integer(value 3), data(integers_3264, integer(value 0)), byte 0, byte 1)
            look(integer(value 3))
            print({
                'english': '"Excellent!" After accepting $Y\'s gold, $N hands over the $0.\n',
                'russian': '"Отлично!" Взяв золото у персонажа $Y, $N передаёт предмет $0.\n'
            })
            jump label_283

        else:
            look(integer(value 3))
            print({
                'english': '$N looks at $Y. "How rude! Don\'t ask for something you can\'t pay for!"',
                'russian': '$N смотрит на персонажа $Y. "Как грубо! Нельзя просить то, что не можешь себе позволить!"'
            })
            print({
                'english': '\n',
                'russian': '\n'
            })
            jump label_283
        fi

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Suit yourself," she sniffs, offended.\n',
            'russian': '"Как пожелаете", - фыркает она обиженно.\n'
        })
        jump label_283
    esac

label_2550:
    integer(value 0) = byte 0
    integer(value 2) = byte 0
    integer(value 3) = byte 0

label_2571:
    integer(value 1) = byte 0

label_2578:
    if objectsCount(character(integer(value 0), byte 0), byte 185):
        data(integers_3242, integer(value 2)) = integer(value 0)
        integer(value 2) = plus(integer(value 2), byte 1)
        integer(value 3) = byte 1
        jump label_2647
    fi

    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), byte 7):
        jump label_2578
    fi

label_2647:
    integer(value 0) = plus(integer(value 0), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_2571
    fi

    if equals(integer(value 3), byte 0):
        print({
            'english': '"Sorry, none of you has anything of interest."\n',
            'russian': '"Извините, но ни у кого из вас нет ничего интересного".\n'
        })
        jump label_283
    fi

    if equals(integer(value 2), byte 1):
        integer(value 3) = character(data(integers_3242, byte 0), byte 0)
        jump label_2944
    fi

label_2759:
    integer(value 0) = byte 0
    integer(value 1) = byte 1

label_2773:
    look(character(data(integers_3242, integer(value 0)), byte 0))
    print({
        'english': '#1. $Y\n',
        'russian': '#1. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 0), integer(value 2)):
        jump label_2773
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        print({
            'english': '"Just as well. That cloth is rather shabby..."\n',
            'russian': '"Оно и к лучшему. Эта тряпка довольно изношена..."\n'
        })
        jump label_283
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greaterOrEquals(integer(value 3), integer(value 2)):
        jump label_2759
    fi

    integer(value 3) = character(data(integers_3242, integer(value 3)), byte 0)

label_2944:
    integer(value 4) = objectsCount(integer(value 3), byte 185)
    look(integer(value 3))

    if equals(integer(value 4), byte 0):
        print({
            'english': '"I don\'t see any cloth, other than what you\'re wearing!"\n',
            'russian': '"Я не вижу никакой одежды, кроме той, что уже на вас!"\n'
        })
        jump label_283
    fi

    print({
        'english': '$N turns to $Y and asks "Will you take 20 gold for that cloth?" ',
        'russian': '$N поворачивается к персонажу $Y и задаёт вопрос: "Примите ли вы 20 золотых за эту вещь?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        print({
            'english': '"Done!" She hands $Y 20 gold pieces and takes the cloth.\n',
            'russian': '"По рукам!" Она передаёт персонажу $Y 20 золотых и забирает вещь.\n'
        })
        destroyItem(integer(value 3), byte 185, byte 0, byte 1)
        createItem(integer(value 3), byte 88, byte 0, byte 20)
        jump label_283

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Just as well. That cloth is rather shabby..."\n',
            'russian': '"Оно и к лучшему. Эта тряпка довольно изношена..."\n'
        })
        jump label_283
    esac

integers_3242 = [
    0, // 0
    0, // 1
    0, // 2
    0, // 3
    0, // 4
    0, // 5
    0, // 6
    0, // 7
]

integers_3258 = [
    15, // 0
    30, // 1
    20, // 2
]

integers_3264 = [
    124, // 0
    126, // 1
    137, // 2
]

strings_3270 = [
    {
        'english': 'Smart tunic',
        'russian': 'Элегантная туника'
    }, // 0
    {
        'english': 'Fine dress',
        'russian': 'Красивое платье'
    }, // 1
    {
        'english': 'Pair of pants',
        'russian': 'Штаны'
    }, // 2
]

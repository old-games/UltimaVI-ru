source("CONVERSE.A")
index(36)

id(36)
name("Xiao")

description:
    print("a wise, scholarly woman.")
    wait()

    print("\n")

    f3()

interaction:
    print("\"Good $T, @Avatar. For what purpose hast thou come?\"\n")

88:
    ask()

    case "buy":
    case "reag":
        jump 2405

    case "lear":
    case "spel":
        jump 1105

    case "book":
        jump 3172

    case "name":
        print("\"I am Xiao.\"")
        ('SETF', ('byte', 235), ('value', 0))
        jump 87

    case "job":
        print("\"I serve on the Council of @Wizards.\"")
        wait()

        print("\n\n\"I also teach @spells and sell magical @reagents.\"")
        jump 87

    case "secr":
    case "wisp":
        print("\"Their secret is far more @powerful than anything I might teach thee.\"")
        jump 87

    case "powe":
        print("\"Truly, it would be terrible if the wrong person were to learn it.\"")
        wait()

        print("\n\n\"Only we of the Council of Wizards know the secret.\"")
        wait()

        print("\n\n\"But, since thou art the Avatar, surely it is safe for thee to learn")
        print(" it as well.\"")
        jump 87

    case "avat":
        print("\"Your example inspires us all.\"")
        jump 87

    case "coun":
    case "serv":
    case "wiza":
        print("\"'Tis our task to keep the forces of magic in @balance throughout the ")
        print("land.\"")
        wait()

        print("\n\n\"We also do what we can to promote the eight @virtues.\"")
        jump 87

    case "prom":
    case "virt":
        print("\"We created the @shrines, many years ago.\"")
        jump 87

    case "shri":
        print("\"@Thariand can tell thee more.\"")
        jump 87

    case "thar":
        print("\"He is the librarian at the @Lycaeum.\"")
        jump 87

    case "libr":
    case "lyca":
        print("\"Surely you know where the Lycaeum is.\"")
        jump 87

    case "bala":
    case "forc":
    case "magi":
        print("\"Not an easy task.\"")
        jump 87

    case "bye":
        print("\"Thou art always welcome here, Avatar.\"\n")
        bye()

    case "*":
        print("\"Perhaps you should speak of that to another.\"")
        jump 87

        // Unreachable code!

    esac

1105:
    if greater(integer(value 23), byte 0):
        integer(value 1) = byte 0
        integer(value 2) = byte 0
        integer(value 4) = byte 0
        jump 1203

    endif

    integer(value 3) = character(byte 0, byte 0)

    if hasObject(integer(value 3), byte 57, byte 0):
        jump 1501

    else:
        print("\"But thou hast not a spell@book!\"")
        jump 87

        // Unreachable code!

    endif

1203:
    if greater(integer(value 1), integer(value 23)):
        jump 1317

    endif

    integer(value 3) = character(integer(value 1), byte 0)

    if equals(hasObject(integer(value 3), byte 57, byte 0), byte 0):
        jump 1302

    endif

    if equals(integer(value 4), byte 0):
        integer(value 4) = integer(value 3)
        integer(value 2) = plus(integer(value 2), byte 1)
        jump 1302

    endif

    ('SETNAME', ('integer', [('value', 4)]))
    print("#2) $Y\n")
    integer(value 2) = plus(integer(value 2), byte 1)
    integer(value 4) = integer(value 3)

1302:
    integer(value 1) = plus(integer(value 1), byte 1)
    jump 1203

1317:
    if equals(integer(value 2), byte 0):
        print("\"But none of you has a spell@book!\"")
        jump 87

    endif

    if equals(integer(value 2), byte 1):
        integer(value 3) = integer(value 4)
        jump 1501

    endif

    ('SETNAME', ('integer', [('value', 4)]))
    print("#2) $Y\n\"Which of you?\" ")
    ('INPUTNUM', 2)

    if equals(integer(value 2), byte 0):
        jump 88

    endif

    integer(value 1) = byte 0

1435:
    integer(value 3) = character(integer(value 1), byte 0)

    if hasObject(integer(value 3), byte 57, byte 0):
        integer(value 2) = minus(integer(value 2), byte 1)

    endif

    if equals(integer(value 2), byte 0):
        jump 1501

    endif

    integer(value 1) = plus(integer(value 1), byte 1)

    if lessOrEquals(integer(value 1), integer(value 23)):
        jump 1435

    endif

1501:
    ('SETNAME', ('integer', [('value', 3)]))
    integer(value 1) = level(integer(value 3), byte 0)
    string(value 1) = data(dword 3696, integer(value 1))
    print("\"In which Circle does $Y wish to study?\" ")
    ('INPUTNUM', 0)

    if equals(integer(value 0), byte 0):
        jump 87

    endif

    if equals(integer(value 0), byte 8):
        jump 2213

    endif

    if greater(integer(value 0), byte 8):
        print("\"As everybody knows, there are only eight circles.\"")
        wait()

        print("\n\n")
        jump 1501

    endif

    if greater(integer(value 0), integer(value 1)):
        print("\"I sense that $Y is only ready for the #1$1 Circle.\"")
        wait()

        print("\n\n\"But such matters are not my concern...\"")
        wait()

        print("\n\n")

    endif

1771:
    integer(value 0) = minus(integer(value 0), byte 1)
    integer(value 5) = plus(byte 25, multiply(integer(value 0), byte 25))
    integer(value 0) = multiply(integer(value 0), byte 10)

    if equals(data(dword 3723, integer(value 0)), byte 0):
        print("\"I have no spells of that circle.\"")
        wait()

        print("\n\n")
        jump 1501

    endif

    integer(value 2) = byte 1

1867:
    string(value 0) = data(dword 3883, minus(plus(integer(value 0), integer(value 2)), byte 1))
    print("#2) $0\n")
    integer(value 2) = plus(integer(value 2), byte 1)

    if greater(data(dword 3723, minus(plus(integer(value 0), integer(value 2)), byte 1)), byte 0):
        jump 1867

    endif

    print("\"Which one?\" ")
    ('INPUTNUM', 4)

    if or(equals(integer(value 4), byte 0), greaterOrEquals(integer(value 4), integer(value 2))):
        print("\"Perhaps $Y is not ready for this circle.\"")
        wait()

        print("\n\n")
        jump 1501

    endif

    integer(value 4) = minus(integer(value 4), byte 1)

    if less(objectsCount(integer(value 3), byte 88), integer(value 5)):
        print("\"$Y lacks the #5 gold required.\"")
        wait()

        print("\n\n")
        jump 1501

    endif

    print("\"That spell costs #5 gold. Interested?\" ")

    askc("yn")

    case "y":
        print("$N hands $Y a piece of rune-covered parchment.")
        ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 5)]))
        ('NEW', ('integer', [('value', 3)]), ('byte', 58), ('data', [('dword', 3723), ('plus', [('integer', [('value', 0)]), ('integer', [('value', 4)])])]), ('byte', 1))
        wait()

        print("\n\n")
        jump 1501

    case "n":
        jump 1501

        // Unreachable code!

    esac

2213:
    if hasBit(byte 201, byte 3):
        jump 1771

    else:
        print("\"Thou art not yet ready for such knowledge.\"")
        wait()

        print("\n\n\"Seek out and speak with the @wisps, and learn their secrets.\"")
        wait()

        print("\n\n\"Then wilt thou will be prepared to enter the Eighth Circle.\"")
        jump 87

        // Unreachable code!

    endif

2405:
    if greater(integer(value 23), byte 0):
        integer(value 2) = byte 1
        jump 2440

    endif

    integer(value 3) = character(byte 0, byte 0)
    jump 2542

2440:
    integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)
    ('SETNAME', ('integer', [('value', 3)]))
    print("#2) $Y\n")

    if lessOrEquals(integer(value 2), integer(value 23)):
        integer(value 2) = plus(integer(value 2), byte 1)
        jump 2440

    endif

    print("\"Which of you?\" ")
    ('INPUTNUM', 2)

    if or(equals(integer(value 2), byte 0), greater(integer(value 2), plus(integer(value 23), byte 1))):
        jump 88

    else:
        integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)

    endif

2542:
    ('SETNAME', ('integer', [('value', 3)]))
    integer(value 1) = byte 1

2553:
    string(value 1) = data(dword 3618, minus(integer(value 1), byte 1))
    print("#1) $1\n")
    integer(value 1) = plus(integer(value 1), byte 1)

    if greater(data(dword 3586, minus(integer(value 1), byte 1)), byte 0):
        jump 2553

    endif

    print("\"Which one?\" ")
    ('INPUTNUM', 2)

    if or(equals(integer(value 2), byte 0), greaterOrEquals(integer(value 2), integer(value 1))):
        integer(value 2) = byte 1
        jump 88

    endif

    integer(value 2) = minus(integer(value 2), byte 1)
    integer(value 1) = data(dword 3602, integer(value 2))
    string(value 1) = data(dword 3618, integer(value 2))
    integer(value 5) = byte 0
    print("\"$1 costs #1 per portion.\"")
    wait()

    print("\n\n\"How many dost thou want?\" ")
    ('INPUT', 4)

    if greater(integer(value 4), word 500):
        integer(value 4) = word 500

    endif

    if equals(integer(value 4), byte 0):
        jump 2542

    endif

2782:
    if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(dword 3586, integer(value 2)), byte 1)):
        jump 2910

    endif

    if less(objectsCount(integer(value 3), byte 88), integer(value 1)):
        jump 3041

    endif

    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 1)]))
    ('NEW', ('integer', [('value', 3)]), ('data', [('dword', 3586), ('integer', [('value', 2)])]), ('byte', 0), ('byte', 1))
    integer(value 5) = plus(integer(value 5), byte 1)

    if equals(integer(value 5), integer(value 4)):
        print("$N hands $Y the $1.")
        wait()

        print("\n\n")
        jump 2542

    else:
        jump 2782

        // Unreachable code!

    endif

2910:
    if integer(value 5):
        print("\"Thou cannot carry that much!\"")
        wait()

        print("\n\n\"I'll give thee #5; thou dost not need the rest.\"")
        wait()

        print("\n\n")
        jump 2542

    else:
        print("\"Thou cannot carry any $1!\"")
        wait()

        print("\n\n")
        jump 2542

        // Unreachable code!

    endif

3041:
    if integer(value 5):
        print("\"Thou cannot afford that much!\"")
        wait()

        print("\n\n\"I'll give thee #5; thou cannot have the rest.\"")
        wait()

        print("\n\n")
        jump 2542

    else:
        print("\"Thou cannot afford any $1!\"")
        wait()

        print("\n\n")
        jump 2542

        // Unreachable code!

    endif

3172:
    if integer(value 23):
        integer(value 2) = byte 1
        jump 3204

    endif

    integer(value 3) = character(byte 0, byte 0)
    jump 3306

3204:
    integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)
    ('SETNAME', ('integer', [('value', 3)]))
    print("#2) $Y\n")

    if lessOrEquals(integer(value 2), integer(value 23)):
        integer(value 2) = plus(integer(value 2), byte 1)
        jump 3204

    endif

    print("\"Which of you?\" ")
    ('INPUTNUM', 2)

    if or(equals(integer(value 2), byte 0), greater(integer(value 2), plus(integer(value 23), byte 1))):
        jump 88

    else:
        integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)

    endif

3306:
    ('SETNAME', ('integer', [('value', 3)]))

    if less(plus(canCarry(integer(value 3)), weight(byte 88, byte 60)), weight(byte 57, byte 1)):
        print("\"But thou cannot carry a spellbook!\"")
        jump 87

    endif

    if less(objectsCount(integer(value 3), byte 88), byte 60):
        print("\"But thou cannot afford a spellbook!\"")
        jump 87

    endif

    print("\"A spellbook costs 60 gold pieces. Interested?\" ")

    askc("yn")

    case "y":
        ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('byte', 60))
        ('NEW', ('integer', [('value', 3)]), ('byte', 57), ('byte', 0), ('byte', 1))
        print("\"Here you are.\"")
        jump 87

    case "n":
        if integer(value 23):
            print("\"Perhaps one of thy friends then.\"")
            wait()

            print("\n\n")
            integer(value 2) = byte 1
            jump 3204

        else:
            jump 87

            // Unreachable code!

        endif

    esac

    [['INTEGERS', [65, 67, 68, 69, 70, 71, 72, 0]]]
    [['INTEGERS', [4, 3, 3, 6, 3, 3, 3, 0]]]
    [['STRINGS', ['Black Pearl', 'Garlic', 'Ginseng', 'Mandrake Root', 'Nightshade', 'Spider Silk', 'Sulfurous Ash']]]
    [['STRINGS', ['th', 'st', 'nd', 'rd', 'th', 'th', 'th', 'th', 'th']]]
    [['INTEGERS', [1, 3, 9, 0, 0, 0, 0, 0, 0, 0, 16, 19, 21, 25, 0, 0, 0, 0, 0, 0, 33, 35, 39, 0, 0, 0, 0, 0, 0, 0, 48, 51, 53, 54, 55, 56, 57, 0, 0, 0, 64, 67, 71, 73, 0, 0, 0, 0, 0, 0, 81, 86, 88, 0, 0, 0, 0, 0, 0, 0, 99, 100, 105, 0, 0, 0, 0, 0, 0, 0, 113, 114, 115, 116, 118, 119, 120, 121, 0, 0]]]
    [['STRINGS', ['Detect Magic', 'Dispel Magic', 'Light', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'Infravision', 'Reappear', 'Telekinesis', 'Vanish', ' ', ' ', ' ', ' ', ' ', ' ', 'Dispel Field', 'Great Light', 'Peer', '', '', '', '', '', '', '', 'Animate', 'Fire Field', 'Locate', 'Mass Dispel', 'Poison Field', 'Sleep Field', 'Wind Change', '', '', '', 'Energy Field', 'Invisibility', 'Reveal', 'X-Ray', '', '', '', '', '', '', 'Clone', 'Negate Magic', 'Replicate', '', '', '', '', '', '', '', 'Fear', 'Gate Travel', 'Wizard Eye', '', '', '', '', '', '', '', 'Death Wind', 'Eclipse', 'Mass Charm', 'Mass Kill', 'Slime', 'Summon', 'Time Stop', 'Tremor', '', '']]]

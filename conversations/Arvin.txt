source('CONVERSE.A')
index(51)

id(51)
name({
    'english': 'Arvin',
    'russian': 'FIXME Arvin'
})

description:
    print({
        'english': 'a tavernkeeper.\n',
        'russian': 'FIXME a tavernkeeper.\n'
    })

    f3()

interaction:
    integer(value 5) = byte 0

    if or(equals(integer(value 32), byte 137), equals(integer(value 32), byte 142)):
        jump label_246
    fi

    print({
        'english': 'The man looks up from his cooking. "Aye, hello there."',
        'russian': 'FIXME The man looks up from his cooking. "Aye, hello there."'
    })
    wait()

    print({
        'english': '\n\n"\'Fraid I can\'t talk now. I have to cook ',
        'russian': 'FIXME \n\n"\'Fraid I can\'t talk now. I have to cook '
    })

    if or(equals(integer(value 17), byte 13), equals(integer(value 17), byte 14)):
        print({
            'english': 'tonight\'s supper',
            'russian': 'FIXME tonight\'s supper'
        })

    else:
        print({
            'english': 'tomorrow\'s lunch',
            'russian': 'FIXME tomorrow\'s lunch'
        })
    fi

    print({
        'english': '."',
        'russian': 'FIXME ."'
    })
    wait()

    print({
        'english': '\n\n"Come back when it\'s ready and have some!"\n',
        'russian': 'FIXME \n\n"Come back when it\'s ready and have some!"\n'
    })
    bye()

label_246:
    print({
        'english': '"Welcome to the Sword and Keg."',
        'russian': 'FIXME "Welcome to the Sword and Keg."'
    })
    jump label_316

label_282:
    print({
        'english': '\n"Anything else I can do for you?"',
        'russian': 'FIXME \n"Anything else I can do for you?"'
    })

label_316:
    print({
        'english': '\n',
        'russian': 'FIXME \n'
    })

    ask()

    case {'english': 'name'}:
    case {'russian': 'FIXME name'}:
        print({
            'english': '"I be Arvin, mate."',
            'russian': 'FIXME "I be Arvin, mate."'
        })
        setBit(byte 235, value 0)
        jump label_316

    case {'english': 'buy'}:
    case {'russian': 'FIXME buy'}:
        print({
            'english': '"Which, @rolls, @ale, @mead, @wine, or @rations?"',
            'russian': 'FIXME "Which, @rolls, @ale, @mead, @wine, or @rations?"'
        })
        jump label_316

    case {'english': 'job'}:
    case {'russian': 'FIXME job'}:
        print({
            'english': '"I sell @rolls, @ale, @mead, @wine, and @rations."',
            'russian': 'FIXME "I sell @rolls, @ale, @mead, @wine, and @rations."'
        })
        jump label_316

    case {'english': 'roll'}:
    case {'russian': 'FIXME roll'}:
        jump label_1108

    case {'english': 'mead'}:
    case {'russian': 'FIXME mead'}:
        integer(value 4) = byte 0
        jump label_612

    case {'english': 'ale'}:
    case {'russian': 'FIXME ale'}:
        integer(value 4) = byte 1
        jump label_612

    case {'english': 'wine'}:
    case {'russian': 'FIXME wine'}:
        integer(value 4) = byte 2
        jump label_612

    case {'english': 'rati'}:
    case {'russian': 'FIXME rati'}:
        jump label_1556

    case {'english': 'bye'}:
    case {'russian': 'FIXME bye'}:
    case {'english': 'no'}:
    case {'russian': 'FIXME no'}:
        print({
            'english': '"See you later."\n',
            'russian': 'FIXME "See you later."\n'
        })
        bye()

    case '*':
        print({
            'english': '"I can\'t help you with that."',
            'russian': 'FIXME "I can\'t help you with that."'
        })
    esac

    jump label_316

label_612:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 0
        jump label_748
    fi

label_632:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_646:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': 'FIXME #2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_646
    fi

    print({
        'english': '"Which of you?" ',
        'russian': 'FIXME "Which of you?" '
    })
    inputInteger(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_1065
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_632
    fi

label_748:
    integer(value 1) = data(integers_2286, integer(value 4))
    print({
        'english': '"That\'ll be #1 crowns. All right?" ',
        'russian': 'FIXME "That\'ll be #1 crowns. All right?" '
    })

    choice({
        'english': 'yn',
        'russian': 'FIXME yn'
    })

    case {'english': 'y'}:
    case {'russian': 'FIXME y'}:
        jump label_823

    case {'english': 'n'}:
    case {'russian': 'FIXME n'}:
        integer(value 5) = byte 0
        jump label_1065
    esac

label_823:
    if less(objectsCount(character(integer(value 3), byte 0), byte 88), integer(value 1)):
        look(character(integer(value 3), byte 0))
        print({
            'english': '"Come back when you have some gold."',
            'russian': 'FIXME "Come back when you have some gold."'
        })
        wait()

        print({
            'english': '\n',
            'russian': 'FIXME \n'
        })
        jump label_282
    fi

    if less(plus(canCarry(character(integer(value 3), byte 0)), weight(byte 88, integer(value 1))), weight(data(integers_2292, integer(value 4)), byte 1)):
        print({
            'english': '"You don\'t have room to carry it."',
            'russian': 'FIXME "You don\'t have room to carry it."'
        })
        integer(value 5) = byte 0
        jump label_1065
    fi

    destroyItem(character(integer(value 3), byte 0), byte 88, byte 0, integer(value 1))
    createItem(character(integer(value 3), byte 0), data(integers_2292, integer(value 4)), byte 0, byte 1)
    look(character(integer(value 3), byte 0))
    integer(value 5) = byte 1
    string(value 1) = data(strings_2298, integer(value 4))
    print({
        'english': '"All right." $N gives $Y the $1.',
        'russian': 'FIXME "All right." $N gives $Y the $1.'
    })
    wait()

    print({
        'english': '\n\n',
        'russian': 'FIXME \n\n'
    })
    jump label_1065

label_1065:
    if integer(value 5):
        print({
            'english': '"Enjoy the drink, matey."',
            'russian': 'FIXME "Enjoy the drink, matey."'
        })
        wait()

        print({
            'english': '\n',
            'russian': 'FIXME \n'
        })
        jump label_282
    fi

    print({
        'english': '\n',
        'russian': 'FIXME \n'
    })
    jump label_282

label_1108:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 0
        jump label_1244
    fi

label_1128:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1142:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': 'FIXME #2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1142
    fi

    print({
        'english': '"Which of you?" ',
        'russian': 'FIXME "Which of you?" '
    })
    inputInteger(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_1502
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1128
    fi

label_1244:
    print({
        'english': '"That\'ll be 2 crowns, okay?" ',
        'russian': 'FIXME "That\'ll be 2 crowns, okay?" '
    })

    choice({
        'english': 'yn',
        'russian': 'FIXME yn'
    })

    case {'english': 'y'}:
    case {'russian': 'FIXME y'}:
        if less(objectsCount(character(integer(value 3), byte 0), byte 88), byte 2):
            look(character(integer(value 3), byte 0))
            print({
                'english': '"Come back when you have some gold."',
                'russian': 'FIXME "Come back when you have some gold."'
            })
            wait()

            print({
                'english': '\n',
                'russian': 'FIXME \n'
            })
            jump label_282
        fi

        if less(plus(canCarry(character(integer(value 3), byte 0)), weight(byte 88, byte 2)), weight(byte 130, byte 1)):
            print({
                'english': '"You don\'t have room to carry it."',
                'russian': 'FIXME "You don\'t have room to carry it."'
            })
            integer(value 5) = byte 0
            jump label_1502
        fi

        destroyItem(character(integer(value 3), byte 0), byte 88, byte 0, byte 2)
        createItem(character(integer(value 3), byte 0), byte 130, byte 0, byte 1)
        look(character(integer(value 3), byte 0))
        print({
            'english': '$N gives $Y the rolls.',
            'russian': 'FIXME $N gives $Y the rolls.'
        })
        wait()

        integer(value 5) = byte 1
        print({
            'english': '\n\n',
            'russian': 'FIXME \n\n'
        })
        jump label_1502

    case {'english': 'n'}:
    case {'russian': 'FIXME n'}:
        integer(value 5) = byte 0
        jump label_282
    esac

label_1502:
    if integer(value 5):
        print({
            'english': '"They\'re good with butter, ya know."',
            'russian': 'FIXME "They\'re good with butter, ya know."'
        })
        wait()

        print({
            'english': '\n',
            'russian': 'FIXME \n'
        })
        jump label_282
    fi

    print({
        'english': '\n',
        'russian': 'FIXME \n'
    })
    jump label_282

label_1556:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 0
        jump label_1692
    fi

label_1576:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1590:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': 'FIXME #2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1590
    fi

    print({
        'english': '"Which of you?" ',
        'russian': 'FIXME "Which of you?" '
    })
    inputInteger(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_282
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1576
    fi

label_1692:
    if or(less(plus(canCarry(character(integer(value 3), byte 0)), weight(byte 88, byte 4)), weight(byte 129, byte 1)), less(objectsCount(character(integer(value 3), byte 0), byte 88), byte 4)):
        integer(value 9) = byte 1
        jump label_1835
    fi

    print({
        'english': '"Rations are 4 gold apiece. How many do you want?" ',
        'russian': 'FIXME "Rations are 4 gold apiece. How many do you want?" '
    })
    input(integer(value 9))

    if greater(integer(value 9), word 200):
        integer(value 9) = word 200
    fi

    integer(value 8) = integer(value 9)

    if equals(integer(value 9), byte 0):
        jump label_282
    fi

    integer(value 0) = byte 0

label_1835:
    integer(value 6) = byte 0
    integer(value 7) = byte 0

    if less(plus(canCarry(character(integer(value 3), byte 0)), weight(byte 88, byte 4)), weight(byte 129, integer(value 9))):
        integer(value 6) = byte 1
        integer(value 0) = byte 1
        integer(value 9) = minus(integer(value 9), byte 1)
        jump label_1943
    fi

    if less(objectsCount(character(integer(value 3), byte 0), byte 88), multiply(integer(value 9), byte 4)):
        integer(value 7) = byte 1
        integer(value 9) = minus(integer(value 9), byte 1)
        jump label_1943
    fi

    jump label_2079

label_1943:
    if integer(value 9):
        jump label_1835
    fi

    if integer(value 6):
        look(character(integer(value 3), byte 0))
        print({
            'english': '$N looks at $Y. "You haven\'t any room in your pack."',
            'russian': 'FIXME $N looks at $Y. "You haven\'t any room in your pack."'
        })
        wait()

        print({
            'english': '\n',
            'russian': 'FIXME \n'
        })
        jump label_282
    fi

    if integer(value 7):
        look(character(integer(value 3), byte 0))
        print({
            'english': '"Come back when you have some gold."',
            'russian': 'FIXME "Come back when you have some gold."'
        })
        wait()

        print({
            'english': '\n',
            'russian': 'FIXME \n'
        })
        jump label_282
    fi

label_2079:
    destroyItem(character(integer(value 3), byte 0), byte 88, byte 0, multiply(integer(value 9), byte 4))
    createItem(character(integer(value 3), byte 0), byte 129, byte 0, integer(value 9))
    look(character(integer(value 3), byte 0))

    if equals(integer(value 8), integer(value 9)):
        look(character(integer(value 3), byte 0))
        print({
            'english': '$N hands the rations to $Y.',
            'russian': 'FIXME $N hands the rations to $Y.'
        })
        wait()

        print({
            'english': '\n',
            'russian': 'FIXME \n'
        })
        jump label_282
    fi

    print({
        'english': 'He hands $Y #9 mutton ration\\s.',
        'russian': 'FIXME He hands $Y #9 mutton ration\\s.'
    })
    wait()

    print({
        'english': '\n\n',
        'russian': 'FIXME \n\n'
    })
    look(character(integer(value 3), byte 0))

    if integer(value 0):
        print({
            'english': '"That\'s all you can carry."',
            'russian': 'FIXME "That\'s all you can carry."'
        })
        wait()

        print({
            'english': '\n',
            'russian': 'FIXME \n'
        })
        jump label_282

    else:
        print({
            'english': '"That\'s all you can afford."',
            'russian': 'FIXME "That\'s all you can afford."'
        })
        wait()

        print({
            'english': '\n',
            'russian': 'FIXME \n'
        })
        jump label_282
    fi

integers_2286 = [
    4, // 0
    3, // 1
    6, // 2
]

integers_2292 = [
    116, // 0
    117, // 1
    115, // 2
]

strings_2298 = [
    {
        'english': 'Mead',
        'russian': 'FIXME Mead'
    }, // 0
    {
        'english': 'Ale',
        'russian': 'FIXME Ale'
    }, // 1
    {
        'english': 'Wine',
        'russian': 'FIXME Wine'
    }, // 2
]

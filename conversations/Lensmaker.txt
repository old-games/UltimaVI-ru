source('CONVERSE.B')
index(71)

id(170)
name('Lensmaker')

description:
    print('a very old gargoyle.')

interaction:
    wait()

    print('\n')

    if equals(integer(value 21), byte 0):
        print('The gargoyle gasps in terror and wheezes, "An-bal-sil-fer!"')
        wait()

        print('\n\nThen he faints dead away!\n')
        ('WORKTYPE', ('byte', 235), ('byte', 145))
        bye()
    fi

    if notEquals(partyHasObject(byte 76, byte 0), byte 1):
        print('The gargoyle gasps in terror and wheezes, "The False Prophet!"')
        wait()

        print('\n\nThen he faints dead away!\n')
        ('WORKTYPE', ('byte', 235), ('byte', 145))
        bye()
    fi

    if equals(hasBit(byte 235, value 0), byte 0):
        print('The venerable gargoyle peers at you.')
        wait()

        print('\n\n"Greetings, False Prophet."')
        wait()

        print('\n\n"To have been told by @Naxatilor, long ago, that the you would one ')
        print('day come to me, wearing the Amulet of Submission."')
        wait()

        print('\n\n"To never have believed it would come to pass."')
        wait()

        print('\n\n"To ask what service I can perform?"')
        ('SETF', ('byte', 235), ('value', 0))
        jump label_805
    fi

    if equals(hasBit(byte 235, byte 2), byte 0):
        print('"To ask how again I may help you?"')
        jump label_805
    fi

    integer(value 0) = partyHasObject(word 395, byte 0)

    if equals(integer(value 0), word 32769):
        print('"To wonder why you have not brought back the broken lens?!"')
        wait()

        print('\n\n"To have already told you that I need it in order to craft a new ')
        print('one!"')
        wait()

        print('\n\n"To ask what you think I can do without it?"')
        jump label_805

    else:
        jump label_1806
    fi

label_805:
    print('\n')

    ask()

    case 'lens':
    case 'vort':
        integer(value 0) = partyHasObject(word 395, byte 0)

        if equals(integer(value 0), word 32769):
            print('"To remember little from so long ago," the gargoyle croaks.')
            wait()

            print('\n\n"To require the pieces of the lens in order to make a new copy."')
            ('SETF', ('byte', 235), ('byte', 2))
            jump label_805

        else:
            jump label_1806
        fi

    case 'name':
        print('"To lack a name, of course."')
        wait()

        print('\n\n"But to be called Lor-wis-lem, the scholar of light, by many learned')
        print(' gargoyles."')
        wait()

        print('\n\nAs he says this, the ancient gargoyle beams with pride.')
        jump label_805

    case 'job':
        print('"To craft the finest lenses in the land," the gargoyle says proudly.')
        wait()

        print('\n\n"Also to teach my young @apprentices not to cut themselves on the ')
        print('glass!"')
        jump label_805

    case 'appr':
    case 'teac':
    case 'youn':
        print('"To be nearing the end of my @time."')
        wait()

        print('\n\n"To have one last sacred duty:"')
        wait()

        print('\n\n"To pass on my skill to the next generation."')
        jump label_805

    case 'end':
    case 'time':
        print('"To be over a thousand years old."')
        wait()

        print('\n\n"To seem a mere youth compared to @Naxatilor, however."')
        jump label_805

    case 'naxa':
        print('"To have helped Naxatilor create the Vortex Lens, centuries ago."')
        wait()

        print('\n\n"To have found him venerable and ancient even then!"')
        jump label_805

    case 'bye':
        print('"To be honored to have helped you, False Prophet."\n')
        bye()

    case '*':
        print('"To be old. To suggest you ask that of others."')
        jump label_805
    esac

label_1806:
    print('"To see the shattered Vortex Lens you carry."')
    wait()

    print('\n\n"To remember making it, so very long ago."')
    wait()

    print('\n\n')
    ('DELETE', ('integer', [('value', 0)]), ('word', 395), ('byte', 0), ('byte', 1))
    print('Taking the shards of glass, the lensmaker turns to his grinding table.')
    wait()

    print('\n\nIn a short while, he has crafted a new Vortex Lens!')
    wait()

    print('\n\n"To have far greater skill now than when first I made this lens," he')
    print(' says smugly.')
    wait()

    print('\n\n"To require little time to repair it."')
    wait()

    print('\n\nHe hands you the restored Vortex Lens.')
    ('NEW', ('integer', [('value', 0)]), ('word', 396), ('byte', 0), ('byte', 1))
    ('CLEARF', ('byte', 235), ('byte', 2))
    jump label_805

source('CONVERSE.B')
index(34)

id(133)
name('Zoltan')

description:
    print('a lively soul of a gypsy, with a bit of a wild look to him.\n*')

    f3()

interaction:
    if hasBit(byte 135, byte 7):
        print('"Anyone who would mistreat a dog has no business with Zoltan."\n')
        bye()
    fi

    if equals(hasBit(byte 235, value 1), byte 0):
        jump label_414
    fi

    print('"Hah! You again! You are no friend to Zoltan."\n*\n"I dance for you, and')
    print(' how do you repay me?"\n*\n"Perhaps a few coins might ease the sting of ')
    print('your insult."\n*\nDo you give him any money? ')

    choice('yn')

    case 'y':
        jump label_4182
    esac

    print('\n"So be it. Leave me before I place a gypsy curse on you!"\n')
    bye()

label_414:
    ('CLEARF', ('byte', 235), ('byte', 7))

    if equals(hasBit(byte 235, value 0), byte 0):
        print('"Huzzah! I am @Zoltan, king of the gypsies!"')

    else:
        print('"Huzzah! I am still @Zoltan, king of the gypsies!"')
    fi

    ('SETF', ('byte', 235), ('value', 0))

label_532:
    print('\n')

    ask()

    case 'job':
    case 'name':
        print('"As I said, I am Zoltan, @king of the @gypsies!"')
        jump label_532

    case 'zolt':
        print('"Yes, Zoltan, @king of the @gypsies!"')
        jump label_532

    case 'king':
        print('"I have no lands nor @castles, as most rulers do. Nay, for I am the ')
        print('king of the open @road."')
        jump label_532

    case 'artu':
        print('"Arturos? Never heard of him."')
        jump label_532

    case 'duck':
        print('He licks his lips and smiles. "A duck? No, haven\'t seen any around ')
        print('here."')
        jump label_532

    case 'cast':
    case 'land':
        print('"You cannot tie a gypsy down to a single place."\n*\n"We are free ')
        print('@spirits, and must roam like the @wind throughout the land."')
        jump label_532

    case 'road':
        print('"The roads @wander everywhere, just like a gypsy!"')
        jump label_532

    case 'wind':
        print('"The four winds - they are gypsies too!"')
        jump label_532

    case 'roam':
    case 'wand':
        print('"As a gypsy\'s body wanders, so does his mind."\n*\n"Just now I am ')
        print('thinking of what you might @buy from me today."')
        jump label_532

    case 'free':
    case 'spir':
        print('"Aye, my spirit is free, but my @advice is not."')
        jump label_532

    case 'gyps':
        print('"Ask my people for @advice, or what they have to @sell."\n*\n"Gypsies ')
        print('see and hear much, and occasionally happen across items of ')
        print('interest..."')
        jump label_532

    case 'advi':
        jump label_2887

    case 'silv':
    case 'tabl':
        jump label_3209

    case 'hawk':
        print('"He\'s the lowest scum I ever met."')
        jump label_532

    case 'bucc':
    case 'den':
        print('"It\'s no place for an honest soul like you."\n*\n"But if you\'re ')
        print('determined to go, I hear it\'s on an island due east of @Paws."')
        jump label_532

    case 'paws':
        print('"We pass Paws often in our travels. @Taynith likes to go drinking ')
        print('there."')
        jump label_532

    case 'lyca':
        print('"It\'s on the same island as @Moonglow."')
        jump label_532

    case 'moon':
        print('"It\'s on the same island as the @Lycaeum."')
        jump label_532

    case 'mari':
        print('"She knows how to be generous to poor wandering gypsies. You should ')
        print('follow her example!"')
        jump label_532

    case 'capt':
    case 'john':
        print('"Captain John? I talked to him when he gave us the silver tablet for ')
        print('@Mariah."\n*\n"He\'s madder than a gremlin! Claims as he\'s been living ')
        print('with the gargoyles."\n*\n"He talks as if there\'s nothing evil about ')
        print('them."\n*\n"He said the tablet had something to do with translating."')
        jump label_532

    case 'gorg':
        print('"Either you\'re a gorgio or my name\'s not @Zoltan!"')
        jump label_532

    case 'kari':
    case 'tayn':
        print('"There are no women like gypsy women!"')
        jump label_532

    case 'bye':
        if hasBit(byte 235, byte 7):
            print('"Farewell! My fellow gypsies and I will @dance to your health and good')
            print(' fortune!"')

        else:
            print('"Farewell."')
        fi

        print('\n')
        bye()

    case 'danc':
        print('@Karina produces a fiddle from somewhere and begins to play a tune at ')
        print('a very high tempo.\n*\nZoltan dances a wild dance for you, leaping and ')
        print('capering about frantically.\n*\nHis chest glistens with sweat as he ')
        print('walks up to you expectantly.\n\n')
        jump label_4018

    case 'buy':
    case 'fine':
    case 'good':
    case 'inte':
    case 'item':
    case 'magi':
    case 'reag':
    case 'sale':
    case 'sell':
        jump label_4344

    case '*':
        print('"Why worry yourself with that?"\n*\n"Perhaps you\'d like to look over ')
        print('some of the fine @reagents I have for sale."')
    esac

    jump label_532

label_2887:
    print('"Tell you what. Since I\'m in a good mood, I\'ll only charge you two ')
    print('gold coins. Is it a deal?" ')

    choice('yn')

    case 'n':
        print('"Whatever you say."')
        jump label_532
    esac

    if less(objectsCount(byte 1, byte 88), byte 2):
        print('\n"Come back when you\'re not so down on your luck."')
        jump label_532
    fi

    ('DELETE', ('byte', 1), ('byte', 88), ('byte', 0), ('byte', 2))
    ('NEW', ('byte', 235), ('byte', 88), ('byte', 0), ('byte', 2))
    ('SETF', ('byte', 235), ('byte', 7))
    print('\n"I\'ll tell you this:"\n*\n"Powder kegs are useful for persuading ')
    print('uncooperative doors to open."')
    jump label_532

label_3209:
    print('"I\'d be glad to help you out. But \'tis a hard life, sometimes, being a')
    print(' gypsy."\n*\n"You\'d be willing to pay ten gold for the information, ')
    print('would you?" ')

    choice('yn')

    case 'n':
        print('"Let me know if you change your mind."')
        jump label_532
    esac

    if less(objectsCount(byte 1, byte 88), byte 10):
        print('\n"Come back when you have the money."')
        jump label_532
    fi

    ('DELETE', ('byte', 1), ('byte', 88), ('byte', 0), ('byte', 10))
    ('NEW', ('byte', 235), ('byte', 88), ('byte', 0), ('byte', 10))
    ('SETF', ('byte', 235), ('byte', 7))
    print('\n"Some @gorgio called \'Captain @John\' brought us the silver tablet and')
    print(' paid us to take it to the Lycaeum."\n*\n"While we were on the way ')
    print('there, we were ambushed by Captain @Hawkins and his crew."\n*\nThe ')
    print('tablet was broken in two during the scuffle. The pirates got away with')
    print(' the bigger half."\n*\n"Hawkins took my finest earring as well - I spit ')
    print('on his mother\'s grave!"\n*\n"Most likely they went to Buccaneer\'s @Den ')
    print('with their loot."\n*\n"We took the corner of the tablet that they missed')
    print(' to the @Lycaeum and sold it to @Mariah."')
    jump label_532

label_4018:
    print('Do you give him any money? ')

    choice('yn')

    case 'n':
label_4051:
        ('SETF', ('byte', 235), ('value', 1))
        print('"Hah! I should know better than to expect a gorgio to appreciate a ')
        print('fine gypsy dance."\n*\nProudly, he turns his back on you.\n')
        bye()
    esac

label_4182:
    print('\nHow much do you give? ')
    ('INPUT', 0)

    if greater(integer(value 0), objectsCount(byte 1, byte 88)):
        print('\nYou don\'t have that much.\n')
        jump label_4182
    fi

    if equals(integer(value 0), byte 0):
        jump label_4051
    fi

    ('DELETE', ('byte', 1), ('byte', 88), ('byte', 0), ('integer', [('value', 0)]))
    ('NEW', ('byte', 235), ('byte', 88), ('byte', 0), ('integer', [('value', 0)]))
    ('SETF', ('byte', 235), ('byte', 7))
    ('CLEARF', ('byte', 235), ('value', 1))
    print('\nZoltan pockets the money. "Thanks."')
    jump label_532

label_4344:
    if greater(integer(value 23), byte 0):
        integer(value 2) = byte 1
        jump label_4379
    fi

    integer(value 3) = character(byte 0, byte 0)
    jump label_4517

label_4379:
    integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)
    ('SETNAME', ('integer', [('value', 3)]))
    print('#2) $Y\n')

    if lessOrEquals(integer(value 2), integer(value 23)):
        integer(value 2) = plus(integer(value 2), byte 1)
        jump label_4379
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 2)

    if or(equals(integer(value 2), byte 0), greater(integer(value 2), plus(integer(value 23), byte 1))):
        print('\n"What else would you like to know?"')
        jump label_532

    else:
        integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)
    fi

label_4517:
    ('SETNAME', ('integer', [('value', 3)]))
    integer(value 1) = byte 1

label_4528:
    string(value 1) = data(dword 5107, minus(integer(value 1), byte 1))
    print('#1) $1\n')
    integer(value 1) = plus(integer(value 1), byte 1)

    if greater(data(dword 5075, minus(integer(value 1), byte 1)), byte 0):
        jump label_4528
    fi

    print('"Which of these?" ')
    ('INPUTNUM', 2)

    if or(equals(integer(value 2), byte 0), greaterOrEquals(integer(value 2), integer(value 1))):
        integer(value 2) = byte 1
        jump label_532
    fi

    integer(value 2) = minus(integer(value 2), byte 1)
    integer(value 1) = data(dword 5091, integer(value 2))
    string(value 1) = data(dword 5107, integer(value 2))
    integer(value 5) = byte 0
    print('"$1 costs #1 per portion."')
    wait()

    print('\n\n"How many do you want?" ')
    ('INPUT', 4)

    if equals(integer(value 4), byte 0):
        jump label_4517
    fi

label_4742:
    if less(canCarry(integer(value 3)), weight(data(dword 5075, integer(value 2)), byte 1)):
        jump label_4877
    fi

    if less(objectsCount(integer(value 3), byte 88), integer(value 1)):
        jump label_4976
    fi

    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 1)]))
    ('NEW', ('integer', [('value', 3)]), ('data', [('dword', 5075), ('integer', [('value', 2)])]), ('byte', 0), ('byte', 1))
    ('SETF', ('byte', 235), ('byte', 7))
    ('CLEARF', ('byte', 235), ('value', 1))
    integer(value 5) = plus(integer(value 5), byte 1)

    if equals(integer(value 5), integer(value 4)):
        print('$N hands $Y the $1.')
        wait()

        print('\n\n')
        jump label_4517

    else:
        jump label_4742
    fi

label_4877:
    if integer(value 5):
        print('"You can\'t carry that much!"')
        wait()

        print('\n\n"I\'ll just give you #5."')
        wait()

        print('\n\n')
        jump label_4517

    else:
        print('"You can\'t carry any!"')
        wait()

        print('\n\n')
        jump label_4517
    fi

label_4976:
    if integer(value 5):
        print('"You can\'t afford that much!"')
        wait()

        print('\n\n"I\'ll give you #5."')
        wait()

        print('\n\n')
        jump label_4517

    else:
        print('"You can\'t afford any $1!"')
        wait()

        print('\n\n')
        jump label_4517
    fi

integers_5075 = [
    66, // 0
    67, // 1
    68, // 2
    70, // 3
    71, // 4
    72, // 5
    0,  // 6
    0,  // 7
]

integers_5091 = [
    3, // 0
    2, // 1
    1, // 2
    1, // 3
    2, // 4
    3, // 5
    0, // 6
    0, // 7
]

strings_5107 = [
    'Blood Moss',    // 0
    'Garlic',        // 1
    'Ginseng',       // 2
    'Nightshade',    // 3
    'Spider Silk',   // 4
    'Sulfurous Ash', // 5
    ' ',             // 6
    ' ',             // 7
]

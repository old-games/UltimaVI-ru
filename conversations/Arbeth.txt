source('CONVERSE.B')
index(4)

id(103)
name({
    'english': 'Arbeth',
    'russian': 'Арбет'
})

description:
    print({
        'english': 'a frightened little man who never looks you in the eye.',
        'russian': 'Невысокий пугливый мужчина, который никогда не смотрит в глаза.'
    })
    wait()

    print({
        'english': '\n',
        'russian': '\n'
    })

interaction:
    if equals(integer(value 32), byte 146):
        jump label_157
    fi

    print({
        'english': 'He looks up from his mug of ale. ',
        'russian': 'Он отрывает взгляд от кружки эля. '
    })

    if hasBit(byte 235, value 0):
        print({
            'english': '"Oh, it\'s you. Hello."',
            'russian': '"О, это вы. Здравствуйте".'
        })

    else:
        print({
            'english': '"Hello."',
            'russian': '"Здравствуйте".'
        })
    fi

    print({
        'english': '\n',
        'russian': '\n'
    })
    jump label_318

label_157:
    if hasBit(byte 235, value 0):
        print({
            'english': '"Yes?" he asks, looking like he expects to be beaten any minute. ',
            'russian': '"Да?" - спрашивает он с таким взглядом, будто ожидает удара в любой момент. '
        })

    else:
        print({
            'english': '"Yes? Oh, it\'s you." He almost looked you in the eyes then. ',
            'russian': '"Да? О, это вы". - Он почти встретился с вами взглядом. - '
        })
    fi

label_290:
    print({
        'english': '"What do you want from me?"\n',
        'russian': '"Что вам нужно?"\n'
    })

label_318:
    ask()

    case 'name':
    case {'russian': 'имя'}:
        print({
            'english': 'He looks around at the ground and mumbles "Arbeth."\n',
            'russian': 'Он потупил взгляд и бормочет: "Арбет".\n'
        })
        setBit(byte 235, value 0)
        jump label_318

    case 'arbe':
    case {'russian': 'арбе'}:
        print({
            'english': '"Arbeth," he repeats quietly.\n',
            'russian': '"Арбет", - повторил он тихо.\n'
        })
        jump label_318

    case 'job':
    case {'russian': 'раб'}:
    case 'shop':
    case {'russian': 'лавк'}:
        print({
            'english': '"Well," he says so quietly you have to lean close to hear, "I make ',
            'russian': '"Ну, я делаю @нитки из @шерсти", - он говорит так тихо, что приходится '
        })
        print({
            'english': '@wool into @thread."\n',
            'russian': 'нагибаться к нему, чтобы всё расслышать.\n'
        })
        jump label_318

    case 'thre':
    case {'russian': 'нитк'}:
        print({
            'english': '"Yes," he says, wringing his hands together.\n',
            'russian': '"Да", - говорит он, нервно сжав руки вместе.\n'
        })
        jump label_318

    case 'weav':
    case {'russian': 'плес'}:
        print({
            'english': '"I\'m not a weaver, $G, just a spinner. Talk to @Thindle."\n',
            'russian': '"Я не ткач, $G, просто пряду нить. Поговорите с @Финдлом".\n'
        })
        jump label_318

    case 'thin':
    case {'russian': 'финд'}:
        print({
            'english': '"He lives here in Paws and is a fine weaver."\n',
            'russian': '"Он искусный ткач и живёт здесь, в Поусе".\n'
        })
        jump label_318

    case 'spid':
    case {'russian': 'пряж'}:
    case 'silk':
    case {'russian': 'шёлк'}:
    case 'plan':
    case {'russian': 'план'}:
    case 'ball':
    case {'russian': 'шар'}:
        if notEquals(integer(value 32), byte 146):
            jump label_1431
        fi

        print({
            'english': '"What? Oh, yes, I could spin spidersilk into thread. Do you want me ',
            'russian': '"Что? Да, я могу делать нити из паучьего шёлка. Хочешь, чтобы '
        })
        print({
            'english': 'to?" ',
            'russian': 'я это сделал?" '
        })
        jump label_1489

    case 'sell':
    case {'russian': 'прод'}:
    case 'wool':
    case {'russian': 'шерс'}:
        if notEquals(integer(value 32), byte 146):
            jump label_1431

        else:
            jump label_2945
        fi

    case 'buy':
    case {'russian': 'поку'}:
    case 'thre':
    case {'russian': 'нитк'}:
        if notEquals(integer(value 32), byte 146):
            jump label_1431

        else:
            jump label_2542
        fi

    case 'timo':
    case {'russian': 'тимо'}:
        print({
            'english': '"He is nice to me." he stops wringing his hands and seems to relax ',
            'russian': '"Он хорошо относится ко мне", - он оставляет в покое свои руки и, кажется, сразу '
        })
        print({
            'english': 'momentarily.\n',
            'russian': 'расслабляется.\n'
        })
        jump label_318

    case 'mort':
    case {'russian': 'морт'}:
        print({
            'english': '"He\'s much too @loud." He looks up suddenly and his face goes ashen.\n',
            'russian': '"Он слишком @шумный," - он вдруг поднимает глаза, и его лицо сереет.\n'
        })
        jump label_318

    case 'loud':
    case {'russian': 'шумн'}:
        print({
            'english': '"But...I mean...maybe not too loud."\n*\nHe whips his head around as if ',
            'russian': '"Но... Я про то... Не такой уж он и шумный".\n*\nОн резко поверачивается, будто '
        })
        print({
            'english': 'he\'s looking for someplace to hide.\n',
            'russian': 'хочет найти, где спрятаться.\n'
        })
        jump label_318

    case 'mari':
    case {'russian': 'мари'}:
    case 'dori':
    case {'russian': 'дори'}:
        print({
            'english': '"She\'s alright, I guess."\n',
            'russian': '"У неё всё хорошо. Вроде".\n'
        })
        jump label_318

    case 'gris':
    case {'russian': 'грис'}:
    case 'hend':
    case {'russian': 'хенд'}:
    case 'uber':
    case {'russian': 'убер'}:
        print({
            'english': '"He\'s alright, I guess."\n',
            'russian': '"У него всё хорошо. Вроде".\n'
        })
        jump label_318

    case 'meri':
    case {'russian': 'мери'}:
        print({
            'english': 'A smile crosses his face. "I like her. She brought me cookies once."\n',
            'russian': 'Улыбка проскальзывает по его лицу. "Она мне нравится. Она как-то угостила меня печеньем".\n'
        })
        jump label_318

    case 'bye':
    case {'russian': 'пока'}:
        print({
            'english': '"Bye," he whispers.\n',
            'russian': '"Пока", - шепчет он.\n'
        })
        bye()

    case '*':
        print({
            'english': 'He twists his shoulders around and holds his palms up.\n',
            'russian': 'Он разводит руками.\n'
        })
    esac

    jump label_318

label_1431:
    print({
        'english': '"Not now, $G," he says timidly. "My shop is closed."\n',
        'russian': '"Не сейчас, $G", - говорит он робко. - "Моя лавка закрыта".\n'
    })
    jump label_318

label_1489:
    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Oh. Sorry," he mumbles.\n\n',
            'russian': '"Ох, прошу прощения", - бормочет он.\n\n'
        })
        jump label_290

    case 'y':
    case {'russian': 'д'}:
        jump label_1535
    esac

label_1535:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 1
        jump label_1721
    fi

    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1569:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': '#2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1569
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        print({
            'english': '"Oh. Sorry," he mumbles.\n\n',
            'russian': '"Ох, прошу прощения", - бормочет он.\n\n'
        })
        jump label_290
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        integer(value 0) = byte 0
        integer(value 2) = byte 1
        jump label_1569
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_1721:
    look(integer(value 3))
    print({
        'english': '"\'Tis a most difficult job, $Y. It\'ll cost thee 20 gold!"',
        'russian': '"Это тяжёлый труд, $Y. Это будет стоить 20 золотых!"'
    })
    wait()

    print({
        'english': '\n\n"Still interested?" ',
        'russian': '\n\n"Интересует?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Oh. Sorry," he mumbles.\n\n',
            'russian': '"Ох, прошу прощения", - бормочет он.\n\n'
        })
        jump label_290

    case 'y':
    case {'russian': 'д'}:
        print({
            'english': '"Good, good!" He seems much brighter and happier now.',
            'russian': '"Хорошо, хорошо!" - ответ явно обрадовал его.'
        })
        wait()

        print({
            'english': '\n\n',
            'russian': '\n\n'
        })
    esac

    if less(objectsCount(integer(value 3), byte 71), byte 40):
        print({
            'english': '"Oh, but I\'ll need twoscore bits of spidersilk to do it!"',
            'russian': '"Но для этого мне потребуется сорок отрезов паучьего шёлка!"'
        })
        wait()

        print({
            'english': '\n\n"Come back when thou hast 40 pieces of spidersilk and I\'ll make thy ',
            'russian': '\n\n"Возвращайтесь, когда у вас будет 40 отрезов паучьего шёлка, и я сделаю '
        })
        print({
            'english': 'thread then."\n',
            'russian': 'нитки".\n'
        })
        jump label_318
    fi

    integer(value 1) = plus(weight(byte 71, byte 40), weight(byte 88, byte 20))

    if less(plus(canCarry(integer(value 3)), integer(value 1)), weight(byte 226, byte 1)):
        print({
            'english': '"Oh, but you\'ll not be able to carry it, $Y!"',
            'russian': '"Но в вашем рюкзаке нет места, $Y!"'
        })
        wait()

        print({
            'english': '\n\n"Come back when thy load is lighter and I\'ll make thy thread then."\n',
            'russian': '\n\n"Возвращайтесь, когда у вас будет место в рюкзаке, и я сделаю нитки для вас".\n'
        })
        jump label_318
    fi

    if less(objectsCount(integer(value 3), byte 88), byte 20):
        print({
            'english': '"You haven\'t the gold."\n',
            'russian': '"У вас нет золота".\n'
        })
        jump label_318
    fi

    print({
        'english': 'Arbeth takes $Y\'s gold and silk and starts spinning...',
        'russian': 'Арбет берёт у персонажа $Y золото, шёлк и приступает к работу...'
    })
    destroyItem(integer(value 3), byte 88, byte 0, byte 20)
    destroyItem(integer(value 3), byte 71, byte 0, byte 40)
    wait()

    print({
        'english': '\n\nSoon he has finished a spool of fine silk thread!',
        'russian': '\n\nОчень скоро в руках у него оказывается катушка прекрасных шёлковых ниток!'
    })
    wait()

    print({
        'english': '\n\n"There it is, $Y, my finest work! A true pleasure!"',
        'russian': '\n\n"Держите, $Y! Одно удовольствие заниматься такой искусной работой!"'
    })
    wait()

    print({
        'english': '\n\nArbeth hands $Y the spool of silk.',
        'russian': '\n\nАрбет передаёт $Y катушку шёлка.'
    })
    createItem(integer(value 3), byte 226, byte 0, byte 1)
    wait()

    print({
        'english': '\n\n"You\'ll have to find a @weaver, of course..."\n',
        'russian': '\n\n"Разумеется, вам понадобится @ткач..."\n'
    })
    jump label_318

label_2542:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 0
        jump label_2678
    fi

label_2562:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_2576:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': '#2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_2576
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_2939
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_2562
    fi

label_2678:
    print({
        'english': '"Will you pay 3 gold for a spool of thread?" ',
        'russian': '"Позволите себе заплатить 3 золотых за катушку ниток?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        if less(canCarry(character(integer(value 3), byte 0)), weight(byte 225, byte 1)):
            print({
                'english': '"You look pretty full to me."',
                'russian': '"Кажется, ваш рюкзак перегружен".'
            })
            wait()

            print({
                'english': '\n',
                'russian': '\n'
            })
            jump label_290
        fi

        if greaterOrEquals(objectsCount(character(integer(value 3), byte 0), byte 88), byte 3):
            destroyItem(character(integer(value 3), byte 0), byte 88, byte 0, byte 3)
            createItem(character(integer(value 3), byte 0), byte 225, byte 0, byte 1)
            look(character(integer(value 3), byte 0))
            print({
                'english': 'After accepting $Y\'s gold, $N hands over the thread.',
                'russian': 'Получив у персонажа $Y\ деньги, $N передаёт нитки.'
            })
            wait()

            integer(value 5) = byte 1
            print({
                'english': '\n\n',
                'russian': '\n\n'
            })
            jump label_2939

        else:
            look(character(integer(value 3), byte 0))
            print({
                'english': '"You haven\'t the gold."',
                'russian': '"У вас нет золота".'
            })
            wait()

            print({
                'english': '\n',
                'russian': '\n'
            })
            jump label_290
        fi
    esac

label_2939:
    print({
        'english': '\n',
        'russian': '\n'
    })
    jump label_290

label_2945:
    integer(value 0) = byte 0
    integer(value 2) = byte 0
    integer(value 3) = byte 0

label_2966:
    integer(value 1) = byte 0

label_2973:
    if objectsCount(character(integer(value 0), byte 0), byte 190):
        data(integers_3501, integer(value 2)) = integer(value 0)
        integer(value 2) = plus(integer(value 2), byte 1)
        integer(value 3) = byte 1
        jump label_3042
    fi

    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), byte 7):
        jump label_2973
    fi

label_3042:
    integer(value 0) = plus(integer(value 0), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_2966
    fi

    if equals(integer(value 3), byte 0):
        print({
            'english': '"None of you has any wool," he mutters.',
            'russian': '"Ни у кого из вас нет шерсти", - ворчит он.'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_290
    fi

    if equals(integer(value 2), byte 1):
        integer(value 3) = data(integers_3501, byte 0)
        jump label_3280
    fi

label_3145:
    integer(value 0) = byte 0
    integer(value 1) = byte 1

label_3159:
    look(character(data(integers_3501, integer(value 0)), byte 0))
    print({
        'english': '#1. $Y\n',
        'russian': '#1. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 0), integer(value 2)):
        jump label_3159
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_3495
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greaterOrEquals(integer(value 3), integer(value 2)):
        jump label_3145
    fi

    integer(value 3) = data(integers_3501, integer(value 3))

label_3280:
    integer(value 4) = objectsCount(character(integer(value 3), byte 0), byte 190)
    look(character(integer(value 3), byte 0))

    if equals(integer(value 4), byte 0):
        jump label_3458
    fi

    print({
        'english': '"Will you take 6 gold for that wool?" ',
        'russian': '"Отдадите эту шерсть за 6 золотых?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        print({
            'english': 'He hands $Y 6 gold pieces and takes the bale of wool.',
            'russian': 'Передаёт персонажу $Y 6 золотых и забирает тюк шерсти.'
        })
        destroyItem(character(integer(value 3), byte 0), byte 190, byte 0, byte 1)
        createItem(character(integer(value 3), byte 0), byte 88, byte 0, byte 10)
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_290

    case 'n':
    case {'russian': 'n'}:
        jump label_3495
    esac

label_3458:
    print({
        'english': '"But you don\'t have any wool!"',
        'russian': '"Но у вас нет шерсти!"'
    })
    wait()

    print({
        'english': '\n',
        'russian': '\n'
    })
    jump label_290

label_3495:
    print({
        'english': '\n',
        'russian': '\n'
    })
    jump label_290

integers_3501 = [
    0, // 0
    0, // 1
    0, // 2
    0, // 3
    0, // 4
    0, // 5
    0, // 6
    0, // 7
]

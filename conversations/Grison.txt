source('CONVERSE.B')
index(5)

id(104)
name({
    'english': 'Grison',
    'russian': 'FIXME Grison'
})

description:
    print({
        'english': 'a figure covered from head to toe with flour.',
        'russian': 'FIXME a figure covered from head to toe with flour.'
    })
    wait()

    print({
        'english': '\n',
        'russian': 'FIXME \n'
    })

interaction:
    if notEquals(integer(value 32), byte 144):
        print({
            'english': '"Ach, I\'d like to talk with ya, but I\'ve no time!"',
            'russian': 'FIXME "Ach, I\'d like to talk with ya, but I\'ve no time!"'
        })
        wait()

        print({
            'english': '\n\n"Come see me at my gristmill some other time."',
            'russian': 'FIXME \n\n"Come see me at my gristmill some other time."'
        })
        wait()

        print({
            'english': '\n\n"\'Tis hard work, but it gives me plenty of time to talk!"\n',
            'russian': 'FIXME \n\n"\'Tis hard work, but it gives me plenty of time to talk!"\n'
        })
        bye()
    fi

    if hasBit(byte 235, value 0):
        print({
            'english': '"Hrmph... ptuh... hello again."\n',
            'russian': 'FIXME "Hrmph... ptuh... hello again."\n'
        })

    else:
        print({
            'english': '"Ptuh... ptuh... hello."\n',
            'russian': 'FIXME "Ptuh... ptuh... hello."\n'
        })
    fi

label_291:
    ask()

    case {
        'english': 'name',
        'russian': 'FIXME name'
    }:
        print({
            'english': '"Grison Fairfleth, at your service."\n',
            'russian': 'FIXME "Grison Fairfleth, at your service."\n'
        })
        setBit(byte 235, value 0)
        jump label_291

    case {
        'english': 'fair',
        'russian': 'FIXME fair'
    }:
    case {
        'english': 'gris',
        'russian': 'FIXME gris'
    }:
        print({
            'english': '"You can call me \'Gris\' if ya prefer."\n',
            'russian': 'FIXME "You can call me \'Gris\' if ya prefer."\n'
        })
        jump label_291

    case {
        'english': 'job',
        'russian': 'FIXME job'
    }:
        print({
            'english': '"As you can see, I turn @grain into @flour."',
            'russian': 'FIXME "As you can see, I turn @grain into @flour."'
        })
        wait()

        print({
            'english': '\n\n"It\'s a pretty demanding job...and a bit messy too."\n',
            'russian': 'FIXME \n\n"It\'s a pretty demanding job...and a bit messy too."\n'
        })
        jump label_291

    case {
        'english': 'buy',
        'russian': 'FIXME buy'
    }:
    case {
        'english': 'flou',
        'russian': 'FIXME flou'
    }:
        jump label_1247

    case {
        'english': 'grai',
        'russian': 'FIXME grai'
    }:
    case {
        'english': 'sell',
        'russian': 'FIXME sell'
    }:
        jump label_1665

    case {
        'english': 'timo',
        'russian': 'FIXME timo'
    }:
        print({
            'english': '"He\'s a good fellow. I grew up with him."\n',
            'russian': 'FIXME "He\'s a good fellow. I grew up with him."\n'
        })
        jump label_291

    case {
        'english': 'grew',
        'russian': 'FIXME grew'
    }:
    case {
        'english': 'up',
        'russian': 'FIXME up'
    }:
        print({
            'english': '"Yep. We were mates." He continues to wipe the dust from his eyes.\n',
            'russian': 'FIXME "Yep. We were mates." He continues to wipe the dust from his eyes.\n'
        })
        jump label_291

    case {
        'english': 'mort',
        'russian': 'FIXME mort'
    }:
        print({
            'english': '"Shorty, ya mean? He\'s got a fair temper, I\'ll tell you that!"\n',
            'russian': 'FIXME "Shorty, ya mean? He\'s got a fair temper, I\'ll tell you that!"\n'
        })
        jump label_291

    case {
        'english': 'mari',
        'russian': 'FIXME mari'
    }:
        print({
            'english': '"She\'s one with a nose to the air instead of the grindstone." He ',
            'russian': 'FIXME "She\'s one with a nose to the air instead of the grindstone." He '
        })
        print({
            'english': 'chuckles to himself.\n',
            'russian': 'FIXME chuckles to himself.\n'
        })
        jump label_291

    case {
        'english': 'arbe',
        'russian': 'FIXME arbe'
    }:
        print({
            'english': '"Scared of his own shadow, he is."\n',
            'russian': 'FIXME "Scared of his own shadow, he is."\n'
        })
        jump label_291

    case {
        'english': 'dori',
        'russian': 'FIXME dori'
    }:
        print({
            'english': '"She\'s baked many a pie with my flour."\n',
            'russian': 'FIXME "She\'s baked many a pie with my flour."\n'
        })
        jump label_291

    case {
        'english': 'meri',
        'russian': 'FIXME meri'
    }:
        print({
            'english': '"Meri the wisp, eh? She\'s sure a cutey."\n',
            'russian': 'FIXME "Meri the wisp, eh? She\'s sure a cutey."\n'
        })
        jump label_291

    case {
        'english': 'hend',
        'russian': 'FIXME hend'
    }:
        print({
            'english': '"One o\' the nicest gents I know. Always has a good tale."\n',
            'russian': 'FIXME "One o\' the nicest gents I know. Always has a good tale."\n'
        })
        jump label_291

    case {
        'english': 'uber',
        'russian': 'FIXME uber'
    }:
        print({
            'english': '"A good, hard worker, that man. Has quite a strong grip too."\n',
            'russian': 'FIXME "A good, hard worker, that man. Has quite a strong grip too."\n'
        })
        jump label_291

    case {
        'english': 'bye',
        'russian': 'FIXME bye'
    }:
        print({
            'english': '"Well, if that\'s all you need, goodbye."\n',
            'russian': 'FIXME "Well, if that\'s all you need, goodbye."\n'
        })
        bye()

    case {
        'english': '*',
        'russian': 'FIXME *'
    }:
        print({
            'english': 'He sticks a finger in his ear and shakes it. "What?"\n',
            'russian': 'FIXME He sticks a finger in his ear and shakes it. "What?"\n'
        })
    esac

    jump label_291

label_1247:
    if equals(integer(value 23), byte 0):
        integer(value 3) = character(byte 0, byte 0)
        jump label_1413
    fi

label_1270:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1284:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': 'FIXME #2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1284
    fi

    print({
        'english': '"Which of you?" ',
        'russian': 'FIXME "Which of you?" '
    })
    inputInteger(integer(value 3))

    if equals(integer(value 3), byte 0):
        print({
            'english': '"Suit yourself."\n',
            'russian': 'FIXME "Suit yourself."\n'
        })
        jump label_291
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1270
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_1413:
    print({
        'english': '"I\'ll sell you a sack of flour for 4 gold. Is that okay?" ',
        'russian': 'FIXME "I\'ll sell you a sack of flour for 4 gold. Is that okay?" '
    })

    choice({
        'english': 'yn',
        'russian': 'FIXME yn'
    })

    case {
        'english': 'y',
        'russian': 'FIXME y'
    }:
        if less(plus(canCarry(integer(value 3)), weight(byte 88, byte 4)), weight(byte 167, byte 1)):
            print({
                'english': '"You look pretty full to me."\n',
                'russian': 'FIXME "You look pretty full to me."\n'
            })
            jump label_291
        fi

        if greaterOrEquals(objectsCount(integer(value 3), byte 88), byte 4):
            destroyItem(integer(value 3), byte 88, byte 0, byte 4)
            createItem(integer(value 3), byte 167, byte 0, byte 1)
            print({
                'english': '"Excellent!" $N hands over the flour.\n',
                'russian': 'FIXME "Excellent!" $N hands over the flour.\n'
            })
            jump label_291

        else:
            print({
                'english': '"You can\'t afford it."\n',
                'russian': 'FIXME "You can\'t afford it."\n'
            })
            jump label_291
        fi

    case {
        'english': 'n',
        'russian': 'FIXME n'
    }:
        print({
            'english': '"Suit yourself."\n',
            'russian': 'FIXME "Suit yourself."\n'
        })
        jump label_291
    esac

label_1665:
    integer(value 0) = byte 0
    integer(value 2) = byte 0
    integer(value 3) = byte 0

label_1686:
    integer(value 1) = byte 0

label_1693:
    if objectsCount(character(integer(value 0), byte 0), byte 166):
        data(integers_2272, integer(value 2)) = integer(value 0)
        integer(value 2) = plus(integer(value 2), byte 1)
        integer(value 3) = byte 1
        jump label_1762
    fi

    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), byte 7):
        jump label_1693
    fi

label_1762:
    integer(value 0) = plus(integer(value 0), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1686
    fi

    if equals(integer(value 3), byte 0):
        print({
            'english': '"I\'d buy some grain, if you had any."\n',
            'russian': 'FIXME "I\'d buy some grain, if you had any."\n'
        })
        jump label_291
    fi

    if equals(integer(value 2), byte 1):
        integer(value 3) = character(data(integers_2272, byte 0), byte 0)
        jump label_2020
    fi

label_1865:
    integer(value 0) = byte 0
    integer(value 1) = byte 1

label_1879:
    look(character(data(integers_2272, integer(value 0)), byte 0))
    print({
        'english': '#1. $Y\n',
        'russian': 'FIXME #1. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 0), integer(value 2)):
        jump label_1879
    fi

    print({
        'english': '"Which of you?" ',
        'russian': 'FIXME "Which of you?" '
    })
    inputInteger(integer(value 3))

    if equals(integer(value 3), byte 0):
        print({
            'english': '"Suit yourself."\n',
            'russian': 'FIXME "Suit yourself."\n'
        })
        jump label_291
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greaterOrEquals(integer(value 3), integer(value 2)):
        jump label_1865
    fi

    integer(value 3) = character(data(integers_2272, integer(value 3)), byte 0)

label_2020:
    integer(value 4) = objectsCount(integer(value 3), byte 166)
    look(integer(value 3))

    if equals(integer(value 4), byte 0):
        print({
            'english': '"But ya don\'t have any grain!"\n',
            'russian': 'FIXME "But ya don\'t have any grain!"\n'
        })
        jump label_291
    fi

    print({
        'english': '$N turns to $Y, and says "I\'ll pay you 3 crowns for that sack of ',
        'russian': 'FIXME $N turns to $Y, and says "I\'ll pay you 3 crowns for that sack of '
    })
    print({
        'english': 'grain, ok?" ',
        'russian': 'FIXME grain, ok?" '
    })

    choice({
        'english': 'yn',
        'russian': 'FIXME yn'
    })

    case {
        'english': 'y',
        'russian': 'FIXME y'
    }:
        print({
            'english': '"Done!" He hands $Y 3 gold pieces and takes the sack.\n',
            'russian': 'FIXME "Done!" He hands $Y 3 gold pieces and takes the sack.\n'
        })
        destroyItem(integer(value 3), byte 166, byte 0, byte 1)
        createItem(integer(value 3), byte 88, byte 0, byte 3)
        jump label_291

    case {
        'english': 'n',
        'russian': 'FIXME n'
    }:
        print({
            'english': '"Suit yourself."\n',
            'russian': 'FIXME "Suit yourself."\n'
        })
        jump label_291
    esac

integers_2272 = [
    0, // 0
    0, // 1
    0, // 2
    0, // 3
    0, // 4
    0, // 5
    0, // 6
    0, // 7
]

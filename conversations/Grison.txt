source('CONVERSE.B')
index(5)

id(104)
name({
    'english': 'Grison',
    'russian': 'Грисон'
})

description:
    print({
        'english': 'a figure covered from head to toe with flour.',
        'russian': 'фигуру, с головы до ног покрытую мукой.'
    })
    wait()

    print({
        'english': '\n',
        'russian': '\n'
    })

interaction:
    if notEquals(integer(value 32), byte 144):
        print({
            'english': '"Ach, I\'d like to talk with ya, but I\'ve no time!"',
            'russian': '"Ах, я бы хотел с вами поговорить, но у меня нет времени!"'
        })
        wait()

        print({
            'english': '\n\n"Come see me at my gristmill some other time."',
            'russian': '\n\n"Заходите попозже ко мне на мельницу".'
        })
        wait()

        print({
            'english': '\n\n"\'Tis hard work, but it gives me plenty of time to talk!"\n',
            'russian': '\n\n"Это тяжёлая работа, но у меня остаётся много времени для разговоров!"\n'
        })
        bye()
    fi

    if hasBit(byte 235, value 0):
        print({
            'english': '"Hrmph... ptuh... hello again."\n',
            'russian': '"Хрм... кхе... и снова здравствуйте".\n'
        })

    else:
        print({
            'english': '"Ptuh... ptuh... hello."\n',
            'russian': '"Хрм... кхе... здравствуйте".\n'
        })
    fi

label_291:
    ask()

    case 'name':
    case {'russian': 'имя'}:
        print({
            'english': '"Grison Fairfleth, at your service."\n',
            'russian': '"Грисон Фэйрфлет, к вашим услугам".\n'
        })
        setBit(byte 235, value 0)
        jump label_291

    case 'gris':
    case {'russian': 'грис'}:
    case 'fair':
    case {'russian': 'фэйр'}:
        print({
            'english': '"You can call me \'Gris\' if ya prefer."\n',
            'russian': '"Вы можете называть меня \'Грис\', если хотите".\n'
        })
        jump label_291

    case 'job':
    case {'russian': 'раб'}:
        print({
            'english': '"As you can see, I turn @grain into @flour."',
            'russian': '"Как вы можете видеть, я превращаю @зерно в @муку".'
        })
        wait()

        print({
            'english': '\n\n"It\'s a pretty demanding job...and a bit messy too."\n',
            'russian': '\n\n"Это довольно ответственная работа... и к тому же немного грязная".\n'
        })
        jump label_291

    case 'buy':
    case {'russian': 'купи'}:
    case 'flou':
    case {'russian': 'муку'}:
        jump label_1247

    case 'sell':
    case {'russian': 'прод'}:
    case 'grai':
    case {'russian': 'зерн'}:
        jump label_1665

    case 'timo':
    case {'russian': 'тимо'}:
        print({
            'english': '"He\'s a good fellow. I grew up with him."\n',
            'russian': '"Он хороший парень. Я вырос с ним".\n'
        })
        jump label_291

    case 'grew':
    case {'russian': 'выро'}:
    case 'up':
    case {'russian': 'рос'}:
        print({
            'english': '"Yep. We were mates." He continues to wipe the dust from his eyes.\n',
            'russian': '"Да. Мы были приятелями". Он продолжает вытирать пыль с глаз.\n'
        })
        jump label_291

    case 'mort':
    case {'russian': 'морт'}:
        print({
            'english': '"Shorty, ya mean? He\'s got a fair temper, I\'ll tell you that!"\n',
            'russian': '"Ты имеешь в виду коротышку? У него справедливый нрав, вот что я тебе скажу!"\n'
        })
        jump label_291

    case 'mari':
    case {'russian': 'мари'}:
        print({
            'english': '"She\'s one with a nose to the air instead of the grindstone." He ',
            'russian': '"Она из тех, кто задирает нос вместо рукавов". Он '
        })
        print({
            'english': 'chuckles to himself.\n',
            'russian': 'посмеивается про себя.\n'
        })
        jump label_291

    case 'arbe':
    case {'russian': 'арбе'}:
        print({
            'english': '"Scared of his own shadow, he is."\n',
            'russian': '"Он боится собственной тени".\n'
        })
        jump label_291

    case 'dori':
    case {'russian': 'дори'}:
        print({
            'english': '"She\'s baked many a pie with my flour."\n',
            'russian': '"Она испекла много пирогов из моей муки".\n'
        })
        jump label_291

    case 'meri':
    case {'russian': 'мери'}:
        print({
            'english': '"Meri the wisp, eh? She\'s sure a cutey."\n',
            'russian': '"Крошка Мери, да? Она просто прелесть".\n'
        })
        jump label_291

    case 'hend':
    case {'russian': 'хенд'}:
        print({
            'english': '"One o\' the nicest gents I know. Always has a good tale."\n',
            'russian': '"Один из самых приятных джентльменов, которых я знаю. У него всегда есть хорошая история".\n'
        })
        jump label_291

    case 'uber':
    case {'russian': 'убер'}:
        print({
            'english': '"A good, hard worker, that man. Has quite a strong grip too."\n',
            'russian': '"Хороший человек, трудолюбивый работник. И хватка у него довольно крепкая".\n'
        })
        jump label_291

    case 'bye':
    case {'russian': 'пока'}:
        print({
            'english': '"Well, if that\'s all you need, goodbye."\n',
            'russian': '"Что ж, если это всё, что вам нужно, то до свидания".\n'
        })
        bye()

    case '*':
        print({
            'english': 'He sticks a finger in his ear and shakes it. "What?"\n',
            'russian': 'Он засовывает палец в ухо и трясет им. "Чего?"\n'
        })
    esac

    jump label_291

label_1247:
    if equals(integer(value 23), byte 0):
        integer(value 3) = character(byte 0, byte 0)
        jump label_1413
    fi

label_1270:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1284:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2. $Y\n',
        'russian': '#2. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1284
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        print({
            'english': '"Suit yourself."\n',
            'russian': '"Как хотите".\n'
        })
        jump label_291
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1270
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_1413:
    print({
        'english': '"I\'ll sell you a sack of flour for 4 gold. Is that okay?" ',
        'russian': '"Я продам вам мешок муки за 4 золотых. Договорились? '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        if less(plus(canCarry(integer(value 3)), weight(byte 88, byte 4)), weight(byte 167, byte 1)):
            print({
                'english': '"You look pretty full to me."\n',
                'russian': '"На мой взгляд, вы итак достаточно на себе несёте".\n'
            })
            jump label_291
        fi

        if greaterOrEquals(objectsCount(integer(value 3), byte 88), byte 4):
            destroyItem(integer(value 3), byte 88, byte 0, byte 4)
            createItem(integer(value 3), byte 167, byte 0, byte 1)
            print({
                'english': '"Excellent!" $N hands over the flour.\n',
                'russian': '"Отлично!" $N передаёт муку.\n'
            })
            jump label_291

        else:
            print({
                'english': '"You can\'t afford it."\n',
                'russian': '"Вам это не по карману".\n'
            })
            jump label_291
        fi

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Suit yourself."\n',
            'russian': '"Как хотите".\n'
        })
        jump label_291
    esac

label_1665:
    integer(value 0) = byte 0
    integer(value 2) = byte 0
    integer(value 3) = byte 0

label_1686:
    integer(value 1) = byte 0

label_1693:
    if objectsCount(character(integer(value 0), byte 0), byte 166):
        data(integers_2272, integer(value 2)) = integer(value 0)
        integer(value 2) = plus(integer(value 2), byte 1)
        integer(value 3) = byte 1
        jump label_1762
    fi

    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 1), byte 7):
        jump label_1693
    fi

label_1762:
    integer(value 0) = plus(integer(value 0), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1686
    fi

    if equals(integer(value 3), byte 0):
        print({
            'english': '"I\'d buy some grain, if you had any."\n',
            'russian': '"Я бы купил немного зерна, если бы у вас оно было".\n'
        })
        jump label_291
    fi

    if equals(integer(value 2), byte 1):
        integer(value 3) = character(data(integers_2272, byte 0), byte 0)
        jump label_2020
    fi

label_1865:
    integer(value 0) = byte 0
    integer(value 1) = byte 1

label_1879:
    look(character(data(integers_2272, integer(value 0)), byte 0))
    print({
        'english': '#1. $Y\n',
        'russian': '#1. $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 1) = plus(integer(value 1), byte 1)

    if less(integer(value 0), integer(value 2)):
        jump label_1879
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"У кого из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        print({
            'english': '"Suit yourself."\n',
            'russian': '"Как хотите".\n'
        })
        jump label_291
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greaterOrEquals(integer(value 3), integer(value 2)):
        jump label_1865
    fi

    integer(value 3) = character(data(integers_2272, integer(value 3)), byte 0)

label_2020:
    integer(value 4) = objectsCount(integer(value 3), byte 166)
    look(integer(value 3))

    if equals(integer(value 4), byte 0):
        print({
            'english': '"But ya don\'t have any grain!"\n',
            'russian': '"Но у вас нет зерна!"\n'
        })
        jump label_291
    fi

    print({
        'english': '$N turns to $Y, and says "I\'ll pay you 3 crowns for that sack of ',
        'russian': '$N поворачивается к своему клиенту и говорит: "$Y, я заплачу вам 3 кроны за этот мешок '
    })
    print({
        'english': 'grain, ok?" ',
        'russian': 'зерна, идёт?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        print({
            'english': '"Done!" He hands $Y 3 gold pieces and takes the sack.\n',
            'russian': '"По рукам!" $Y отдаёт 3 золотые монеты и забирает мешок.\n'
        })
        destroyItem(integer(value 3), byte 166, byte 0, byte 1)
        createItem(integer(value 3), byte 88, byte 0, byte 3)
        jump label_291

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Suit yourself."\n',
            'russian': '"Как хотите".\n'
        })
        jump label_291
    esac

integers_2272 = [
    0, // 0
    0, // 1
    0, // 2
    0, // 3
    0, // 4
    0, // 5
    0, // 6
    0, // 7
]

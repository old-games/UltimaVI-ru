source('CONVERSE.A')
index(70)

id(70)
name({
    'english': 'Dale',
    'russian': 'Дейл'
})

description:
    print({
        'english': 'a short, barrel-chested man.',
        'russian': 'невысокого мужчину с широкой грудью.'
    })

    f3()

interaction:
    wait()

    print({
        'english': '\n"A good $T to thee, Avatar."',
        'russian': '\n"Доброго $T тебе, Аватар".'
    })
    jump label_107

label_72:
    print({
        'english': '\n"Anything else can I do for thee?"',
        'russian': '\n"Могу я ещё что-нибудь для тебя сделать?"'
    })

label_107:
    print({
        'english': '\n',
        'russian': '\n'
    })

    ask()

    case 'name':
    case {'russian': 'имя'}:
        print({
            'english': '"I am Dale the @Glassblower."',
            'russian': '"Я Дейл-@Стеклодув".'
        })
        setBit(byte 235, value 0)
        jump label_107

    case 'job':
    case {'russian': 'раб'}:
        print({
            'english': '"I make @glassware, the finest in the land!"',
            'russian': '"Я делаю изделия из @стекла, самые лучшие в стране!"'
        })
        jump label_107

    case 'glas':
    case {'russian': 'стек'}:
        print({
            'english': '"If you\'d like to @buy some of my glassware, just say the word!"',
            'russian': '"Если вы захотите @купить что-нибудь из моих изделий, только скажите!"'
        })
        jump label_107

    case 'swor':
    case {'russian': 'меч'}:
        print({
            'english': '"Aye, I know how to make glass swords."',
            'russian': '"Да, я знаю, как делать стеклянные мечи".'
        })
        wait()

        print({
            'english': '\n\n"But there is little @demand for them."',
            'russian': '\n\n"Но @спрос на них невелик".'
        })
        jump label_107

    case 'dema':
    case {'russian': 'спро'}:
        print({
            'english': '"I require five gems for the crafting. This is too expensive for ',
            'russian': '"Мне нужно пять драгоценных камней для его изготовления. Для большинства это слишком '
        })
        print({
            'english': 'most."',
            'russian': 'дорого".'
        })
        wait()

        print({
            'english': '\n\n"Aye, but things of @beauty they are..."',
            'russian': '\n\n"Дорого, но @красота работы стоит того..."'
        })
        jump label_107

    case 'beau':
    case {'russian': 'крас'}:
        print({
            'english': '"Thou seemst like a person who appreciates art."',
            'russian': '"Ты выглядишь как человек, который ценит искусство".'
        })
        wait()

        print({
            'english': '\n\n"I\'ll make thee one, if thou hast the @gems."',
            'russian': '\n\n"Я сделаю тебе такой меч, если у тебя будут @драгоценные камни".'
        })
        jump label_107

    case 'crys':
    case {'russian': 'крис'}:
    case 'lens':
    case {'russian': 'линз'}:
    case 'tele':
    case {'russian': 'теле'}:
        print({
            'english': '"Hmmm...You\'d have to see a lensmaker about that."',
            'russian': '"Хммм... Тебе нужно обратиться к мастеру по изготовлению линз".'
        })
        wait()

        print({
            'english': '\n\n"I hear there\'s one near the Lycaeum."',
            'russian': '\n\n"Я слышал, что один такой живёт рядом с Лицеем".'
        })
        jump label_107

    case 'buy':
    case {'russian': 'купи'}:
        if notEquals(integer(value 32), byte 144):
            print({
                'english': '"Come to my shop when it\'s open!"',
                'russian': '"Приходите в мой магазин, когда он откроется!"'
            })
            jump label_107

        else:
            jump label_1553
        fi

    case 'gems':
    case {'russian': 'драг'}:
        if notEquals(integer(value 32), byte 144):
            print({
                'english': '"Come to my shop when it\'s open!"',
                'russian': '"Приходите в мой магазин, когда он откроется!"'
            })
            jump label_107
        fi

        integer(value 0) = partyHasObject(byte 77, byte 0)

        if equals(integer(value 0), word 32769):
            print({
                'english': '"Aye, a glass sword needs fine gems to complete its beauty!"',
                'russian': '"Но стеклянному мечу нужны драгоценные камни, чтобы подчеркнуть его красоту!"'
            })
            jump label_107

        else:
            jump label_963
        fi

    case 'bye':
    case {'russian': 'пока'}:
        print({
            'english': '"A fine $T to thee!"\n',
            'russian': '"Доброго $T тебе!"\n'
        })
        bye()

    case '*':
        print({
            'english': '"Sorry?"',
            'russian': '"Простите?"'
        })
        jump label_107
    esac

label_963:
    look(integer(value 0))

    if less(objectsCount(integer(value 0), byte 77), byte 5):
        print({
            'english': '"Sorry, $Y, you haven\'t enough gems."',
            'russian': '"Извините, $Y, у вас недостаточно драгоценных камней".'
        })
        jump label_107
    fi

    print({
        'english': '"Aye, $Y, I see the gems you carry."',
        'russian': '"Да, $Y, я вижу, что у вас достаточно драгоценных камней".'
    })
    wait()

    print({
        'english': '\n\n"Dost thou wish me to craft thee a glass sword?" ',
        'russian': '\n\n"Ты хочешь, чтобы я изготовил для тебя стеклянный меч?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        print({
            'english': '"It will cost thee 5 gems! Art thou certain?" ',
            'russian': '"Это будет стоить тебе 5 драгоценных камней! Ты уверен?" '
        })
        jump label_1230

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Hmm," he scowls, "perhaps I was mistaken about thee..."',
            'russian': '"Хм, - хмурится он, - возможно, я ошибся на твой счёт..."'
        })
        jump label_107
    esac

label_1230:
    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        if less(plus(canCarry(integer(value 0)), weight(byte 77, byte 5)), weight(byte 48, byte 1)):
            print({
                'english': '"But thou cannot carry such a sword!"',
                'russian': '"Но ты не сможешь поднять этот меч!"'
            })
            jump label_107
        fi

        destroyItem(integer(value 0), byte 77, byte 0, byte 5)
        print({
            'english': '$N turns to the furnace and begins crafting the sword.',
            'russian': '$N поворачивается к печи и начинает изготавливать меч.'
        })
        wait()

        print({
            'english': '\n\nSoon it is finished, and you marvel at its beauty!',
            'russian': '\n\nВскоре работа завершается, и вы восхищаетесь её красотой!'
        })
        wait()

        print({
            'english': '\n\n"There she is, and a finer work thou\'lt never see!"',
            'russian': '\n\n"Вот, и более прекрасной работы вы никогда не увидите!"'
        })
        createItem(integer(value 0), byte 48, byte 0, byte 1)
        jump label_107

    case 'n':
    case {'russian': 'н'}:
        print({
            'english': '"Hmm," he scowls, "perhaps I was mistaken about thee..."',
            'russian': '"Хм, - хмурится он, - возможно, я ошибался на твой счёт..."'
        })
        jump label_107
    esac

label_1553:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 0
        jump label_1689
    fi

label_1573:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_1587:
    look(character(integer(value 0), byte 0))
    print({
        'english': '#2) $Y\n',
        'russian': '#2) $Y\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_1587
    fi

    print({
        'english': '"Which of you?" ',
        'russian': '"Кто из вас?" '
    })
    inputDigit(integer(value 3))

    if equals(integer(value 3), byte 0):
        jump label_72
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_1573
    fi

label_1689:
    integer(value 3) = character(integer(value 3), byte 0)
    integer(value 0) = byte 1
    look(integer(value 3))

label_1710:
    string(value 0) = data(strings_2159, minus(integer(value 0), byte 1))
    print({
        'english': '#0) $0\n',
        'russian': '#0) $0\n'
    })
    integer(value 0) = plus(integer(value 0), byte 1)

    if notEquals(data(integers_2151, minus(integer(value 0), byte 1)), byte 0):
        jump label_1710
    fi

    integer(value 7) = integer(value 0)
    print({
        'english': '"Which item?" ',
        'russian': '"Какой товар?" '
    })
    inputDigit(integer(value 0))

    if equals(integer(value 0), byte 0):
        jump label_72
    fi

    if greaterOrEquals(integer(value 0), integer(value 7)):
        jump label_1689
    fi

    integer(value 0) = minus(integer(value 0), byte 1)
    integer(value 1) = data(integers_2145, integer(value 0))
    string(value 1) = data(strings_2159, integer(value 0))
    print({
        'english': '"That $1 costs #1 gold."',
        'russian': '"$1 стоит #1 золота."'
    })
    wait()

    print({
        'english': '\n\n"Interested, $Y?" ',
        'russian': '\n\n"Вас это интересует, $Y?" '
    })

    choice({
        'english': 'yn',
        'russian': 'дн'
    })

    case 'y':
    case {'russian': 'д'}:
        jump label_1916

    case 'n':
    case {'russian': 'н'}:
        jump label_1689
    esac

label_1916:
    if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(integers_2151, integer(value 0)), byte 1)):
        print({
            'english': '"But \'twould make thee o\'erburdened, $Y!"',
            'russian': '"Но это будет для вас слишком обременительно, $Y!"'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_72
    fi

    if greaterOrEquals(objectsCount(integer(value 3), byte 88), integer(value 1)):
        destroyItem(integer(value 3), byte 88, byte 0, integer(value 1))
        createItem(integer(value 3), data(integers_2151, integer(value 0)), byte 0, byte 1)
        print({
            'english': '"Excellent!"\n\nAfter accepting $Y\'s gold, $N hands over the $1.',
            'russian': '"Отлично!"\n\nКак только $Y отдаёт золото, $N передаёт $1.'
        })
        wait()

        print({
            'english': '\n\n',
            'russian': '\n\n'
        })
        jump label_1689

    else:
        print({
            'english': '"But thou hast not enough gold, $Y!"',
            'russian': '"Но $Y!, у тебя недостаточно золота!"'
        })
        wait()

        print({
            'english': '\n',
            'russian': '\n'
        })
        jump label_72
    fi

integers_2145 = [
    5,  // 0
    5,  // 1
    85, // 2
]

integers_2151 = [
    118, // 0
    183, // 1
    123, // 2
    0,   // 3
]

strings_2159 = [
    {
        'english': 'Glass',
        'russian': 'Бокал'
    }, // 0
    {
        'english': 'Jar',
        'russian': 'Банка'
    }, // 1
    {
        'english': 'Mirror',
        'russian': 'Зеркало'
    }, // 2
]

source("CONVERSE.A")
index(79)

id(79)
name("Brandon")

description:
    print("a golden-haired young man.")
    wait()

interaction:
    integer(value 8) = byte 6

    if hasBit(byte 235, value 0):
    print("\"Avatar! Good $T, $G! How has thy quest gone?\"")

    else:
    print("\"Hey! The Avatar! Good $T, $G!\"")
    wait()

    print("\n\n\"You've come to me to aid thee in thy quest! What an honor!\"")
    ('SETF', ('byte', 235), ('value', 0))

    endif

    wait()

    jump 236

205:
    print("\n\"What else can I do for thee?\"\n")

236:
    print("\n")

    ask()
    case "buy":
    print("\"I have a large inventory, so be more specific:\"")
    wait()

    print("\n\n\"Dost thou want @arms or @armor?\"")
    jump 236

    case "arms":

    if notEquals(integer(value 32), byte 144):
    print("\"Come by my shop when I'm open!\"")
    jump 236

    else:
    integer(value 9) = byte 0
    jump 2157

    endif

    case "armo":

    if notEquals(integer(value 32), byte 144):
    print("\"Come by my shop when I'm open!\"")
    jump 236

    else:
    integer(value 9) = integer(value 8)
    jump 2157

    endif

    case "sell":

    if notEquals(integer(value 32), byte 144):
    print("\"Come by my shop when I'm open!\"")
    jump 236

    else:
    jump 1235

    endif

    case "job":
    print("\"Oh, I'm not important like you. I'm just a weaponsmith--and only a @journeyman at that.\"")
    jump 236

    case "jour":
    print("\"Aye, just a few years ago I was a simple apprentice.\"")
    wait()

    print("\n\n\"Now I @supply arms to all Trinsic!\"")
    jump 236

    case "name":
    print("\"My name's Brandon, $G, and I'm honored to meet thee!\"")
    jump 236

    case "join":
    print("\"That would be a great honor! I'd love to!\"")
    wait()

    print("\n\nThe man comes to his senses.")
    wait()

    print("\n\n\"But no, I can't. I've responsibilites here, especially @now.\"")
    jump 236

    case "well,good,fine,okay,grea":
    print("\"And glad I am to hear it!\"")
    jump 236

    case "now,supp":
    print("\"I have to make @weapons to help fight the gargoyles!\"")
    jump 236

    case "bye,noth":
    print("\"Farewell! May thy quest succeed, Avatar!\"\n")
    bye()

    case "weap":
    print("\"Perhaps you'd like to @buy some. I'd be honored to have thee as a customer.\"")
    jump 236

    case "*":
    print("\"Beg pardon, $G?\"")
    jump 236

1235:
    integer(value 0) = byte 0
    integer(value 2) = byte 0
    integer(value 3) = byte 0
    integer(value 1) = byte 0

    if hasObject(character(integer(value 0), byte 0), data(dword 2806, integer(value 1)), byte 0):
    data(dword 2975, integer(value 2)) = integer(value 0)
    integer(value 2) = plus(integer(value 2), byte 1)
    integer(value 3) = byte 1
    jump 1343

    endif

    integer(value 1) = plus(integer(value 1), byte 1)

    if data(dword 2806, integer(value 1)):
    jump 1263

    endif

    integer(value 0) = plus(integer(value 0), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
    jump 1256

    endif

    if equals(integer(value 3), byte 0):
    print("\"Sorry, none of you has anything I need.\"")
    wait()

    print("\n")
    jump 205

    endif

    if equals(integer(value 2), byte 1):
    integer(value 3) = character(data(dword 2975, byte 0), byte 0)
    ('SETNAME', ('integer', [('value', 3)]))
    print("\"Aye, $Y has something of interest...\"")
    wait()

    print("\n\n")
    jump 1620

    endif

    integer(value 1) = byte 1
    ('SETNAME', ('character', [('data', [('dword', 2975), ('minus', [('integer', [('value', 1)]), ('byte', 1)])]), ('byte', 0)]))
    print("#1) $Y\n")
    integer(value 1) = plus(integer(value 1), byte 1)

    if lessOrEquals(integer(value 1), integer(value 2)):
    jump 1503

    endif

    print("\"Which of you?\" ")
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
    jump 2126

    endif

    integer(value 3) = minus(integer(value 3), byte 1)

    if greaterOrEquals(integer(value 3), integer(value 2)):
    jump 1496

    endif

    integer(value 3) = character(data(dword 2975, integer(value 3)), byte 0)
    integer(value 0) = byte 0
    integer(value 5) = byte 0

    if equals(hasObject(integer(value 3), data(dword 2806, integer(value 0)), byte 0), byte 0):
    jump 1681

    endif

    data(dword 2945, integer(value 5)) = integer(value 0)
    integer(value 5) = plus(integer(value 5), byte 1)
    integer(value 0) = plus(integer(value 0), byte 1)

    if data(dword 2806, integer(value 0)):
    jump 1634

    endif

    if equals(integer(value 5), byte 1):
    integer(value 6) = data(dword 2945, byte 0)
    jump 1845

    endif

    integer(value 0) = byte 1
    print("#0) ")
    ('DPRINT', [('data', [('dword', 2945), ('minus', [('integer', [('value', 0)]), ('byte', 1)])]), ('dword', 2830)])
    print("\n")
    integer(value 0) = plus(integer(value 0), byte 1)

    if lessOrEquals(integer(value 0), integer(value 5)):
    jump 1740

    endif

    print("\"Which item?\" ")
    ('INPUTNUM', 6)

    if greater(integer(value 6), integer(value 5)):
    jump 1620

    endif

    if equals(integer(value 6), byte 0):
    jump 2126

    endif

    integer(value 6) = data(dword 2945, minus(integer(value 6), byte 1))
    string(value 0) = data(dword 2830, integer(value 6))
    integer(value 7) = divide(data(dword 2784, integer(value 6)), byte 2)
    ('SETNAME', ('integer', [('value', 3)]))
    print("\"Will you take #7 gold for that $0, $Y?\" ")

    askc("yn")
    case "n":

    if equals(integer(value 5), byte 1):
    print("\"Perhaps some other time, then.\"")
    wait()

    print("\n")
    jump 205

    else:
    print("\"Perhaps something else then?\"")
    wait()

    print("\n\n")
    jump 1620

    endif

    case "y":
    ('SETNAME', ('integer', [('value', 3)]))
    print("\"Done!\" $N hands $Y #7 gold pieces and takes the $0.")
    ('DELETE', ('integer', [('value', 3)]), ('data', [('dword', 2806), ('integer', [('value', 6)])]), ('byte', 0), ('byte', 1))
    ('NEW', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 7)]))

    if equals(integer(value 5), byte 1):
    print("\n")
    jump 205

    else:
    wait()

    print("\n\n")
    jump 1620

    endif

2126:
    print("\"Changed your mind, eh?\"")
    wait()

    print("\n")
    jump 205

2157:
    if equals(integer(value 23), byte 0):
    integer(value 3) = byte 1
    jump 2303

    endif

    integer(value 0) = byte 0
    integer(value 2) = byte 1
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print("#2) $Y\n")
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
    jump 2191

    endif

    print("\"Which of you?\" ")
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
    jump 2126

    endif

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
    jump 2177

    endif

    integer(value 3) = character(integer(value 3), byte 0)
    integer(value 0) = byte 1
    string(value 0) = data(dword 2830, plus(integer(value 9), minus(integer(value 0), byte 1)))
    print("#0) $0\n")
    integer(value 0) = plus(integer(value 0), byte 1)

    if and(integer(value 9), notEquals(data(dword 2806, plus(integer(value 9), minus(integer(value 0), byte 1))), byte 0)):
    jump 2310

    endif

    if and(equals(integer(value 9), byte 0), lessOrEquals(integer(value 0), integer(value 8))):
    jump 2310

    endif

    integer(value 7) = integer(value 0)
    print("\"Which item?\" ")
    ('INPUTNUM', 0)

    if equals(integer(value 0), byte 0):
    jump 2126

    endif

    if greaterOrEquals(integer(value 0), integer(value 7)):
    jump 2303

    endif

    integer(value 0) = minus(plus(integer(value 9), integer(value 0)), byte 1)
    integer(value 1) = data(dword 2784, integer(value 0))
    string(value 1) = data(dword 2830, integer(value 0))
    print("\"That $1 costs #1 gold.\"")
    wait()

    print("\n\n\"Interested?\" ")

    askc("yn")
    case "y":
    jump 2543

    case "n":
    jump 2303

2543:
    if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(dword 2806, integer(value 0)), byte 1)):
    ('SETNAME', ('integer', [('value', 3)]))
    print("\"But 'twould make thee o'erburdened, $Y!\"")
    wait()

    print("\n")
    jump 205

    endif

    if greaterOrEquals(objectsCount(integer(value 3), byte 88), integer(value 1)):
    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 1)]))
    ('NEW', ('integer', [('value', 3)]), ('data', [('dword', 2806), ('integer', [('value', 0)])]), ('byte', 0), ('byte', 1))
    ('SETNAME', ('integer', [('value', 3)]))
    print("\"Excellent!\"\n\nAfter accepting $Y's gold, $N hands over the $1.")
    wait()

    print("\n\n")
    jump 2303

    else:
    ('SETNAME', ('integer', [('value', 3)]))
    print("\"But thou hast not enough gold, $Y!\"")
    wait()

    print("\n")
    jump 205

    endif

2784:
    ['INTEGERS', [35, 20, 40, 50, 55, 75, 15, 25, 350, 200, 100]]

2806:
    ['INTEGERS', [39, 35, 43, 45, 44, 46, 3, 12, 23, 8, 22, 0]]

2830:
    ['STRINGS', ['Mace', 'Main Gauche', 'Sword', '2-Hnd Axe', '2-Hnd Hammer', '2-Hnd Sword', 'Iron Helm', 'Kite Shield', 'Magic Armour', 'Magic Helm', 'Plate Mail']]

2945:
    ['INTEGERS', [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

2975:
    ['INTEGERS', [0, 0, 0, 0, 0, 0, 0, 0]]

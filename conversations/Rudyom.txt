source('CONVERSE.B')
index(29)

id(128)
name('Rudyom')

description:
    print('a dark, bearded man dressed in flowing white robes.')

    f3()

interaction:
    wait()

    print('\n"Greetings, mighty Avatar. For what hast thou come to my place?"\n')

label_129:
    ask()

    case 'buy':
    case 'reag':
        jump label_1490

    case 'lear':
    case 'spel':
        jump label_345

    case 'book':
        jump label_2305

    case 'name':
        print('"I am Rudyom."')
        ('SETF', ('byte', 235), ('value', 0))
        jump label_128

    case 'job':
        print('"I sell magic @books and @reagents, and teach @spells."')
        jump label_128

    case 'bye':
        print('"May peace follow thee, Avatar."\n')
        bye()

    case '*':
        print('"Of that I will say nothing."')
        jump label_128
    esac

label_345:
    if notEquals(integer(value 32), byte 144):
        print('"My shop is closed right now."')
        jump label_128
    fi

    if greater(integer(value 23), byte 0):
        integer(value 1) = byte 0
        integer(value 2) = byte 0
        integer(value 4) = byte 0
        jump label_486
    fi

    integer(value 3) = character(byte 0, byte 0)

    if hasObject(integer(value 3), byte 57, byte 0):
        jump label_784

    else:
        print('"But thou hast not a spell@book!"')
        jump label_128
    fi

label_486:
    if greater(integer(value 1), integer(value 23)):
        jump label_600
    fi

    integer(value 3) = character(integer(value 1), byte 0)

    if equals(hasObject(integer(value 3), byte 57, byte 0), byte 0):
        jump label_585
    fi

    if equals(integer(value 4), byte 0):
        integer(value 4) = integer(value 3)
        integer(value 2) = plus(integer(value 2), byte 1)
        jump label_585
    fi

    ('SETNAME', ('integer', [('value', 4)]))
    print('#2) $Y\n')
    integer(value 2) = plus(integer(value 2), byte 1)
    integer(value 4) = integer(value 3)

label_585:
    integer(value 1) = plus(integer(value 1), byte 1)
    jump label_486

label_600:
    if equals(integer(value 2), byte 0):
        print('"But none of you has a spell@book!"')
        jump label_128
    fi

    if equals(integer(value 2), byte 1):
        integer(value 3) = integer(value 4)
        jump label_784
    fi

    ('SETNAME', ('integer', [('value', 4)]))
    print('#2) $Y\n"Which of you?" ')
    ('INPUTNUM', 2)

    if equals(integer(value 2), byte 0):
        jump label_129
    fi

    integer(value 1) = byte 0

label_718:
    integer(value 3) = character(integer(value 1), byte 0)

    if hasObject(integer(value 3), byte 57, byte 0):
        integer(value 2) = minus(integer(value 2), byte 1)
    fi

    if equals(integer(value 2), byte 0):
        jump label_784
    fi

    integer(value 1) = plus(integer(value 1), byte 1)

    if lessOrEquals(integer(value 1), integer(value 23)):
        jump label_718
    fi

label_784:
    ('SETNAME', ('integer', [('value', 3)]))
    integer(value 1) = level(integer(value 3), byte 0)
    string(value 1) = data(dword 2849, integer(value 1))
    print('"In which Circle does $Y wish to study?" ')
    ('INPUTNUM', 0)

    if equals(integer(value 0), byte 0):
        jump label_128
    fi

    if greater(integer(value 0), byte 8):
        print('"As everybody knows, there are only eight circles."')
        wait()

        print('\n\n')
        jump label_784
    fi

    if greater(integer(value 0), integer(value 1)):
        print('"I sense that $Y is only ready for the #1$1 Circle."')
        wait()

        print('\n\n"But such matters are not my concern..."')
        wait()

        print('\n\n')
    fi

    integer(value 0) = minus(integer(value 0), byte 1)
    integer(value 0) = multiply(integer(value 0), byte 10)

    if equals(data(dword 2876, integer(value 0)), word 255):
        print('"I have no spells of that circle."')
        wait()

        print('\n\n')
        jump label_784
    fi

    integer(value 2) = byte 1

label_1125:
    string(value 0) = data(dword 3036, minus(plus(integer(value 0), integer(value 2)), byte 1))
    print('#2) $0\n')
    integer(value 2) = plus(integer(value 2), byte 1)

    if notEquals(data(dword 2876, minus(plus(integer(value 0), integer(value 2)), byte 1)), word 255):
        jump label_1125
    fi

    print('"Which of these?" ')
    ('INPUTNUM', 4)

    if or(equals(integer(value 4), byte 0), greaterOrEquals(integer(value 4), integer(value 2))):
        print('"Perhaps $Y is not ready for this circle."')
        wait()

        print('\n\n')
        jump label_784
    fi

    integer(value 4) = minus(integer(value 4), byte 1)
    integer(value 5) = plus(byte 20, multiply(integer(value 0), byte 2))

    if less(objectsCount(integer(value 3), byte 88), integer(value 5)):
        print('"$Y lacks the #5 gold required."')
        wait()

        print('\n\n')
        jump label_784
    fi

    print('"That spell costs #5 gold. Interested?" ')

    choice('yn')

    case 'y':
        print('$N hands $Y a piece of rune-covered parchment.')
        ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 5)]))
        ('NEW', ('integer', [('value', 3)]), ('byte', 58), ('data', [('dword', 2876), ('plus', [('integer', [('value', 0)]), ('integer', [('value', 4)])])]), ('byte', 1))
        wait()

        print('\n\n')
        jump label_784

    case 'n':
        jump label_784
    esac

label_1490:
    if notEquals(integer(value 32), byte 144):
        print('"My shop is closed right now."')
        jump label_128
    fi

    if greater(integer(value 23), byte 0):
        integer(value 2) = byte 1
        jump label_1568
    fi

    integer(value 3) = character(byte 0, byte 0)
    jump label_1670

label_1568:
    integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)
    ('SETNAME', ('integer', [('value', 3)]))
    print('#2) $Y\n')

    if lessOrEquals(integer(value 2), integer(value 23)):
        integer(value 2) = plus(integer(value 2), byte 1)
        jump label_1568
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 2)

    if or(equals(integer(value 2), byte 0), greater(integer(value 2), plus(integer(value 23), byte 1))):
        jump label_129

    else:
        integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)
    fi

label_1670:
    ('SETNAME', ('integer', [('value', 3)]))
    integer(value 1) = byte 1

label_1681:
    string(value 1) = data(dword 2782, minus(integer(value 1), byte 1))
    print('#1) $1\n')
    integer(value 1) = plus(integer(value 1), byte 1)

    if greater(data(dword 2750, minus(integer(value 1), byte 1)), byte 0):
        jump label_1681
    fi

    print('"Which of these?" ')
    ('INPUTNUM', 2)

    if or(equals(integer(value 2), byte 0), greaterOrEquals(integer(value 2), integer(value 1))):
        integer(value 2) = byte 1
        jump label_129
    fi

    integer(value 2) = minus(integer(value 2), byte 1)
    integer(value 1) = data(dword 2766, integer(value 2))
    string(value 1) = data(dword 2782, integer(value 2))
    integer(value 5) = byte 0
    print('"$1 costs #1 per portion."')
    wait()

    print('\n\n"How many dost thou want?" ')
    ('INPUT', 4)

    if greater(integer(value 4), word 500):
        integer(value 4) = word 500
    fi

    if equals(integer(value 4), byte 0):
        jump label_1670
    fi

label_1915:
    if less(plus(canCarry(integer(value 3)), weight(byte 88, integer(value 1))), weight(data(dword 2750, integer(value 2)), byte 1)):
        jump label_2043
    fi

    if less(objectsCount(integer(value 3), byte 88), integer(value 1)):
        jump label_2174
    fi

    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('integer', [('value', 1)]))
    ('NEW', ('integer', [('value', 3)]), ('data', [('dword', 2750), ('integer', [('value', 2)])]), ('byte', 0), ('byte', 1))
    integer(value 5) = plus(integer(value 5), byte 1)

    if equals(integer(value 5), integer(value 4)):
        print('$N hands $Y the $1.')
        wait()

        print('\n\n')
        jump label_1670

    else:
        jump label_1915
    fi

label_2043:
    if integer(value 5):
        print('"Thou cannot carry that much!"')
        wait()

        print('\n\n"I\'ll give thee #5; thou dost not need the rest."')
        wait()

        print('\n\n')
        jump label_1670

    else:
        print('"Thou cannot carry any $1!"')
        wait()

        print('\n\n')
        jump label_1670
    fi

label_2174:
    if integer(value 5):
        print('"Thou cannot afford that much!"')
        wait()

        print('\n\n"I\'ll give thee #5; thou cannot have the rest."')
        wait()

        print('\n\n')
        jump label_1670

    else:
        print('"Thou cannot afford any $1!"')
        wait()

        print('\n\n')
        jump label_1670
    fi

label_2305:
    if notEquals(integer(value 32), byte 144):
        wait()

        print('\n\n"My shop is closed right now."')
        jump label_128
    fi

    if integer(value 23):
        integer(value 2) = byte 1
        jump label_2383
    fi

    integer(value 3) = character(byte 0, byte 0)
    jump label_2485

label_2383:
    integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)
    ('SETNAME', ('integer', [('value', 3)]))
    print('#2) $Y\n')

    if lessOrEquals(integer(value 2), integer(value 23)):
        integer(value 2) = plus(integer(value 2), byte 1)
        jump label_2383
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 2)

    if or(equals(integer(value 2), byte 0), greater(integer(value 2), plus(integer(value 23), byte 1))):
        jump label_128

    else:
        integer(value 3) = character(minus(integer(value 2), byte 1), byte 0)
    fi

label_2485:
    ('SETNAME', ('integer', [('value', 3)]))

    if less(plus(canCarry(integer(value 3)), weight(byte 88, byte 50)), weight(byte 57, byte 1)):
        print('"But thou cannot carry a spellbook!"')
        jump label_128
    fi

    if less(objectsCount(integer(value 3), byte 88), byte 50):
        print('"But thou cannot afford a spellbook!"')
        jump label_128
    fi

    print('"A spellbook costs 50 gold pieces. Interested?" ')

    choice('yn')

    case 'y':
        ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('byte', 50))
        ('NEW', ('integer', [('value', 3)]), ('byte', 57), ('byte', 0), ('byte', 1))
        jump label_128

    case 'n':
        if integer(value 23):
            print('"Perhaps one of thy friends then."')
            wait()

            print('\n\n')
            integer(value 2) = byte 1
            jump label_2383

        else:
            jump label_128
        fi
    esac

integers_2750 = [
    66,
    67,
    68,
    70,
    71,
    72,
    0,
    0,
]

integers_2766 = [
    3,
    1,
    2,
    2,
    2,
    1,
    0,
    0,
]

strings_2782 = [
    'Blood Moss',
    'Garlic',
    'Ginseng',
    'Nightshade',
    'Spider Silk',
    'Sulfurous Ash',
    ' ',
    ' ',
]

strings_2849 = [
    'th',
    'st',
    'nd',
    'rd',
    'th',
    'th',
    'th',
    'th',
    'th',
]

integers_2876 = [
    0,
    4,
    6,
    8,
    255,
    255,
    255,
    255,
    255,
    255,
    255,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    37,
    255,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    52,
    255,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    70,
    72,
    255,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    255,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    255,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    117,
    255,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
]

strings_3036 = [
    'Create Food',
    'Douse',
    'Heal',
    'Ignite',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    'Mass Awaken',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    'Great Heal',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    'Pickpocket',
    'Seance',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    'Resurrect',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
    ' ',
]

source('CONVERSE.A')
index(15)

id(15)
name('Anya')

description:
    print('a buxom woman who looks hard working, yet contented.')
    wait()

    print('\n')

interaction:
    integer(value 5) = byte 0

    if equals(integer(value 32), byte 144):
        jump label_177
    fi

    print('"I\'m sorry, $G, but I\'ve just an hour to myself today."')
    wait()

    print('\n\n"I\'ll gladly talk with thee later."\n')
    bye()

label_177:
    print('"Good $T, $G, and welcome to the Blue Boar Tavern. Art thou here for ')
    print('@business or @pleasure?"')
    jump label_309

label_275:
    print('"Anything else I can do for thee?"\n')

label_309:
    print('\n')

    ask()

    case 'name':
        print('"I am Anya."')
        jump label_309

    case 'gyps':
        print('"They pass by Britain occasionally. I believe they travel on the ')
        print('King\'s @Way."')
        jump label_309

    case 'king':
    case 'way':
        print('"The King\'s Way is the oldest road in Britain."')
        jump label_309

    case 'job':
    case 'work':
        print('"I run this tavern to support my @family. The hours are long, but my ')
        print('husband offers what help he can."')
        wait()

        print('\n\n"We make enough to pay for my daughter\'s schooling, so \'tis all ')
        print('worthwhile."')
        jump label_309

    case 'fami':
    case 'supp':
        print('"My husband @Matt, and my daughter @Ariana."')
        jump label_309

    case 'husb':
    case 'matt':
        print('"He had an accident as a child which left him deaf and dumb, but I ')
        print('love him all the same."')
        wait()

        print('\n\n"I only @wish he could hear our daughter play, just once."')
        wait()

        print('\n\n"But \'twill ne\'er come to pass. He lives in a world of eternal ')
        print('silence."')
        jump label_309

    case 'acci':
    case 'deaf':
    case 'dumb':
    case 'sile':
    case 'wish':
        print('Her face brightens suddenly. "You have the look of one who practices ')
        print('the art of magic."')
        wait()

        print('\n\n"Perhaps thou couldst find some spell that might restore my ')
        print('husband\'s hearing!"')
        wait()

        print('\n\n"I know \'tis a lot to ask, but wilt thou try?" ')
        jump label_3001

    case 'aria':
    case 'daug':
        print('"Ariana is the light of my life. Seems she had scarce learned to walk ')
        print('when she first showed a gift for music."')
        wait()

        print('\n\n"She studies now with the @bards at the Conservatory."')
        jump label_309

    case 'bard':
    case 'cons':
    case 'musi':
        print('"Bless their hearts for teaching her well. She\'ll be no tavern wench ')
        print('when she grows older."')
        wait()

        print('\n\n"Perhaps she\'ll even be court musician to Lord British some day..."')
        jump label_309

    case 'mant':
        print('"Thou shouldst ask my daughter of that. Methinks the bards have taught')
        print(' her of it."')
        jump label_309

    case 'borr':
    case 'comp':
    case 'perm':
    case 'rune':
        if equals(hasBit(byte 13, byte 7), byte 0):
            jump label_2546
        fi

        if hasBit(byte 13, byte 5):
            jump label_2817
        fi

        print('"I already gave thee my permission to borrow the rune!"')
        wait()

        print('\n"Do thou be careful not to lose the stone or let any harm befall it. ')
        print('Ariana would never forgive herself."')
        jump label_309

    case 'plea':
        if hasBit(byte 235, value 0):
            print('"\'Tis good to talk with thee again. Things have been slow around here ')
            print('since the @gypsies left."')

        else:
            print('"Good! Perhaps thou might stay and talk with me a while, before I\'m ')
            print('back about my work."')
        fi

        jump label_309

    case 'cake':
        jump label_3778

    case 'mead':
        integer(value 4) = byte 0
        jump label_3236

    case 'ale':
        integer(value 4) = byte 1
        jump label_3236

    case 'wine':
        integer(value 4) = byte 2
        jump label_3236

    case 'rati':
        jump label_4248

    case 'bye':
        if hasBit(byte 235, value 0):
            print('"Come back any time."\n')
            bye()
        fi

        print('"Well, \'tis time I was back about my work. Dishes to wash, food to ')
        print('cook, drinks to serve..."')
        wait()

        print('\n\n"I thank thee for stopping by to brighten my day with thy ')
        print('conversation. Do thou come again."\n')
        ('SETF', ('byte', 235), ('value', 0))
        bye()

    case 'busi':
    case 'buy':
    case 'sell':
    case 'y':
        print('"Wouldst thou like @ale, @mead, @wine, @rations, or perhaps a @cake?"')
        jump label_309

    case '*':
        print('"I cannot help thee with that."')
    esac

    jump label_309

label_2546:
    print('"Ah, twas the proudest moment of my life when they awarded my dear ')
    print('little Ariana the Rune of Compassion."')
    wait()

    print('\n\n"They said she was the most promising student they\'d ever had at the')
    print(' Conservatory."')
    wait()

    print('\n\n"I\'m sure she would show thee the rune, if thou wouldst care to see ')
    print('it."')
    jump label_309

label_2817:
    print('"Thou dost wish to borrow the Rune of Compassion from my daughter?" ')
    print('She pauses a while in thought.')
    wait()

    print('\n\n"Very well--thou dost have an honest face. I grant thee my ')
    print('permission."')
    ('CLEARF', ('byte', 13), ('byte', 5))
    jump label_309

label_3001:
    choice('yn')

    case 'y':
        print('"Oh, thank you, $G!"')

    case 'n':
        print('Her look of hope changes to one of sorrow as she looks down at the ')
        print('floor to hide her embarrassment.')
        wait()

        print('\n\n"I\'m sorry to have bothered thee," she says. "I\'m sure thou hast ')
        print('more important things to do."')
        ('SUB_KARMA', ('byte', 5))
    esac

    jump label_309

label_3236:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 0
        jump label_3372
    fi

label_3256:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_3270:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_3270
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump label_3749
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_3256
    fi

label_3372:
    ('SETNAME', ('character', [('integer', [('value', 3)]), ('byte', 0)]))
    integer(value 1) = data(dword 4958, integer(value 4))
    print('"That\'ll be #1 crowns, $Y. Wouldst thou like some?" ')

    choice('yn')

    case 'y':
        jump label_3471

    case 'n':
        integer(value 5) = byte 0
        jump label_3749
    esac

label_3471:
    integer(value 9) = character(integer(value 3), byte 0)

    if less(objectsCount(integer(value 9), byte 88), integer(value 1)):
        print('"I\'m sorry, but you don\'t have enough gold."')
        wait()

        print('\n\n')
        jump label_275
    fi

    if less(plus(canCarry(integer(value 9)), weight(byte 88, integer(value 1))), weight(data(dword 4964, integer(value 4)), byte 1)):
        print('"You don\'t have room to carry it."')
        integer(value 5) = byte 0
        jump label_3749
    fi

    ('DELETE', ('character', [('integer', [('value', 3)]), ('byte', 0)]), ('byte', 88), ('byte', 0), ('integer', [('value', 1)]))
    ('NEW', ('character', [('integer', [('value', 3)]), ('byte', 0)]), ('data', [('dword', 4964), ('integer', [('value', 4)])]), ('byte', 0), ('byte', 1))
    ('SETNAME', ('character', [('integer', [('value', 3)]), ('byte', 0)]))
    print('"Fine!" After accepting $Y\'s gold, $N hands over the purchase.')
    wait()

    integer(value 5) = byte 1
    string(value 1) = data(dword 4970, integer(value 4))
    print('\n\n')
    jump label_3749

label_3749:
    if integer(value 5):
        print('"Enjoy your $1."')
        wait()
    fi

    print('\n\n')
    jump label_275

label_3778:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 0
        jump label_3914
    fi

label_3798:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_3812:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_3812
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump label_4207
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_3798
    fi

label_3914:
    ('SETNAME', ('character', [('integer', [('value', 3)]), ('byte', 0)]))
    print('$N asks $Y, "It\'ll be 8 gold for the cake. Is that alright?" ')

    choice('yn')

    case 'y':
        integer(value 9) = character(integer(value 3), byte 0)

        if less(objectsCount(integer(value 9), byte 88), byte 8):
            print('"I\'m sorry, but you don\'t have enough gold."')
            wait()

            print('\n\n')
            jump label_275
        fi

        if less(plus(canCarry(integer(value 9)), weight(byte 88, byte 8)), weight(byte 131, byte 1)):
            print('"You don\'t have room to carry it."')
            integer(value 5) = byte 0
            jump label_4207
        fi

        ('DELETE', ('integer', [('value', 9)]), ('byte', 88), ('byte', 0), ('byte', 8))
        ('NEW', ('integer', [('value', 9)]), ('byte', 131), ('byte', 0), ('byte', 1))
        ('SETNAME', ('integer', [('value', 9)]))
        print('$N gives $Y the cake.')
        wait()

        integer(value 5) = byte 1
        print('\n\n')
        jump label_4207

    case 'n':
        integer(value 5) = byte 0
        jump label_4207
    esac

label_4207:
    if integer(value 5):
        print('"I hope thou dost enjoy it!"')
        wait()
    fi

    print('\n\n')
    jump label_275

label_4248:
    if equals(integer(value 23), byte 0):
        integer(value 3) = byte 1
        jump label_4394
    fi

label_4268:
    integer(value 0) = byte 0
    integer(value 2) = byte 1

label_4282:
    ('SETNAME', ('character', [('integer', [('value', 0)]), ('byte', 0)]))
    print('#2. $Y\n')
    integer(value 0) = plus(integer(value 0), byte 1)
    integer(value 2) = plus(integer(value 2), byte 1)

    if lessOrEquals(integer(value 0), integer(value 23)):
        jump label_4282
    fi

    print('"Which of you?" ')
    ('INPUTNUM', 3)

    if equals(integer(value 3), byte 0):
        jump label_275
    fi

    integer(value 3) = minus(integer(value 3), byte 1)

    if greater(integer(value 3), integer(value 23)):
        jump label_4268
    fi

    integer(value 3) = character(integer(value 3), byte 0)

label_4394:
    ('SETNAME', ('integer', [('value', 3)]))

    if or(less(plus(canCarry(integer(value 3)), weight(byte 88, byte 4)), weight(byte 129, byte 1)), less(objectsCount(integer(value 3), byte 88), byte 4)):
        integer(value 9) = byte 1
        jump label_4548
    fi

    print('"My price is 4 gold for each ration. How many do you want, $Y?" ')
    ('INPUT', 9)

    if greater(integer(value 9), word 200):
        integer(value 9) = word 200
    fi

    integer(value 8) = integer(value 9)

    if equals(integer(value 9), byte 0):
        jump label_275
    fi

    integer(value 0) = byte 0

label_4548:
    integer(value 6) = byte 0
    integer(value 7) = byte 0

    if less(plus(canCarry(integer(value 3)), weight(byte 88, byte 4)), weight(byte 129, integer(value 9))):
        integer(value 6) = byte 1
        integer(value 0) = byte 1
        integer(value 9) = minus(integer(value 9), byte 1)
        jump label_4650
    fi

    if less(objectsCount(integer(value 3), byte 88), multiply(integer(value 9), byte 4)):
        integer(value 7) = byte 1
        integer(value 9) = minus(integer(value 9), byte 1)
        jump label_4650
    fi

    jump label_4774

label_4650:
    if integer(value 9):
        jump label_4548
    fi

    if integer(value 6):
        ('SETNAME', ('integer', [('value', 3)]))
        print('"You haven\'t any room in your pack."')
        wait()

        print('\n\n')
        jump label_275
    fi

    if integer(value 7):
        ('SETNAME', ('integer', [('value', 3)]))
        print('"I\'m sorry, but you don\'t have enough gold."')
        wait()

        print('\n\n')
        jump label_275
    fi

label_4774:
    ('DELETE', ('integer', [('value', 3)]), ('byte', 88), ('byte', 0), ('multiply', [('integer', [('value', 9)]), ('byte', 4)]))
    ('NEW', ('integer', [('value', 3)]), ('byte', 129), ('byte', 0), ('integer', [('value', 9)]))

    if equals(integer(value 8), integer(value 9)):
        ('SETNAME', ('integer', [('value', 3)]))
        print('$N hands the rations to $Y.')
        wait()

        print('\n\n')
        jump label_275
    fi

    ('SETNAME', ('integer', [('value', 3)]))
    print('She hands $Y #9 mutton ration\\s.')
    wait()

    print('\n\n')

    if integer(value 0):
        print('"That\'s all you can carry."')

    else:
        print('"That\'s all you can afford."')
    fi

    wait()

    print('\n\n')
    jump label_275

integers_4958 = [
    4, // 0
    3, // 1
    6, // 2
]

integers_4964 = [
    116, // 0
    117, // 1
    115, // 2
]

strings_4970 = [
    'Mead', // 0
    'Ale',  // 1
    'Wine', // 2
]
